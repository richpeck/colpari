
var lfb_lastStepID=0;var lfb_lastSteps=new Array();var lfb_plannedSteps;var lfb_gmapService=false;var tld_selectionMode=false;var lfb_calendars=new Array();jQuery(document).ready(function(){if(jQuery("#estimation_popup").length>0){if(document.location.href.indexOf("lfb_action=preview")>-1){jQuery("#estimation_popup:not(.wpe_fullscreen)").remove()}window.Dropzone.autoDiscover=false;initFlatUI();wpe_initForms()}});jQuery(window).on("load",function(){if(jQuery("#estimation_popup").length>0){jQuery.each(wpe_forms,function(){var a=this;wpe_checkItems(a.formID);wpe_initListeners(a.formID)});lfb_onResize();jQuery(window).resize(lfb_onResize);jQuery(window).on("popstate",function(a){if(a.originalEvent.state!==null){a.preventDefault();wpe_previousStep(wpe_forms[0].formID)}})}jQuery("#ajax-loading-screen").fadeOut();jQuery("#ajax-content-wrap >.container-wrap").css({opacity:1,display:"block"})});function wpe_getForm(b){var a=false;jQuery.each(wpe_forms,function(){if(this.formID==b){a=this}});return a}function lfb_changeCaptcha(c){var b=wpe_getForm(c);var a=Math.floor((Math.random()*100000)+1);jQuery('#estimation_popup.wpe_bootstraped[data-form="'+c+'"] #lfb_captcha').attr("src",b.captchaUrl+"?tmp="+a)}function lfb_onResize(){jQuery("#estimation_popup.wpe_fullscreen").css({minHeight:jQuery(window).height()});if(jQuery(window).width()<=768){jQuery("#estimation_popup .lfb_stepDescription").each(function(){jQuery(this).css({top:jQuery(this).closest(".genSlide").find(".stepTitle").height()+60})});jQuery("#estimation_popup .genContent ").each(function(){jQuery(this).css({paddingTop:jQuery(this).closest(".genSlide").find(".stepTitle").height()+jQuery(this).closest(".genSlide").find(".lfb_stepDescription").height()+70})})}else{jQuery("#estimation_popup .lfb_stepDescription").each(function(){jQuery(this).css({top:jQuery(this).closest(".genSlide").find(".stepTitle").height()+60})});jQuery("#estimation_popup .genContent ").each(function(){jQuery(this).css({paddingTop:jQuery(this).closest(".genSlide").find(".stepTitle").height()+jQuery(this).closest(".genSlide").find(".lfb_stepDescription").height()+70})})}}function wpe_updatePlannedSteps(a){var b=parseInt(jQuery('#estimation_popup.wpe_bootstraped[data-form="'+a+'"]  #mainPanel .genSlide[data-start="1"]').attr("data-stepid"));lfb_plannedSteps=new Array();lfb_plannedSteps.push(b);lfb_plannedSteps=wpe_scanPlannedSteps(b,a)}function wpe_scanPlannedSteps(d,c){var a=new Array();var b=wpe_findPotentialsSteps(d,c);if(b.length>0&&b[0]!="final"){lfb_plannedSteps.push(b[0]);wpe_scanPlannedSteps(b[0],c)}else{return lfb_plannedSteps}return lfb_plannedSteps}function wpe_getStepQuantities(e,d){var b=wpe_getForm(e);var f=0;if(jQuery.inArray(parseInt(d),lfb_lastSteps)>-1||d==b.step){var c=wpe_getFormContent(e,true,d);var a=c[2];jQuery.each(a,function(){var g=this;if(isNaN(g.quantity)){f++}else{f+=g.quantity}})}return f}function wpe_getTotalQuantities(f,e){var c=wpe_getForm(f);var d=wpe_getFormContent(f,true);var a=d[2];var h=0;var b=true;if(isNaN(e)||e==0){b=false}var g=false;jQuery.each(a,function(){var i=this;if(b&&!g&&i.stepid==e){g=true}if(!g||i.stepid==e){if(isNaN(i.quantity)){h++}else{h+=i.quantity}}});return h}function wpe_itemClick(l,f,d){var c=wpe_getForm(d);var j=false;var k=l;var e=false;if(f){jQuery('#estimation_popup[data-form="'+c.formID+'"] .quantityBtns').removeClass("open");jQuery('#estimation_popup[data-form="'+c.formID+'"] .quantityBtns').fadeOut(250);var g=navigator.userAgent.toLowerCase();var i=g.match(/(iPad|iPhone|iPod)/i);if(i){jQuery("body :not(.ui-slider-handle) > .tooltip").remove();jQuery("body > .tooltip").remove();jQuery('#estimation_popup[data-form="'+c.formID+'"] > .tooltip').remove()}}if(f){k.addClass("action")}if((f)||(!k.is(".action"))){if(c.imgIconStyle!="zoom"){k.find("span.icon_select").animate({bottom:160,opacity:0},200)}if(k.is(".checked")){if((f)&&(k.data("required"))){}else{if(c.imgIconStyle=="zoom"){k.delay(200).css("transition-delay","0.2s");k.find("span.icon_select").css("transition-delay","0s")}else{k.css("transition-delay","0s")}var b=220;if(c.imgIconStyle=="zoom"){b=0}k.delay(b).removeClass("checked");if(c.imgIconStyle!="zoom"){k.delay(220).find("span.icon_select").removeClass("fui-check").addClass("fui-cross")}else{k.find("span.icon_select").css("transition-delay","0s")}k.delay(400).css("transition-delay","0s");k.find(".icon_quantity").delay(300).fadeOut(200)}}else{k.css("transition-delay","0s");if(c.disableTipMobile==0||!wpe_is_touch_device()){if(!l.is('[data-type="slider"]')&&!l.is(".lfb_button")&&c.imgTitlesStyle==""){l.b_tooltip("show")}}e=true;if(c.imgIconStyle=="zoom"){k.find("span.icon_select").css("transition-delay",".5s")}k.delay(220).addClass("checked");if(c.imgIconStyle!="zoom"){k.delay(220).find("span.icon_select").removeClass("fui-cross").addClass("fui-check")}if(k.find(".quantityBtns").length>0&&!k.is("[data-distanceqt]")){k.find(".icon_quantity").delay(300).fadeIn(200);k.find(".quantityBtns").delay(500).addClass("open");k.find(".quantityBtns").delay(500).fadeIn("200")}if(k.data("urltarget")&&k.data("urltarget")!=""){var a=k.data("urltargetmode");if(a!="_self"&&a!="_blank"){a="_blank"}var h=window.open(k.data("urltarget"),a);if(typeof(h)!=="null"&&h!=null){h.focus()}}}if(c.imgIconStyle!="zoom"){k.find("span.icon_select").delay(300).animate({bottom:0,opacity:1},200)}if((f)&&(k.data("group"))){k.closest(".genSlide").find('div.selectable.checked[data-group="'+k.data("group")+'"]').each(function(){wpe_itemClick(jQuery(this),false,d)});k.closest(".genSlide").find('input[type=checkbox][data-group="'+k.data("group")+'"]:checked').trigger("click.auto");k.closest(".genSlide").find('a.lfb_button.checked[data-group="'+k.data("group")+'"]').each(function(){wpe_itemClick(jQuery(this),false,d)});if(c.groupAutoClick=="1"&&k.is(".checked")&&k.closest(".genSlide").is("[data-required=true]")){setTimeout(function(){if(k.closest(".genSlide").find("[data-itemid]").not(".lfb_richtext").not('[data-group="'+k.data("group")+'"]').not(".lfb_disabled").length==0&&k.closest(".genSlide").find('[data-group="'+k.data("group")+'"] .quantityBtns').length==0&&k.closest(".genSlide").find('[data-group="'+k.data("group")+'"] .wpe_qtfield').length==0){wpe_nextStep(c.formID)}},500)}}setTimeout(function(){wpe_updatePrice(d);k.removeClass("action")},420)}setTimeout(function(){if(k.is('[data-usedistance="true"]')){lfb_removeDistanceError(k.attr("data-itemid"),d)}},200)}function wpe_nl2br(c,b){c=c.replace(/\n\n/g,"\n");var a=(b||typeof b==="undefined")?"<br />":"<br>";return(c+"").replace(/([^>\r\n]?)(\r\n|\n\r|\r|\n)/g,"$1"+a+"$2")}function wpe_initForms(){jQuery.each(wpe_forms,function(){var c=this;c.price=0;c.priceSingle=0;c.priceMax=0;c.step=0;c.gFormDesignCheck=0;c.timer_gFormSubmit=null;c.timer_gFormDesign=null;c.animationsSpeed*=1000;c.reductionResult=0;c.reduction=0;c.discountCode="";c.discountCodeDisplayed=false;c.initialPrice=parseFloat(c.initialPrice);c.contactSent=0;c.gravitySent=false;c.shineFxIndex=0;c.subscriptionText=jQuery('#estimation_popup.wpe_bootstraped[data-form="'+c.formID+'"] #finalPrice span:eq(1)').html();c.richtextsContent=new Array();c.emailSent=false;c.autoStart=false;jQuery('#estimation_popup.wpe_bootstraped[data-form="'+c.formID+'"] .lfb_richtext[data-itemid]').each(function(){c.richtextsContent[jQuery(this).attr("data-itemid").toString()]=jQuery(this).html()});jQuery('#estimation_popup.wpe_bootstraped[data-form="'+c.formID+'"] [data-type="numberfield"]:not([value])').val(0);var d=c.formID;if(c.save_to_cart==1){c.save_to_cart=true}else{c.save_to_cart=false}if(c.save_to_cart_edd==1){c.save_to_cart_edd=true}else{c.save_to_cart_edd=false}if(c.gravityFormID>0){jQuery.ajax({url:c.ajaxurl,type:"post",data:{action:"get_currentRef",formID:d},success:function(e){c.current_ref=e}})}if(jQuery('#estimation_popup.wpe_bootstraped[data-form="'+c.formID+'"]').is('[data-emaillaststep="1"]')){jQuery('#estimation_popup.wpe_bootstraped[data-form="'+c.formID+'"] #finalSlide .linkPrevious').addClass("lfb-hidden");jQuery('#estimation_popup.wpe_bootstraped[data-form="'+c.formID+'"] #wpe_btnOrder').addClass("lfb-hidden")}jQuery('#estimation_popup.wpe_bootstraped[data-form="'+c.formID+'"] #mainPanel .genSlide .genContent div.selectable span.icon_select.lfb_fxZoom').css({textShadow:"-2px 0px "+jQuery('#estimation_popup.wpe_bootstraped[data-form="'+c.formID+'"] #mainPanel').css("background-color")});if(jQuery('#estimation_popup.wpe_bootstraped[data-form="'+c.formID+'"]').is(".wpe_popup")&&!jQuery('#estimation_popup.wpe_bootstraped[data-form="'+c.formID+'"]').closest("#lfb_bootstraped").parent().is("body")){jQuery('#estimation_popup.wpe_bootstraped[data-form="'+c.formID+'"]').closest("#lfb_bootstraped").detach().appendTo("body")}if(jQuery('#estimation_popup.wpe_bootstraped[data-form="'+c.formID+'"] #lfb_stripeForm').length>0){Stripe.setPublishableKey(c.stripePubKey)}if(jQuery('#estimation_popup[data-form="'+c.formID+'"]').is(".wpe_fullscreen")){jQuery("html,body").css("overflow-y","hidden")}if(jQuery('#estimation_popup.wpe_bootstraped[data-form="'+c.formID+'"] #wtmt_paypalForm').length>0){jQuery('#estimation_popup.wpe_bootstraped[data-form="'+c.formID+'"] #wtmt_paypalForm').attr("target","_self")}jQuery('#estimation_popup.wpe_bootstraped[data-form="'+c.formID+'"] input:not([type=checkbox])').change(function(){wpe_updatePrice(d)});jQuery('#estimation_popup.wpe_bootstraped[data-form="'+c.formID+'"] textarea').change(function(){wpe_updatePrice(d)});if(jQuery('#estimation_popup.wpe_bootstraped[data-form="'+c.formID+'"] #lfb_captcha').length>0){lfb_changeCaptcha(d)}if(c.enableShineFxBtn==1){jQuery('#estimation_popup.wpe_bootstraped[data-form="'+c.formID+'"]').find("a.btn-primary").append('<canvas class="lfb_shineCanvas"></canvas>');jQuery('#estimation_popup.wpe_bootstraped[data-form="'+c.formID+'"]').find("a.btn-primary").mouseover(function(){if(c.shineFxIndex==0){lfb_shineBtn(d,jQuery(this).find(".lfb_shineCanvas"))}})}jQuery('#estimation_popup.wpe_bootstraped[data-form="'+c.formID+'"] .lfb_dropzone').each(function(){var f=null;if(jQuery(this).attr("data-maxfiles")>0){f=jQuery(this).attr("data-maxfiles")}var e=jQuery(this);jQuery(this).dropzone({url:c.ajaxurl,paramName:"file",maxFilesize:jQuery(this).attr("data-filesize"),maxFiles:f,addRemoveLinks:true,dictRemoveFile:"",dictCancelUpload:"",acceptedFiles:jQuery(this).attr("data-allowedfiles"),dictDefaultMessage:c.filesUpload_text,dictFileTooBig:c.filesUploadSize_text,dictInvalidFileType:c.filesUploadType_text,dictMaxFilesExceeded:c.filesUploadLimit_text,init:function(){this.on("thumbnail",function(h,i){var g=jQuery(h.previewElement);g.attr("data-file",h.name)});this.on("sending",function(g,i,h){e.closest(".genSlide").find(".btn-next").fadeOut();e.closest(".genSlide").find(".btn-primary").fadeOut();h.append("action","lfb_upload_form");h.append("formSession",jQuery('#estimation_popup.wpe_bootstraped[data-form="'+c.formID+'"]').attr("data-formsession"));h.append("itemID",e.attr("data-itemid"))}),this.on("complete",function(g,h){if(e.find(".dz-preview:not(.dz-complete)").length==0||e.find(".dz-preview").length==0){e.closest(".genSlide").find(".btn-next").fadeIn();e.closest(".genSlide").find(".btn-primary").fadeIn()}wpe_updatePrice(c.formID)});this.on("success",function(h,i){var g=jQuery(h.previewElement);g.attr("data-file",h.name)});this.on("removedfile",function(g,h){wpe_updatePrice(c.formID)})}})});jQuery('#estimation_popup.wpe_bootstraped[data-form="'+c.formID+'"]').find('input[type="text"][data-itemid],textarea[data-itemid]').each(function(){jQuery(this).attr("data-initialvalue",jQuery(this).val())});jQuery('#estimation_popup.wpe_bootstraped[data-form="'+c.formID+'"] [data-itemid][data-type="slider"]').each(function(){var g=parseInt(jQuery(this).attr("data-min"));if(g==0){g=0}var e=parseInt(jQuery(this).attr("data-max"));if(e==0){e=30}var i=jQuery('<div class="tooltip top" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner">'+g+"</div></div>").css({position:"absolute",top:-55,left:-20,opacity:1}).hide();var h=1;if(jQuery(this).is("[data-stepslider]")&&parseInt(jQuery(this).attr("data-stepslider"))>0){h=parseInt(jQuery(this).attr("data-stepslider"))}var f=false;if(jQuery(this).is("[data-usecalculationqt]")){f=true}jQuery(this).slider({min:g,max:e,value:g,step:h,disabled:f,orientation:"horizontal",range:"min",change:function(j,k){if(!tld_selectionMode){i.find(".tooltip-inner").html(k.value);if(j.originalEvent){wpe_updatePrice(d)}}},start:function(j,k){if(tld_selectionMode){return false}},slide:function(j,k){if(tld_selectionMode){return false}i.find(".tooltip-inner").html(k.value);if(j.originalEvent){setTimeout(function(){wpe_updatePrice(d)},30);i.show()}wpe_updatePrice(d)},stop:function(j,k){i.find(".tooltip-inner").html(k.value);wpe_updatePrice(d);i.hide()}}).find(".ui-slider-handle").append(i).hover(function(){if(!tld_selectionMode){i.show()}},function(){i.hide()})});jQuery('#estimation_popup.wpe_bootstraped[data-form="'+c.formID+'"] .lfb_colorpicker').each(function(){var e=jQuery(this);jQuery(this).prev(".lfb_colorPreview").click(function(){if(!tld_selectionMode){jQuery(this).next(".lfb_colorpicker").trigger("click")}});jQuery(this).prev(".lfb_colorPreview").css({backgroundColor:c.colorA});jQuery(this).colpick({color:c.colorA,layout:"hex",onSubmit:function(){jQuery("body > .colpick").fadeOut()},onChange:function(f,j,h,i,g){jQuery(i).val("#"+j);jQuery(i).prev(".lfb_colorPreview").css({backgroundColor:"#"+j})}})});jQuery('#estimation_popup.wpe_bootstraped[data-form="'+c.formID+'"]').find('.lfb_colorPreview[data-urltarget],input[type="text"][data-itemid]:not(.lfb_colorpicker)[data-urltarget],textarea[data-itemid][data-urltarget],select[data-itemid][data-urltarget]').each(function(){jQuery(this).click(function(){if(!tld_selectionMode){var e=window.open(jQuery(this).attr("data-urltarget"),"_blank");if(typeof(e)!=="null"&&e!=null){e.focus()}}})});jQuery('#estimation_popup.wpe_bootstraped[data-form="'+c.formID+'"]').find('[data-autocomplete="1"]').each(function(){var e={};if(jQuery(this).attr("data-fieldtype")=="city"){e.types=["(cities)"]}else{if(jQuery(this).attr("data-fieldtype")=="address"){if(jQuery(this).closest(".genContent").find('[data-fieldtype="city"]').length>0){e.types=["address"]}}else{if(jQuery(this).attr("data-fieldtype")=="country"){e.types=["country"]}else{if(jQuery(this).attr("data-fieldtype")=="zip"){e.types=["zip"]}}}}new google.maps.places.Autocomplete(jQuery(this).get(0),e)});jQuery('#estimation_popup.wpe_bootstraped[data-form="'+c.formID+'"]  #mainPanel .genSlide .lfb_timepicker').each(function(){jQuery(this).timepicker({showMeridian:parseInt(c.timeModeAM),appendWidgetTo:'#estimation_popup.wpe_bootstraped[data-form="'+c.formID+'"]'});jQuery(this).click(function(){jQuery(this).timepicker("showWidget")});jQuery(this).timepicker().on("changeTime.timepicker",function(l){var h=jQuery(this).attr("data-mintime");var i=jQuery(this).attr("data-maxtime");if(h!=""&&h.indexOf(":")>0){var j=parseInt(h.substr(0,h.indexOf(":")));var m=parseInt(h.substr(h.indexOf(":")+1,2));if(h.indexOf("PM")>0&&j!=12){j+=12}var g=l.time.hours;if(l.time.meridian=="PM"){g+=12}if(g<j||(g==j&&l.time.minutes<m)){jQuery(this).val("")}}if(i!=""&&i.indexOf(":")>0){var k=parseInt(i.substr(0,i.indexOf(":")));var f=parseInt(i.substr(i.indexOf(":")+1,2));if(i.indexOf("PM")>0&&k!=12){k+=12}var g=l.time.hours;if(l.time.meridian=="PM"){g+=12}if(g>k||(g==k&&l.time.minutes>f)){jQuery(this).val("")}}})});var b=wpe_forms[0].dateFormat;b=b.replace(/\\\//g,"/");var a=new Array();jQuery('#estimation_popup.wpe_bootstraped[data-form="'+c.formID+'"]  #mainPanel .genSlide .lfb_datepicker').each(function(){var i=new Date();if(jQuery(this).is('[data-allowpast="1"]')||jQuery(this).is('[data-datetype="time"]')){i=null}var h="";var f=new Array();jQuery.each(jQuery(this).attr("data-daysweek").split(","),function(){f.push(parseInt(this))});var g={daysOfWeekDisabled:f,language:c.datePickerLanguage,timeZone:"",startDate:i,showMeridian:parseInt(c.timeModeAM),container:jQuery(this).closest(".itemBloc")};var e=jQuery(this).attr("data-datetype");if(e=="date"){g.format=b;g.minView=2;jQuery(this).attr("data-disableminutes","0")}else{if(e=="time"){if(parseInt(c.timeModeAM)==1){g.format="H:ii P"}else{g.format="hh:ii"}g.startView=1;if(jQuery(this).is('[data-disableminutes="1"]')){g.minView=1}}else{if(parseInt(c.timeModeAM)==1){g.format=b+" H:ii P"}else{g.format=b+" hh:ii"}if(jQuery(this).is('[data-disableminutes="1"]')){g.minView=1}}}jQuery(this).datetimepicker(g).on("show",function(j){jQuery(this).data("lastdate",jQuery(this).val());jQuery(this).val("")}).on("hide",function(j){if(jQuery(this).val()==""&&jQuery(this).data("lastdate")!=""){jQuery(this).val(jQuery(this).data("lastdate"))}}).on("changeDay",function(m){jQuery(this).val("");var j=moment.utc(m.date).format("YYYY-MM-DD");var l=jQuery(this).attr("data-eventduration");var n=jQuery(this).attr("data-eventdurationtype");var k=lfb_getDisabledHours(jQuery(this).attr("data-calendarid"),j,l,n);jQuery(this).data("date",j);jQuery(this).datetimepicker("setHoursDisabled",k)}).on("changeHour",function(n){if(jQuery(this).is('[data-datetype="time"]')&&jQuery(this).is('[data-disableminutes="1"]')){var m=moment(n.date).utc();m.subtract(moment(n.date).minutes(),"minutes");var p=this;setTimeout(function(){jQuery(p).datetimepicker("setDate",new Date(m.format("YYYY-MM-DD HH:mm")))},1)}else{var k=moment.utc(n.date).format("YYYY-MM-DD");var j=moment.utc(n.date).format("HH");var l=jQuery(this).attr("data-eventduration");var q=jQuery(this).attr("data-eventdurationtype");var o=lfb_getDisabledMinutes(jQuery(this).attr("data-calendarid"),k,j,l,q);jQuery(this).data("date",moment.utc(n.date).format("YYYY-MM-DD HH:mm"));jQuery(this).datetimepicker("setMinutesDisabled",o)}});if(e=="date"){jQuery(this).on("show",function(){jQuery(".datetimepicker .table-condensed .prev").show();jQuery(".datetimepicker .table-condensed .switch").show();jQuery(".datetimepicker .table-condensed .next").show()})}else{if(e=="time"){jQuery(this).on("show",function(){jQuery(".datetimepicker .table-condensed .prev").hide();jQuery(".datetimepicker .table-condensed .switch").hide();jQuery(".datetimepicker .table-condensed .next").hide()})}else{jQuery(this).on("show",function(){jQuery(".datetimepicker .table-condensed .prev").show();jQuery(".datetimepicker .table-condensed .switch").show();jQuery(".datetimepicker .table-condensed .next").show()})}}if(jQuery(this).attr("data-calendarid")!=0&&parseInt(jQuery(this).attr("data-calendarid"))>0){if(jQuery.inArray(jQuery(this).attr("data-calendarid"),a)==-1){a.push(jQuery(this).attr("data-calendarid"))}}if(jQuery(this).attr("placeholder").length==0&&jQuery(this).val().length==0){if(jQuery(this).is('[data-disableminutes="1"]')||(jQuery(this).is('[data-registerevent="1"]')&&jQuery(this).is('[data-eventbusy="1"]'))){}else{jQuery(this).datetimepicker("setDate",new Date())}}jQuery(this).keypress(function(j){j.preventDefault()})});if(a.length>0){lfb_getBusyDates(c.formID,a)}jQuery('#estimation_popup.wpe_bootstraped[data-form="'+c.formID+'"]  #mainPanel .genSlide [data-group]').each(function(){var e=jQuery(this);if(c.groupAutoClick=="1"&&e.prop("data-group")!=""&&e.closest(".genSlide").is("[data-required=true]")){if(e.closest(".genSlide").find("[data-itemid]:not(.lfb_disabled)").not(".lfb_richtext").not('[data-group="'+e.data("group")+'"]').not(".lfb_disabled").length==0&&e.closest(".genSlide").find('[data-group="'+e.data("group")+'"] .quantityBtns').length==0&&e.closest(".genSlide").find('[data-group="'+e.data("group")+'"] .wpe_qtfield').length==0){e.closest(".genSlide").find(".btn-next").addClass("lfb-hidden")}}});jQuery('#estimation_popup.wpe_bootstraped[data-form="'+c.formID+'"]  #mainPanel .genSlide div.selectable.prechecked,#estimation_popup.wpe_bootstraped[data-form="'+c.formID+'"]  #mainPanel .genSlide a.lfb_button.prechecked,#estimation_popup.wpe_bootstraped[data-form="'+c.formID+'"] #mainPanel .genSlide input[type=checkbox][data-price].prechecked').each(function(){wpe_itemClick(jQuery(this),false,d)});wpe_initPrice(d);wpe_updatePrice(d);jQuery('#estimation_popup.wpe_bootstraped[data-form="'+c.formID+'"] #btnStart').click(function(){if(!tld_selectionMode){wpe_openGenerator(d)}});wpe_initGform(d);if(jQuery('#estimation_popup.wpe_bootstraped[data-form="'+c.formID+'"] #wtmt_paypalForm').length>0){jQuery('#estimation_popup.wpe_bootstraped[data-form="'+c.formID+'"] #wtmt_paypalForm').attr("target","_self")}jQuery('#estimation_popup.wpe_bootstraped[data-form="'+c.formID+'"] .quantityBtns > a').click(function(){if(!tld_selectionMode){if(jQuery(this).attr("data-btn")=="less"){wpe_quantity_less(this,d)}else{wpe_quantity_more(this,d)}}});jQuery('#estimation_popup.wpe_bootstraped[data-form="'+c.formID+'"] .linkPrevious').click(function(){if(!tld_selectionMode){wpe_previousStep(d)}});jQuery('#estimation_popup.wpe_bootstraped[data-form="'+c.formID+'"] .btn-next').click(function(){if(!tld_selectionMode){wpe_nextStep(d)}});jQuery('#estimation_popup.wpe_bootstraped[data-form="'+c.formID+'"] #btnOrderPaypal').click(function(){if(!tld_selectionMode){wpe_order(d)}});jQuery('#estimation_popup.wpe_bootstraped[data-form="'+c.formID+'"] #finalSlide [data-toggle="switch"]').change(function(){var e=jQuery(this).attr("data-fieldid");wpe_toggleField(e,d)});jQuery('#estimation_popup.wpe_bootstraped[data-form="'+c.formID+'"] #lfb_stripeForm').submit(function(h){var g=false;var e=lfb_checkStepItemsValid("final",d);if(!e){g=true}if(jQuery('#estimation_popup.wpe_bootstraped[data-form="'+c.formID+'"] #finalSlide #lfb_legalCheckbox:not(:checked)').length>0){jQuery('#estimation_popup.wpe_bootstraped[data-form="'+c.formID+'"] #lfb_legalCheckbox').closest(".form-group").addClass("has-error");g=true}else{if(jQuery('#estimation_popup.wpe_bootstraped[data-form="'+c.formID+'"] #finalSlide #lfb_legalCheckbox:checked').length>0){jQuery('#estimation_popup.wpe_bootstraped[data-form="'+c.formID+'"] #lfb_legalCheckbox').closest(".form-group").removeClass("has-error")}}var f=true;jQuery('#estimation_popup.wpe_bootstraped[data-form="'+d+'"] [data-activatePaypal="true"]:not(:checked):not(.checked)').each(function(){var i=jQuery(this).closest(".genSlide").attr("data-stepid");if(i!="final"){i=parseInt(i)}if(jQuery.inArray(i,lfb_lastSteps)==-1){}else{f=false}});if(jQuery('#estimation_popup.wpe_bootstraped[data-form="'+d+'"]').find('[data-dontactivatepaypal="true"].checked,[data-dontactivatepaypal="true"]:checked').length>0){f=false}if(!f){h.preventDefault();wpe_order(d)}else{jQuery('#estimation_popup.wpe_bootstraped[data-form="'+c.formID+'"] #lfb_stripeForm [data-stripe="number"]').closest(".form-group").removeClass("has-error");jQuery('#estimation_popup.wpe_bootstraped[data-form="'+c.formID+'"] #lfb_stripeForm [data-stripe="exp_month"]').closest(".form-group").removeClass("has-error");jQuery('#estimation_popup.wpe_bootstraped[data-form="'+c.formID+'"] #lfb_stripeForm [data-stripe="exp_year"]').closest(".form-group").removeClass("has-error");jQuery('#estimation_popup.wpe_bootstraped[data-form="'+c.formID+'"] #lfb_stripeForm [data-stripe="cvc"]').closest(".form-group").removeClass("has-error");if(jQuery('#estimation_popup.wpe_bootstraped[data-form="'+c.formID+'"] #lfb_stripeForm [data-stripe="number"]').val().length<5){g=true;jQuery('#estimation_popup.wpe_bootstraped[data-form="'+c.formID+'"] #lfb_stripeForm [data-stripe="number"]').closest(".form-group").addClass("has-error")}if(jQuery('#estimation_popup.wpe_bootstraped[data-form="'+c.formID+'"] #lfb_stripeForm [data-stripe="exp_month"]').val().length<2){g=true;jQuery('#estimation_popup.wpe_bootstraped[data-form="'+c.formID+'"] #lfb_stripeForm [data-stripe="exp_month"]').closest(".form-group").addClass("has-error")}if(jQuery('#estimation_popup.wpe_bootstraped[data-form="'+c.formID+'"] #lfb_stripeForm [data-stripe="exp_year"]').val().length<2){g=true;jQuery('#estimation_popup.wpe_bootstraped[data-form="'+c.formID+'"] #lfb_stripeForm [data-stripe="exp_year"]').closest(".form-group").addClass("has-error")}if(jQuery('#estimation_popup.wpe_bootstraped[data-form="'+c.formID+'"] #lfb_stripeForm [data-stripe="cvc"]').val().length<2){g=true;jQuery('#estimation_popup.wpe_bootstraped[data-form="'+c.formID+'"] #lfb_stripeForm [data-stripe="cvc"]').closest(".form-group").addClass("has-error")}if(!g){if(jQuery('#estimation_popup.wpe_bootstraped[data-form="'+c.formID+'"] #lfb_captcha').length>0){jQuery.ajax({url:c.ajaxurl,type:"post",data:{action:"lfb_checkCaptcha",formID:d,captcha:jQuery('#estimation_popup.wpe_bootstraped[data-form="'+c.formID+'"] #lfb_captchaField').val()},success:function(i){if(i=="1"){jQuery('#estimation_popup.wpe_bootstraped[data-form="'+c.formID+'"] #lfb_stripeForm #wpe_btnOrderStripe').prop("disabled",true);Stripe.card.createToken(jQuery('#estimation_popup.wpe_bootstraped[data-form="'+c.formID+'"] #lfb_stripeForm'),function(j,k){lfb_stripeResponse(j,k,c.formID)})}else{jQuery('#estimation_popup.wpe_bootstraped[data-form="'+c.formID+'"] #lfb_captchaField').closest(".form-group").addClass("has-error")}}})}else{jQuery('#estimation_popup.wpe_bootstraped[data-form="'+c.formID+'"] #lfb_stripeForm #wpe_btnOrderStripe').prop("disabled",true);Stripe.card.createToken(jQuery('#estimation_popup.wpe_bootstraped[data-form="'+c.formID+'"] #lfb_stripeForm'),function(i,j){lfb_stripeResponse(i,j,c.formID)})}}return false}});jQuery(".gform_wrapper").each(function(){var e=jQuery(this).attr("id").substr(jQuery(this).attr("id").lastIndexOf("_")+1,jQuery(this).attr("id").length);if(e==c.gravityFormID){jQuery(this).detach().insertAfter('#estimation_popup.wpe_bootstraped[data-form="'+c.formID+'"] #finalPrice')}});jQuery('#estimation_popup.wpe_bootstraped[data-form="'+c.formID+'"] .wpe_qtfield').attr("type","number");jQuery('#estimation_popup.wpe_bootstraped[data-form="'+c.formID+'"] .wpe_qtfield').focusout(function(){if(jQuery(this).val().indexOf("-")>-1&&(!jQuery(this).is("[min]")||jQuery(this).attr("min").indexOf("-")<0)){jQuery(this).val(parseInt(jQuery(this).attr("min")))}if(parseFloat(jQuery(this).val())<parseInt(jQuery(this).attr("min"))){jQuery(this).val(jQuery(this).attr("min"))}if(parseFloat(jQuery(this).val())>parseInt(jQuery(this).attr("max"))){jQuery(this).val(jQuery(this).attr("max"))}wpe_updatePrice(c.formID);wpe_updateSummary(c.formID)});jQuery('#estimation_popup.wpe_bootstraped[data-form="'+c.formID+'"] input[type="number"][data-itemid]').keydown(function(e){return e.keyCode==69?false:true});jQuery('#estimation_popup.wpe_bootstraped[data-form="'+c.formID+'"] input[type="number"][data-itemid]').focusout(function(){if(jQuery(this).val().indexOf("-")>-1&&(!jQuery(this).is("[min]")||jQuery(this).attr("min").indexOf("-")<0)){jQuery(this).val(parseInt(jQuery(this).attr("min")))}if(parseFloat(jQuery(this).val())<parseFloat(jQuery(this).attr("min"))){jQuery(this).val(jQuery(this).attr("min"))}if(parseFloat(jQuery(this).val())>parseFloat(jQuery(this).attr("max"))){jQuery(this).val(jQuery(this).attr("max"))}if(jQuery(this).val()==""||isNaN(parseInt(jQuery(this).val()))){jQuery(this).val(0)}if(jQuery(this).val()!=""&&(jQuery(this).is('[data-valueasqt="0"]')||jQuery(this).val()>0)){jQuery(this).addClass("checked")}else{jQuery(this).removeClass("checked")}wpe_updatePrice(c.formID);wpe_updateSummary(c.formID)});jQuery('#estimation_popup.wpe_bootstraped[data-form="'+c.formID+'"] .wpe_sliderQt').each(function(){var f=parseInt(jQuery(this).closest(".quantityBtns").attr("data-min"));if(f==0){f=1}var h=jQuery('<div class="tooltip top" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner">'+f+"</div></div>").css({position:"absolute",top:-55,left:-20,opacity:1}).hide();var g=1;if(jQuery(this).closest(".quantityBtns").is("[data-stepslider]")&&parseInt(jQuery(this).closest(".quantityBtns").attr("data-stepslider"))>0){g=parseInt(jQuery(this).closest(".quantityBtns").attr("data-stepslider"))}var e=false;if(jQuery(this).closest(".selectable").is("[data-usecalculationqt]")){e=true}jQuery(this).slider({min:f,max:parseInt(jQuery(this).closest(".quantityBtns").attr("data-max")),value:parseInt(jQuery(this).closest(".quantityBtns").next(".icon_quantity").html()),orientation:"horizontal",range:"min",disabled:e,step:g,change:function(i,j){h.find(".tooltip-inner").html(j.value);jQuery(this).closest(".quantityBtns").next(".icon_quantity").html(j.value);if(i.originalEvent){wpe_updatePrice(d)}},slide:function(i,j){jQuery(this).closest(".quantityBtns").next(".icon_quantity").html(j.value);h.find(".tooltip-inner").html(j.value);if(i.originalEvent){wpe_updatePrice(d)}}}).find(".ui-slider-handle").append(h).hover(function(){h.show()},function(){h.hide()})});lfb_loadStoredForm(c.formID);lfb_initRichTextValues(c.formID);if(c.intro_enabled=="0"){jQuery('#estimation_popup.wpe_bootstraped[data-form="'+c.formID+'"] .lfb_btnFloatingSummary').css({display:"inline-block"});jQuery('#estimation_popup.wpe_bootstraped[data-form="'+c.formID+'"] .lfb_btnSaveForm').css({display:"inline-block"});jQuery('#estimation_popup.wpe_bootstraped[data-form="'+c.formID+'"] #btnStart,#estimation_popup.wpe_bootstraped[data-form="'+c.formID+'"] #startInfos').hide();if(c.showSteps!="2"){jQuery('#estimation_popup.wpe_bootstraped[data-form="'+c.formID+'"] .genPrice').fadeIn(500)}else{jQuery('#estimation_popup.wpe_bootstraped[data-form="'+c.formID+'"] .genPrice').hide()}jQuery('#estimation_popup.wpe_bootstraped[data-form="'+c.formID+'"] #mainPanel').fadeIn(c.animationsSpeed,function(){if(!c.autoStart){wpe_nextStep(c.formID)}})}jQuery('#estimation_popup.wpe_bootstraped[data-form="'+c.formID+'"]  #lfb_loader').fadeOut()})}function lfb_stripeResponse(a,c,e){var b=jQuery('#estimation_popup.wpe_bootstraped[data-form="'+e+'"] #lfb_stripeForm');if(c.error){b.find(".payment-errors").text(c.error.message);jQuery('#estimation_popup.wpe_bootstraped[data-form="'+e+'"] [data-stripe="number"]').closest(".form-group").addClass("has-error");b.find(".btn").prop("disabled",false)}else{var d=c.id;if(b.find('[name="stripeToken"]').length==0){b.append(jQuery('<input type="hidden" name="stripeToken">').val(d));Stripe.card.createToken(jQuery('#estimation_popup.wpe_bootstraped[data-form="'+e+'"] #lfb_stripeForm'),function(g,f){lfb_stripeResponse(g,f,e)})}else{if(b.find('[name="stripeTokenB"]').length==0){b.append(jQuery('<input type="hidden" name="stripeTokenB">').val(d));wpe_order(e)}else{if(b.find('[name="stripeTokenB"]').length==1){b.find('[name="stripeToken"]').val(d);b.find('[name="stripeTokenB"]').val(d);wpe_order(e)}}}}}function lfb_replaceAllBackSlash(b){var a=b.indexOf("\\");while(a>=0){b=b.replace("\\","");a=b.indexOf("\\")}return b}function lfb_shineBtn(g,f){var e=wpe_getForm(g);f.attr({width:f.width(),height:f.height()});f.css({borderRadius:f.parent().css("border-radius")});var c=f.get(0).getContext("2d");c.clearRect(0,0,f.width(),f.height());var b=c.createLinearGradient(0,0,f.width(),f.height());e.shineFxIndex+=0.08;if(e.shineFxIndex>1){c.clearRect(0,0,f.width(),f.height());e.shineFxIndex=0}else{var h=e.shineFxIndex;var a=h-0.1;if(a<0){a=0}var d=h+0.1;if(d>1){d=1}b.addColorStop(0,"transparent");b.addColorStop(a,"rgba(255,255,255,0)");b.addColorStop(h,"rgba(255,255,255,0.3)");b.addColorStop(d,"rgba(255,255,255,0)");b.addColorStop(1,"rgba(255,255,255,0)");c.fillStyle=b;c.fillRect(0,0,f.width(),f.height());setTimeout(function(){lfb_shineBtn(g,f)},30)}}function lfb_updateLayerImages(a){jQuery('#estimation_popup.wpe_bootstraped[data-form="'+a+'"] .lfb_layeredImage').each(function(){var b=parseInt(jQuery(this).closest(".genSlide").attr("data-stepid"));jQuery(this).find("img:not(.lfb_baseLayer)").each(function(){var f=lfb_replaceAllBackSlash(jQuery(this).attr("data-showconditions"));f=f.replace(/'/g,'"');if(f.length>0){try{f=JSON.parse(f);var g=lfb_checkConditions(f,a,b);var c=jQuery(this).attr("data-showconditionsoperator");if((c=="OR"&&!g.errorOR)||(c!="OR"&&!g.error)){jQuery(this).fadeIn()}else{jQuery(this).fadeOut()}}catch(d){jQuery(this).fadeIn()}}else{jQuery(this).fadeIn()}})})}function lfb_updateShowSteps(a){jQuery('#estimation_popup.wpe_bootstraped[data-form="'+a+'"] .genSlide[data-useshowconditions]').each(function(){var d=lfb_replaceAllBackSlash(jQuery(this).attr("data-showconditions"));d=d.replace(/'/g,'"');if(d!=""){try{d=JSON.parse(d);var f=lfb_checkConditions(d,a,parseInt(jQuery(this).attr("data-stepid")));var b=jQuery(this).attr("data-showconditionsoperator");if((b=="OR"&&!f.errorOR)||(b!="OR"&&!f.error)){if(jQuery(this).is(".lfb_disabled")){jQuery(this).css({opacity:0});jQuery(this).removeClass("lfb_disabled")}}else{if(!jQuery(this).is(".lfb_disabled")){jQuery(this).addClass("lfb_disabled")}}}catch(c){}}})}function lfb_updateShowItems(e){var d=wpe_getForm(e);var a=lfb_lastSteps.slice();var c=0;var b=0;if(d.step!="final"&&jQuery.inArray(parseInt(d.step),a)==-1){a.push(parseInt(d.step))}else{if(d.step=="final"){a.push("final")}}jQuery.each(a,function(){var f=this;jQuery('#estimation_popup.wpe_bootstraped[data-form="'+e+'"] .genSlide[data-stepid="'+this+'"] [data-useshowconditions]').each(function(){var i=lfb_replaceAllBackSlash(jQuery(this).attr("data-showconditions"));i=i.replace(/'/g,'"');if(i!=""){try{i=JSON.parse(i);var j=lfb_checkConditions(i,e,f);var g=jQuery(this).attr("data-showconditionsoperator");if((g=="OR"&&!j.errorOR)||(g!="OR"&&!j.error)){if(jQuery(this).is(".lfb_disabled")){jQuery(this).css({});jQuery(this).removeClass("lfb_disabled");jQuery(this).closest(".itemBloc").removeClass("lfb_disabled");jQuery(this).stop().animate({opacity:1},300);if(jQuery(this).is("input.prechecked")&&!jQuery(this).is(":checked")){wpe_itemClick(jQuery(this),false,e)}if(jQuery(this).is(".selectable.prechecked")&&!jQuery(this).is(".checked")){wpe_itemClick(jQuery(this),false,e)}if(jQuery(this).is(".lfb_button.prechecked")&&!jQuery(this).is(".checked")){wpe_itemClick(jQuery(this),false,e)}if(jQuery(this).is('input[type="text"]')||jQuery(this).is("textarea")){if(jQuery(this).is("[data-initialvalue]")){jQuery(this).val(jQuery(this).attr("data-initialvalue"))}}jQuery(this).closest(".itemBloc").stop().fadeIn(100)}}else{if(!jQuery(this).is(".lfb_disabled")){jQuery(this).css({opacity:1});if(jQuery(this).is(":checked")){wpe_itemClick(jQuery(this),false,e)}if(jQuery(this).is(".checked")){wpe_itemClick(jQuery(this),false,e)}if(jQuery(this).is('input[type="text"]')||jQuery(this).is("textarea")){}if(jQuery(this).is(".lfb_dropzone")){jQuery(this).find(".dz-preview").remove()}jQuery(this).addClass("lfb_disabled");jQuery(this).closest(".itemBloc").addClass("lfb_disabled");jQuery(this).stop().animate({opacity:0},300);jQuery(this).closest(".itemBloc").stop().fadeOut(300)}}}catch(h){}}})})}function lfb_removeFile(c,a){var b=wpe_getForm(c);jQuery.ajax({url:b.ajaxurl,type:"post",data:{action:"lfb_removeFile",formSession:jQuery('#estimation_popup.wpe_bootstraped[data-form="'+b.formID+'"]').attr("data-formsession"),file:a}})}function wpe_disablesThemeScripts(){var a=false;jQuery("script").each(function(){if((a)){if(jQuery(this).attr("src")&&jQuery(this).attr("src").indexOf("WP_Helper_Creator")>0){}else{if(jQuery(this).attr("src")&&jQuery(this).attr("src").indexOf("VisitorsTracker")>0){}else{if(jQuery(this).attr("src")&&jQuery(this).attr("src").indexOf("WP_Visual_Chat")>0){}else{if(jQuery(this).attr("src")&&jQuery(this).attr("src").indexOf("gravityforms")>0){}else{var b=this.innerText||this.textContent;if(b.indexOf("analytics")<0&&jQuery(this).parents(".gform_wrapper").length==0){jQuery(this).attr("disabled","disabled")}}}}}}if(jQuery(this).attr("src")&&jQuery(this).attr("src").indexOf("estimation_popup")>0){a=true}})}function wpe_initGform(b){var a=wpe_getForm(b);if(a.gravityFormID>0){a.gravitySent=false;a.gFormDesignCheck++;if(a.timer_gFormDesign){jQuery('#estimation_popup.wpe_bootstraped[data-form="'+a.formID+'"] #finalSlide').delay(100).animate({opacity:1},1000)}jQuery("#gform_wrapper_"+a.gravityFormID+" input[type=radio]").not('[data-toggle="radio"]').attr("data-toggle","radio");jQuery("#gform_wrapper_"+a.gravityFormID+"  .ginput_container input,#gform_wrapper_"+a.gravityFormID+"  .ginput_container select,#gform_wrapper_"+a.gravityFormID+" .ginput_container textarea").attr("title","control");jQuery("#gform_wrapper_"+a.gravityFormID+"  .ginput_container input,#gform_wrapper_"+a.gravityFormID+"  .ginput_container textarea, #gform_wrapper_"+a.gravityFormID+" .ginput_container select").not("[type=checkbox]").not("[type=radio]").not("[type=submit]").addClass("form-control");jQuery("#gform_wrapper_"+a.gravityFormID+"  .ginput_container").addClass("form-group");jQuery("#gform_wrapper_"+a.gravityFormID+"  .gform_button").attr("class","btn btn-wide btn-primary");jQuery("#gform_wrapper_"+a.gravityFormID+'  .gform_wrapper input[type="radio"]:not(.ready)').each(function(){jQuery(this).addClass("ready");var c=jQuery("#gform_wrapper_"+a.gravityFormID+' .gform_wrapper label[for="'+jQuery(this).attr("id")+'"]').html();jQuery("#gform_wrapper_"+a.gravityFormID+'  .gform_wrapper label[for="'+jQuery(this).attr("id")+'"]').parent("li").css("display","inline-block");jQuery("#gform_wrapper_"+a.gravityFormID+'  .gform_wrapper label[for="'+jQuery(this).attr("id")+'"]').append(jQuery(this));jQuery("#gform_wrapper_"+a.gravityFormID+'  .gform_wrapper label[for="'+jQuery(this).attr("id")+'"]').addClass("radio");jQuery("#gform_wrapper_"+a.gravityFormID+'  .gform_wrapper label[for="'+jQuery(this).attr("id")+'"]').prepend('<span class="icons"><span class="first-icon fui-radio-unchecked"></span><span class="second-icon fui-radio-checked"></span></span>');if(!jQuery("#gform_wrapper_"+a.gravityFormID+'  .gform_wrapper label[for="'+jQuery(this).attr("id")+'"]').parent("li").next().is("br")){jQuery("#gform_wrapper_"+a.gravityFormID+'  .gform_wrapper label[for="'+jQuery(this).attr("id")+'"]').parent("li").after("<br/>")}if(jQuery(this).is(":checked")){jQuery(this).trigger("click")}});jQuery("#gform_wrapper_"+a.gravityFormID+'  .gform_wrapper input[type="checkbox"]:not(.ready)').each(function(){jQuery(this).addClass("ready");var c=jQuery("#gform_wrapper_"+a.gravityFormID+'  .gform_wrapper label[for="'+jQuery(this).attr("id")+'"]').html();jQuery("#gform_wrapper_"+a.gravityFormID+'  .gform_wrapper label[for="'+jQuery(this).attr("id")+'"]').parent("li").css("display","inline-block");jQuery("#gform_wrapper_"+a.gravityFormID+'  .gform_wrapper label[for="'+jQuery(this).attr("id")+'"]').append(jQuery(this));jQuery("#gform_wrapper_"+a.gravityFormID+'  .gform_wrapper label[for="'+jQuery(this).attr("id")+'"]').addClass("checkbox");jQuery(this).before('<span class="icons"><span class="first-icon fui-checkbox-unchecked"></span><span class="second-icon fui-checkbox-checked"></span></span>');if(!jQuery("#gform_wrapper_"+a.gravityFormID+'  .gform_wrapper label[for="'+jQuery(this).attr("id")+'"]').parent("li").next().is("br")){jQuery("#gform_wrapper_"+a.gravityFormID+'  .gform_wrapper label[for="'+jQuery(this).attr("id")+'"]').parent("li").after("<br/>")}});jQuery("#gform_wrapper_"+a.gravityFormID+"  .gform_wrapper label.checkbox").each(function(){if(jQuery(this).find("[type=checkbox]").length>0){jQuery(this).find("[type=checkbox]").eq(1).remove()}if(jQuery(this).find("[type=checkbox]").is(":checked")){jQuery(this).find("[type=checkbox]").trigger("click")}});if(jQuery('#estimation_popup.wpe_bootstraped[data-form="'+a.formID+'"] #wtmt_paypalForm').length>0){jQuery('#estimation_popup.wpe_bootstraped[data-form="'+a.formID+'"] #wtmt_paypalForm  #btnOrderPaypal').hide()}jQuery(" #gform_submit_button_"+a.gravityFormID).click(function(d){d.preventDefault();if(!tld_selectionMode){if(!a.gravitySent){a.gravitySent=true;jQuery(this).addClass("anim");a.gFormDesignCheck=0;jQuery('#estimation_popup.wpe_bootstraped[data-form="'+a.formID+'"] #finalSlide').delay(1000).animate({opacity:0},1000);var c=jQuery(this);setTimeout(function(){jQuery('#estimation_popup.wpe_bootstraped[data-form="'+a.formID+'"] #finalSlide .gform_wrapper form').submit();a.timer_gFormDesign=setTimeout(function(){wpe_initGform(b)},2000)},1000)}}})}}function wpe_initPrice(b){var a=wpe_getForm(b);if(a.max_price>0){a.priceMax=a.max_price}else{jQuery('#estimation_popup.wpe_bootstraped[data-form="'+a.formID+'"] #mainPanel .genSlide [data-price]').each(function(){if(jQuery(this).data("price")&&jQuery(this).data("price")>0){if(jQuery(this).find(".icon_quantity").length>0){var c=parseFloat(jQuery(this).find(".icon_quantity").html());if(c>10&&parseFloat(jQuery(this).data("price"))>100){c=10}else{if(c>30){c=30}else{c=parseFloat(jQuery(this).find(".quantityBtns").data("max"))}}if(jQuery(this).data("operation")=="-"||jQuery(this).data("operation")=="/"){}else{a.priceMax+=parseFloat(jQuery(this).data("price"))*c}}else{if(jQuery(this).find(".wpe_qtfield").length>0){var c=parseFloat(jQuery(this).find(".wpe_qtfield").val());if(c>10&&parseFloat(jQuery(this).data("price"))>100){c=10}else{if(c>30){c=30}else{if(parseFloat(jQuery(this).find(".wpe_qtfield").attr("max").length>0)){c=parseFloat(jQuery(this).find(".wpe_qtfield").attr("max"))}else{c=30}}}if(jQuery(this).data("operation")=="-"||jQuery(this).data("operation")=="/"){}else{a.priceMax+=parseFloat(jQuery(this).data("price"))*c}}else{if(jQuery(this).data("operation")=="+"){a.priceMax+=parseFloat(jQuery(this).data("price"))}}}}});a.priceMax+=a.initialPrice;jQuery(' #estimation_popup.wpe_bootstraped[data-form="'+a.formID+'"] #mainPanel .genSlide [data-price][data-operation="x"]').each(function(){if(jQuery(this).find(".icon_quantity").length>0){for(var c=0;c<parseFloat(jQuery(this).find(".icon_quantity").html());c++){a.priceMax=a.priceMax+(a.priceMax*parseFloat(jQuery(this).data("price"))/100)}}else{a.priceMax=a.priceMax+(a.priceMax*parseFloat(jQuery(this).data("price"))/100)}})}}function initFlatUI(){jQuery("#estimation_popup.wpe_bootstraped .input-group").on("focus",".form-control",function(){jQuery(this).closest(".input-group, .form-group").addClass("focus")}).on("blur",".form-control",function(){jQuery(this).closest(".input-group, .form-group").removeClass("focus")});jQuery("#estimation_popup.wpe_bootstraped .pagination").on("click","a",function(){jQuery(this).parent().siblings("li").removeClass("active").end().addClass("active")});jQuery("#estimation_popup.wpe_bootstraped .btn-group").on("click","a",function(){jQuery(this).siblings().removeClass("active").end().addClass("active")});jQuery("#estimation_popup.wpe_bootstraped [data-toggle='switch']").wrap('<div class="switch"  data-on-label="<i class=\'fui-check\'></i>" data-off-label="<i class=\'fui-cross\'></i>" />').parent().bootstrapSwitch();jQuery("#estimation_popup.wpe_bootstraped input[type=checkbox][data-urltarget]").each(function(){jQuery(this).closest(".switch.has-switch").click(function(){if(!tld_selectionMode){if(jQuery(this).find(".switch-on").length>0){var a=window.open(jQuery(this).find("input[type=checkbox][data-urltarget]").attr("data-urltarget"),"_blank");if(typeof(a)!=="null"&&a!=null){a.focus()}}}})});if(jQuery("#estimation_popup.wpe_bootstraped .lfb_selectpicker").length>0){jQuery("#estimation_popup.wpe_bootstraped .lfb_selectpicker").selectpicker()}}function wpe_getFormContent(c,k,f){var b=wpe_getForm(c);var g="";var a="";var j="";var i=new Array();a+="Ref : "+b.current_ref+" \n";var l="";var e=lfb_lastSteps.slice();if(k){if(b.step!="final"){e.push(b.step)}}if(b.step=="final"){e.push("final")}if(typeof f!=="undefined"&&f>0){e=new Array();e.push(f)}var d=new Array();jQuery.each(e,function(){$panel=jQuery(' #estimation_popup.wpe_bootstraped[data-form="'+c+'"] #mainPanel .genSlide[data-stepid="'+this+'"]');if(($panel.attr("data-stepid")=="final"||jQuery.inArray(parseInt($panel.attr("data-stepid")),lfb_plannedSteps)>=0)&&!jQuery('#estimation_popup.wpe_bootstraped[data-form="'+c+'"] #mainPanel .genSlide[data-title][data-stepid="'+this+'"]').is(".lfb_disabled")){g+="<br/><p><u><b>"+$panel.data("title")+" :</b></u></p><br/>";a+="\n\n---------"+$panel.data("title")+" :---------\n";$panel.find(".itemBloc:not(.lfb_disabled)").each(function(){var n=jQuery(this);var t=true;if(n.find("div.selectable.checked").length>0){var y=n.find("div.selectable.checked").get(0);var q="";if(jQuery(y).is("[data-resqt]")){jQuery(y).data("resqt",jQuery(y).attr("data-resqt"))}if(jQuery(y).is("[data-resprice]")){jQuery(y).data("resprice",jQuery(y).attr("data-resprice"))}if($panel.is('[data-showstepsum="0"]')||!jQuery(y).is('[data-showinsummary="true"]')){t=false}var r=parseFloat(jQuery(y).data("resqt"));var z=parseFloat(jQuery(y).data("resprice"));if(r==0){r=1}if(r>1){q=r+"X "}if(jQuery(y).data("price")){if(jQuery(y).data("operation")=="+"){if(b.currencyPosition=="left"){z=b.currency+z}else{z+=b.currency}}else{if(jQuery(y).data("operation")=="-"){if(b.currencyPosition=="left"){z="-"+b.currency+z}else{z+="-"+b.currency}}else{if(jQuery(y).data("operation")=="/"){z="-"+jQuery(y).data("price")+"%"}else{z="+"+jQuery(y).data("price")+"%"}}}if(t){g+="    - "+q+jQuery(y).data("originaltitle")+" : "+z+"<br/>";a+=" - "+q+jQuery(y).data("originaltitle")+" : "+z+"\n"}}else{if(t){g+="    - "+q+jQuery(y).data("originaltitle")+"<br/>";a+=" - "+q+jQuery(y).data("originaltitle")+"\n"}}var o=parseFloat(jQuery(y).data("resprice"));if(isNaN(o)){o=parseFloat(jQuery(y).data("price"))}var u=false;if(jQuery(y).is('[data-singleprice="true"]')){u=true}if(jQuery.inArray(jQuery(y).attr("data-itemid"),d)==-1){d.push(jQuery(y).attr("data-itemid"));var x=jQuery(y).attr("data-title");if(jQuery(y).is("[data-original-title]")&&jQuery(y).is("[data-reducqt]")){x=jQuery(y).attr("data-original-title")}if(jQuery(y).is("[data-originaltitle]")&&jQuery(y).is('[data-showprice="1"]')){x=jQuery(y).attr("data-originaltitle")}i.push({label:x,itemid:jQuery(y).attr("data-itemid"),price:o,quantity:r,step:$panel.attr("data-title"),stepid:parseInt($panel.attr("data-stepid")),showInSummary:t,isSinglePrice:u})}}if(n.find("a.lfb_button.checked").length>0){var y=n.find("a.lfb_button.checked").get(0);var z=parseFloat(jQuery(y).data("price"));if($panel.is('[data-showstepsum="0"]')||!jQuery(y).is('[data-showinsummary="true"]')){t=false}if(jQuery(y).data("price")){if(jQuery(y).data("operation")=="+"){if(b.currencyPosition=="left"){z=b.currency+z}else{z+=b.currency}}else{if(jQuery(y).data("operation")=="-"){if(b.currencyPosition=="left"){z="-"+b.currency+z}else{z+="-"+b.currency}}else{if(jQuery(y).data("operation")=="/"){z="-"+z+"%"}else{z="+"+z+"%"}}}var w=jQuery(y).attr("data-originaltitle");if(jQuery(y).is("select")){w+=" ("+jQuery(y).val()+")"}if(t){g+="    - "+w+" : "+z+"<br/>";a+=" - "+w+" : "+z+"\n"}}else{var w=jQuery(y).attr("data-originaltitle");if(jQuery(y).is("select")){w+=" : "+jQuery(y).val()+""}if(t){g+="    - "+w+"<br/>";a+=" - "+w+"\n"}}var x=jQuery(y).attr("data-title");if(jQuery(y).is("[data-originaltitle]")&&jQuery(y).is('[data-showprice="1"]')){x=jQuery(y).attr("data-originaltitle")}if(jQuery(y).is("select")){x+=" : "+jQuery(y).val()}var u=false;if(jQuery(y).is('[data-singleprice="true"]')){u=true}if(jQuery.inArray(jQuery(y).attr("data-itemid"),d)==-1){d.push(jQuery(y).attr("data-itemid"));i.push({label:x,itemid:jQuery(y).attr("data-itemid"),price:parseFloat(jQuery(y).data("resprice")),quantity:1,step:$panel.attr("data-title"),stepid:parseInt($panel.attr("data-stepid")),showInSummary:t,isSinglePrice:u})}}if(n.find("input[type=checkbox]:checked").length>0){var y=n.find("input[type=checkbox]:checked").get(0);var z=parseFloat(jQuery(y).data("price"));if($panel.is('[data-showstepsum="0"]')||!jQuery(y).is('[data-showinsummary="true"]')){t=false}if(jQuery(y).data("price")){if(jQuery(y).data("operation")=="+"){if(b.currencyPosition=="left"){z=b.currency+z}else{z+=b.currency}}else{if(jQuery(y).data("operation")=="-"){if(b.currencyPosition=="left"){z="-"+b.currency+z}else{z+="-"+b.currency}}else{if(jQuery(y).data("operation")=="/"){z="-"+z+"%"}else{z="+"+z+"%"}}}var w=jQuery(y).attr("data-originaltitle");if(jQuery(y).is("select")){w+=" ("+jQuery(y).val()+")"}if(t){g+="    - "+w+" : "+z+"<br/>";a+=" - "+w+" : "+z+"\n"}}else{var w=jQuery(y).attr("data-originaltitle");if(jQuery(y).is("select")){w+=" : "+jQuery(y).val()+""}if(t){g+="    - "+w+"<br/>";a+=" - "+w+"\n"}}var x=jQuery(y).attr("data-title");if(jQuery(y).is("[data-originaltitle]")&&jQuery(y).is('[data-showprice="1"]')){x=jQuery(y).attr("data-originaltitle")}if(jQuery(y).is("select")){x+=" : "+jQuery(y).val()}var u=false;if(jQuery(y).is('[data-singleprice="true"]')){u=true}if(jQuery.inArray(jQuery(y).attr("data-itemid"),d)==-1){d.push(jQuery(y).attr("data-itemid"));i.push({label:x,itemid:jQuery(y).attr("data-itemid"),price:parseFloat(jQuery(y).data("resprice")),quantity:1,step:$panel.attr("data-title"),stepid:parseInt($panel.attr("data-stepid")),showInSummary:t,isSinglePrice:u})}}if(n.find('div[data-type="slider"]').length>0){var y=n.find('div[data-type="slider"]').get(0);var z=parseFloat(jQuery(y).data("price"));if($panel.is('[data-showstepsum="0"]')||!jQuery(y).is('[data-showinsummary="true"]')){t=false}if(jQuery(y).data("price")){if(jQuery(y).data("operation")=="+"){if(b.currencyPosition=="left"){z=b.currency+z}else{z+=b.currency}}else{if(jQuery(y).data("operation")=="-"){if(b.currencyPosition=="left"){z="-"+b.currency+z}else{z+="-"+b.currency}}else{if(jQuery(y).data("operation")=="/"){z="-"+z+"%"}else{z="+"+z+"%"}}}var w=jQuery(y).attr("data-originaltitle");if(jQuery(y).is("select")){w+=" ("+jQuery(y).val()+")"}if(t){g+="    - "+w+" : "+z+"<br/>";a+=" - "+w+" : "+z+"\n"}}else{var w=jQuery(y).attr("data-originaltitle");if(jQuery(y).is("select")){w+=" : "+jQuery(y).val()+""}if(t){g+="    - "+w+"<br/>";a+=" - "+w+"\n"}}var x=jQuery(y).attr("data-title");if(jQuery(y).is("[data-originaltitle]")&&jQuery(y).is('[data-showprice="1"]')){x=jQuery(y).attr("data-originaltitle")}if(jQuery(y).is("select")){x+=" : "+jQuery(y).val()}var u=false;if(jQuery(y).is('[data-singleprice="true"]')){u=true}if(jQuery.inArray(jQuery(y).attr("data-itemid"),d)==-1){d.push(jQuery(y).attr("data-itemid"));i.push({label:x,itemid:jQuery(y).attr("data-itemid"),price:parseFloat(jQuery(y).data("resprice")),quantity:parseFloat(jQuery(y).slider("value")),step:$panel.attr("data-title"),stepid:parseInt($panel.attr("data-stepid")),showInSummary:t,isSinglePrice:u})}}if(n.find("select[data-itemid]").length>0){var y=n.find("select[data-itemid]").get(0);var z=parseFloat(jQuery(y).data("price"));if($panel.is('[data-showstepsum="0"]')||!jQuery(y).is('[data-showinsummary="true"]')){t=false}if(jQuery(y).data("price")){if(jQuery(y).data("operation")=="+"){if(b.currencyPosition=="left"){z=b.currency+z}else{z+=b.currency}}else{if(jQuery(y).data("operation")=="-"){if(b.currencyPosition=="left"){z="-"+b.currency+z}else{z+="-"+b.currency}}else{if(jQuery(y).data("operation")=="/"){z="-"+z+"%"}else{z="+"+z+"%"}}}var w=jQuery(y).attr("data-originaltitle");if(jQuery(y).is("select")){w+=" ("+jQuery(y).val()+")"}if(t){g+="    - "+w+" : "+z+"<br/>";a+=" - "+w+" : "+z+"\n"}}else{var w=jQuery(y).attr("data-originaltitle");if(jQuery(y).is("select")){w+=" : "+jQuery(y).val()+""}if(t){g+="    - "+w+"<br/>";a+=" - "+w+"\n"}}var x=jQuery(y).attr("data-title");var u=false;if(jQuery(y).is('[data-singleprice="true"]')){u=true}if(jQuery.inArray(jQuery(y).attr("data-itemid"),d)==-1){d.push(jQuery(y).attr("data-itemid"));i.push({label:x,itemid:jQuery(y).attr("data-itemid"),price:parseFloat(jQuery(y).data("resprice")),value:jQuery(y).val(),quantity:1,step:$panel.attr("data-title"),stepid:parseInt($panel.attr("data-stepid")),showInSummary:t,isSinglePrice:u})}}if(n.find("input[type=file]").length>0){var y=n.find("input[type=file]").get(0);if($panel.is('[data-showstepsum="0"]')||!jQuery(y).is('[data-showinsummary="true"]')){t=false}if(t){g+='    - <span style="text-decoration: underline;" class="lfb_file">'+jQuery(y).data("originaltitle")+" : "+jQuery(y).val().replace(/ /g,"_")+"</span><br/>";a+=" - "+jQuery(y).data("originaltitle")+" : "+jQuery(y).val().replace(/ /g,"_")+"\n"}if($panel.is('[data-showstepsum="0"]')||!jQuery(y).is('[data-showinsummary="true"]')){t=false}if(jQuery.inArray(jQuery(y).attr("data-itemid"),d)==-1){d.push(jQuery(y).attr("data-itemid"));i.push({label:jQuery(y).data("title"),itemid:jQuery(y).attr("data-itemid"),value:jQuery(y).val(),step:$panel.attr("data-title"),stepid:parseInt($panel.attr("data-stepid")),showInSummary:t,isFile:true})}}if(n.find(".lfb_dropzone").length>0){var y=n.find(".lfb_dropzone").get(0);if($panel.is('[data-showstepsum="0"]')||!jQuery(y).is('[data-showinsummary="true"]')){t=false}var v="";var p="";jQuery(y).find(".dz-preview[data-file]").each(function(){v+=' - <span class="lfb_file">'+jQuery(this).attr("data-file").replace(/ /g,"_")+"</span><br/>";p+=" - "+jQuery(this).attr("data-file").replace(/ /g,"_")+"\n"});if(t){g+='    - <span class="lfb_file">'+jQuery(y).data("originaltitle")+" : "+v+"</span><br/>";a+=" - "+jQuery(y).data("originaltitle")+" : "+p+"\n\n"}if(jQuery.inArray(jQuery(y).attr("data-itemid"),d)==-1){d.push(jQuery(y).attr("data-itemid"));i.push({label:jQuery(y).data("title"),itemid:jQuery(y).attr("data-itemid"),value:v,step:$panel.attr("data-title"),stepid:parseInt($panel.attr("data-stepid")),showInSummary:t,isFile:true})}}if(n.find("input[type=text]:not(.lfb_colorpicker)").length>0){var y=n.find("input[type=text]:not(.lfb_colorpicker)").get(0);if($panel.is('[data-showstepsum="0"]')||!jQuery(y).is('[data-showinsummary="true"]')){t=false}if(t){g+="    - "+jQuery(y).data("title")+" : <b>"+jQuery(y).val()+"</b><br/>";a+=" - "+jQuery(y).data("title")+" : "+jQuery(y).val()+" \n"}if(jQuery.inArray(jQuery(y).attr("data-itemid"),d)==-1){d.push(jQuery(y).attr("data-itemid"));i.push({label:jQuery(y).data("title"),itemid:jQuery(y).attr("data-itemid"),value:jQuery(y).val(),step:$panel.attr("data-title"),stepid:parseInt($panel.attr("data-stepid")),showInSummary:t})}}if(n.find("input[type=number]:not(.lfb_colorpicker)").length>0){var y=n.find("input[type=number]:not(.lfb_colorpicker)").get(0);if($panel.is('[data-showstepsum="0"]')||!jQuery(y).is('[data-showinsummary="true"]')){t=false}if(t){g+="    - "+jQuery(y).data("title")+" : <b>"+jQuery(y).val()+"</b><br/>";a+=" - "+jQuery(y).data("title")+" : "+jQuery(y).val()+" \n"}var s=jQuery(y).val();var m=undefined;var o=undefined;if(jQuery(y).is('[data-valueasqt="1"]')){s=undefined;m=jQuery(y).val();o=parseFloat(jQuery(y).data("resprice"));if(isNaN(o)){o=parseFloat(jQuery(y).data("price"))}}var u=false;if(jQuery(y).is('[data-singleprice="true"]')){u=true}if(jQuery.inArray(jQuery(y).attr("data-itemid"),d)==-1){d.push(jQuery(y).attr("data-itemid"));i.push({label:jQuery(y).data("title"),itemid:jQuery(y).attr("data-itemid"),value:s,quantity:m,price:o,step:$panel.attr("data-title"),stepid:parseInt($panel.attr("data-stepid")),showInSummary:t,isSinglePrice:u})}}if(n.find(".lfb_colorPreview").length>0){var y=n.find(".lfb_colorPreview").get(0);if($panel.is('[data-showstepsum="0"]')||!jQuery(y).is('[data-showinsummary="true"]')){t=false}if(t){g+="    - "+jQuery(y).data("title")+" : <b>"+jQuery(y).next(".lfb_colorpicker").val()+"</b><br/>";a+=" - "+jQuery(y).data("title")+" : "+jQuery(y).next(".lfb_colorpicker").val()+" \n"}if(jQuery.inArray(jQuery(y).attr("data-itemid"),d)==-1){d.push(jQuery(y).attr("data-itemid"));i.push({label:jQuery(y).data("title"),itemid:jQuery(y).attr("data-itemid"),value:jQuery(y).next(".lfb_colorpicker").val(),step:$panel.attr("data-title"),stepid:parseInt($panel.attr("data-stepid")),showInSummary:t})}}if(n.find("textarea").length>0){var y=n.find("textarea").get(0);if($panel.is('[data-showstepsum="0"]')||!jQuery(y).is('[data-showinsummary="true"]')){t=false}if(t){g+="    - "+jQuery(y).data("title")+" : <b>"+jQuery(y).val()+"</b><br/>";a+=" - "+jQuery(y).data("title")+" : "+jQuery(y).val()+" \n"}if(jQuery.inArray(jQuery(y).attr("data-itemid"),d)==-1){d.push(jQuery(y).attr("data-itemid"));i.push({label:jQuery(y).data("title"),itemid:jQuery(y).attr("data-itemid"),value:wpe_nl2br(jQuery(y).val()),step:$panel.attr("data-title"),stepid:parseInt($panel.attr("data-stepid")),showInSummary:t})}}})}});if(!b.price||b.price<0){b.price=0}var h=/^\d+(\.\d{2})?$/;if(!h.test(b.price)){b.price=parseFloat(b.price).toFixed(2)}if(b.currencyPosition=="left"){j+=b.currency+wpe_formatPrice(parseFloat(b.price).toFixed(2),c);a+="\n\nTotal : "+b.currency+wpe_formatPrice(parseFloat(b.price).toFixed(2),c)}else{j+=wpe_formatPrice(parseFloat(b.price).toFixed(2),c)+b.currency;a+="\n\nTotal : "+wpe_formatPrice(parseFloat(b.price).toFixed(2),c)+b.currency}return new Array(g,j,i,a)}function wpe_check_gform_response(d){var c=wpe_getForm(d);if(jQuery('#estimation_popup.wpe_bootstraped[data-form="'+c.formID+'"] #gforms_confirmation_message').length>0){clearInterval(c.timer_gFormSubmit);if(jQuery('#estimation_popup.wpe_bootstraped[data-form="'+c.formID+'"] #wtmt_paypalForm').length>0&&c.price>0){var b=c.price;if(c.payMode=="percent"){b=parseFloat(b)*(parseFloat(c.percentToPay)/100)}else{if(c.payMode=="fixed"){b=parseFloat(c.fixedToPay)}}b=parseFloat(b).toFixed(2);if(c.priceSingle>0){var a=c.priceSingle;if(c.payMode=="percent"){a=parseFloat(a)*(parseFloat(c.percentToPay)/100)}else{if(c.payMode=="fixed"){a=parseFloat(c.fixedToPay)}}if(jQuery('#estimation_popup.wpe_bootstraped[data-form="'+c.formID+'"] #wtmt_paypalForm [name=a1]').length==0){jQuery('#estimation_popup.wpe_bootstraped[data-form="'+c.formID+'"] #wtmt_paypalForm').append('<input type="hidden" name="a1" value="0">');jQuery('#estimation_popup.wpe_bootstraped[data-form="'+c.formID+'"] #wtmt_paypalForm').append('<input type="hidden" name="p1" value="1">');jQuery('#estimation_popup.wpe_bootstraped[data-form="'+c.formID+'"] #wtmt_paypalForm').append('<input type="hidden" name="t1" value="M">')}jQuery('#estimation_popup.wpe_bootstraped[data-form="'+c.formID+'"] #wtmt_paypalForm [name=a1]').val(a);jQuery('#estimation_popup.wpe_bootstraped[data-form="'+c.formID+'"] #wtmt_paypalForm [name=p1]').val(jQuery('#estimation_popup.wpe_bootstraped[data-form="'+c.formID+'"] #wtmt_paypalForm [name=p3]').val())}else{jQuery('#estimation_popup.wpe_bootstraped[data-form="'+c.formID+'"] #wtmt_paypalForm [name=a1]').remove();jQuery('#estimation_popup.wpe_bootstraped[data-form="'+c.formID+'"] #wtmt_paypalForm [name=t1]').remove();jQuery('#estimation_popup.wpe_bootstraped[data-form="'+c.formID+'"] #wtmt_paypalForm [name=p1]').remove()}jQuery('#estimation_popup.wpe_bootstraped[data-form="'+c.formID+'"] #wtmt_paypalForm [name=amount]').val(b);jQuery('#estimation_popup.wpe_bootstraped[data-form="'+c.formID+'"] #wtmt_paypalForm [name=a3]').val(b);jQuery('#estimation_popup.wpe_bootstraped[data-form="'+c.formID+'"] #wtmt_paypalForm [name=item_number]').val(c.current_ref);jQuery('#estimation_popup.wpe_bootstraped[data-form="'+c.formID+'"] #wtmt_paypalForm [name=item_name]').val(jQuery('#estimation_popup.wpe_bootstraped[data-form="'+c.formID+'"] #wtmt_paypalForm [name=item_name]').val()+" - "+c.current_ref);jQuery('#estimation_popup.wpe_bootstraped[data-form="'+c.formID+'"] #wtmt_paypalForm [type="submit"]').trigger("click")}else{jQuery("#finalText").html(jQuery("#gform_wrapper_"+c.gravityFormID+" .gforms_confirmation_message").html());jQuery('#estimation_popup.wpe_bootstraped[data-form="'+c.formID+'"] #finalSlide #gforms_confirmation_message').fadeIn();jQuery('#estimation_popup.wpe_bootstraped[data-form="'+c.formID+'"] #finalSlide #lfb_summary').fadeOut();jQuery('#estimation_popup.wpe_bootstraped[data-form="'+c.formID+'"] #finalSlide #lfb_couponContainer').fadeOut();jQuery('#estimation_popup.wpe_bootstraped[data-form="'+c.formID+'"] #finalSlide #lfb_legalNoticeContent').fadeOut();jQuery('#estimation_popup.wpe_bootstraped[data-form="'+c.formID+'"] #finalSlide .linkPrevious').fadeOut();wpe_finalStep(d)}}}function wpe_quantity_less(c,e){var a=jQuery(c).parent().parent().find(".icon_quantity");var b=parseFloat(jQuery(c).parent().data("min"));var d=parseInt(a.html());if(d>1&&d>b){d--;a.html(d);wpe_updatePrice(e)}}function wpe_quantity_more(c,e){var b=jQuery(c).parent().parent().find(".icon_quantity");var a=parseFloat(jQuery(c).parent().data("max"));var d=parseFloat(b.html());if(d<a||a==0){d++;b.html(d);wpe_updatePrice(e)}}function wpe_checkEmail(a){if(a.indexOf("@")!="-1"&&a.indexOf(".")!="-1"&&a!=""){return true}return false}function wpe_isIframe(){try{return window.self!==window.top}catch(a){return true}}function wpe_cloneSummary(d,c){var b=jQuery('#estimation_popup.wpe_bootstraped[data-form="'+c+'"] #lfb_summary').clone();if(d){}if(b.find("#lfb_summaryDiscountTr").css("display")!="table-row"){b.find("#lfb_summaryDiscountTr").remove()}if(jQuery("body").is(".rtl")){b.css({textAlign:"right",direction:"rtl"});b.find("table").css({textAlign:"right",direction:"rtl"})}b.addClass("lfb-hidden");b.uniqueId();var a=4;if(form.summary_showAllPricesEmail=="1"){b.find(".lfb_hidePrice").removeClass("lfb_hidePrice").removeClass("lfb-hidden")}b.find("thead th").each(function(){if(jQuery(this).is(".lfb-hidden")){a--}});jQuery('#estimation_popup.wpe_bootstraped[data-form="'+c+'"] #lfb_summary').after(b);b.children("h4").remove();b.find("*").each(function(){jQuery(this).css({fontSize:jQuery(this).css("font-size"),padding:jQuery(this).css("padding"),textAlign:jQuery(this).css("text-align"),lineHeight:jQuery(this).css("line-height")})});if(jQuery('#estimation_popup.wpe_bootstraped[data-form="'+c+'"] #lfb_summary table thead > tr > th:eq(1)').is(".lfb-hidden")){b.find("table thead > tr > th:eq(1)").remove();b.find("table tbody td.lfb_valueTd").remove()}b.find("th.sfb_summaryStep").css({fontSize:22});b.find("th.sfb_summaryStep").attr("align","center");b.find("table").attr("width","90%");b.find("table").css("width","90%");b.find("table").attr("border","1");b.find("table").attr("bordercolor",lfb_rgb2hex(b.find("table").css("border-color")));b.find("table").attr("style","width:90%;margin:0 auto;");b.find("thead td, thead th").each(function(){jQuery(this).attr("bgcolor",lfb_rgb2hex(b.find("thead").css("background-color")));jQuery(this).css("background",lfb_rgb2hex(b.find("thead").css("background-color")))});b.find("td,th").each(function(){var e=(jQuery(this).width()*100)/b.find("table").width();jQuery(this).css("width",parseInt(e)+"%")});b.find("th").each(function(){jQuery(this).attr("bgcolor",lfb_rgb2hex(jQuery(this).css("background-color")))});b.find("td,th").each(function(){jQuery(this).attr("color",lfb_rgb2hex(jQuery(this).css("color")));jQuery(this).html('<span style="color: '+lfb_rgb2hex(jQuery(this).css("color"))+"; font-size: "+jQuery(this).css("font-size")+'">'+jQuery(this).html()+"</span>")});b.find("table .lfb-hidden").remove();b.find("table").attr("cellspacing","0");b.find("table").attr("cellpadding","8");b.find("table").attr("bgcolor","#FFFFFF");b.find("td,th").each(function(){jQuery(this).attr("align",jQuery(this).css("text-align"));jQuery(this).css("padding",jQuery(this).css("padding"))});b.find("thead > tr th:eq(0)").css({minWidth:500});if(form.summary_showAllPricesEmail=="1"){b.find(".sfb_summaryStep").attr("colspan",a);b.find("#lfb_summaryDiscountTr>th:eq(0),#sfb_summaryTotalTr>th:eq(0)").attr("colspan",a-1)}if(a==3){b.find("td:not(:first-child)").each(function(){jQuery(this).attr("width","164")});b.find("th:not(:first-child)").each(function(){jQuery(this).attr("width","164")});b.find("tr>td:first-child").each(function(){jQuery(this).attr("width","340")});b.find("tr>th:first-child").each(function(){jQuery(this).attr("width","340")})}else{b.find("td:not(:first-child)").each(function(){jQuery(this).attr("width","103")});b.find("th:not(:first-child)").each(function(){jQuery(this).attr("width","103")});b.find("tr>td:first-child").each(function(){jQuery(this).attr("width","332")});b.find("tr>th:first-child").each(function(){jQuery(this).attr("width","332")})}b.find("*").each(function(){var e=lfb_rgb2hex(jQuery(this).css("color"));jQuery(this).css({color:""});jQuery(this).attr("style",jQuery(this).attr("style")+";color:"+e);if(jQuery(this).attr("style").length>0){jQuery(this).attr("style",jQuery(this).attr("style")+";color:"+e)}else{jQuery(this).attr("style","color:"+e)}});b.find(".lfb_file").each(function(){jQuery(this).removeAttr("style");jQuery(this).removeAttr("data-tldinit")});b.html('<div id="lfb_summaryCt" style="padding-top: 24px;padding-bottom: 24px; text-align: center;">'+b.html()+"</div>");return b}function wpe_getContactInformations(d){var g=new Array();g.email="";g.phone="";g.firstName="";g.lastName="";g.address="";g.city="";g.state="";g.zip="";g.country="";jQuery('#estimation_popup.wpe_bootstraped[data-form="'+d+'"] [data-fieldtype="email"]').each(function(){if(jQuery(this).val().length>0&&wpe_checkEmail(jQuery(this).val())){g.email=jQuery(this).val()}});var f="";jQuery('#estimation_popup.wpe_bootstraped[data-form="'+d+'"] [data-fieldtype="phone"]').each(function(){if(jQuery(this).val().length>3){g.phone=jQuery(this).val()}});var i="";jQuery('#estimation_popup.wpe_bootstraped[data-form="'+d+'"] [data-fieldtype="firstName"]').each(function(){if(jQuery(this).val().length>0){g.firstName=jQuery(this).val()}});var j="";jQuery('#estimation_popup.wpe_bootstraped[data-form="'+d+'"] [data-fieldtype="lastName"]').each(function(){if(jQuery(this).val().length>0){g.lastName=jQuery(this).val()}});var h="";jQuery('#estimation_popup.wpe_bootstraped[data-form="'+d+'"] [data-fieldtype="address"]').each(function(){if(jQuery(this).val().length>0){g.address=jQuery(this).val()}});var e="";jQuery('#estimation_popup.wpe_bootstraped[data-form="'+d+'"] [data-fieldtype="city"]').each(function(){if(jQuery(this).val().length>0){g.city=jQuery(this).val()}});var a="";jQuery('#estimation_popup.wpe_bootstraped[data-form="'+d+'"] [data-fieldtype="state"]').each(function(){if(jQuery(this).val().length>0){g.state=jQuery(this).val()}});var b="";jQuery('#estimation_popup.wpe_bootstraped[data-form="'+d+'"] [data-fieldtype="zip"]').each(function(){if(jQuery(this).val().length>0){g.zip=jQuery(this).val()}});var c="";jQuery('#estimation_popup.wpe_bootstraped[data-form="'+d+'"] [data-fieldtype="country"]').each(function(){if(jQuery(this).val().length>0){g.country=jQuery(this).val()}});return g}function wpe_orderSend(m,c,n,l){var b=wpe_getForm(m);var q=wpe_getFormContent(m);var p=q[0];p=p.replace(/<br\/>/g,"[n]");var s=q[1];var i=q[2];if(jQuery('#estimation_popup.wpe_bootstraped[data-form="'+m+'"]').is("[data-subs]")){s+=jQuery('#estimation_popup.wpe_bootstraped[data-form="'+m+'"]').attr("data-subs")}var d=0;var f=true;jQuery('#estimation_popup.wpe_bootstraped[data-form="'+m+'"] [data-activatePaypal="true"]:not(:checked):not(.checked)').each(function(){var e=jQuery(this).closest(".genSlide").attr("data-stepid");if(e!="final"){e=parseInt(e)}if(jQuery.inArray(e,lfb_lastSteps)==-1){}else{f=false}});if(jQuery('#estimation_popup.wpe_bootstraped[data-form="'+m+'"]').find('[data-dontactivatepaypal="true"].checked,[data-dontactivatepaypal="true"]:checked').length>0){f=false}if(jQuery('#estimation_popup.wpe_bootstraped[data-form="'+m+'"] #wtmt_paypalForm').is('[data-useipn="1"]')){d=1}var j=wpe_cloneSummary(false,m);var v=j.html();j.remove();var o=wpe_getContactInformations(m);n=jQuery('#estimation_popup.wpe_bootstraped[data-form="'+m+'"] .emailField').val();if(wpe_checkEmail(o.email)){n=o.email}var y=parseFloat(b.price);var k=0;var w="";var r=jQuery('#estimation_popup.wpe_bootstraped[data-form="'+b.formID+'"]').attr("data-formtitle");if(jQuery('#estimation_popup.wpe_bootstraped[data-form="'+b.formID+'"]').is('[data-isSubs="true"]')){y=parseFloat(b.priceSingle);k=parseFloat(b.price);w=b.subscriptionText}var x="";if(jQuery('#estimation_popup.wpe_bootstraped[data-form="'+b.formID+'"] [name="stripeToken"]').length>0&&f){x=jQuery('#estimation_popup.wpe_bootstraped[data-form="'+b.formID+'"] [name="stripeToken"]').val()}var h="";if(jQuery('#estimation_popup.wpe_bootstraped[data-form="'+b.formID+'"] [name="stripeTokenB"]').length>0&&f){h=jQuery('#estimation_popup.wpe_bootstraped[data-form="'+b.formID+'"] [name="stripeTokenB"]').val()}var a=new Array();jQuery('#estimation_popup.wpe_bootstraped[data-form="'+b.formID+'"] #finalSlide input[type=text],#estimation_popup.wpe_bootstraped[data-form="'+b.formID+'"] #finalSlide input[type=email], #estimation_popup.wpe_bootstraped[data-form="'+b.formID+'"] #finalSlide textarea').each(function(){if(jQuery(this).closest("#lfb_stripeForm").length==0&&jQuery(this).closest("#wtmt_paypalForm").length==0){a.push({fieldID:jQuery(this).prop("id").substr(6,9),value:wpe_nl2br(jQuery(this).val())})}});var f=true;jQuery('#estimation_popup.wpe_bootstraped[data-form="'+m+'"] [data-activatePaypal="true"]:not(:checked):not(.checked)').each(function(){var e=jQuery(this).closest(".genSlide").attr("data-stepid");if(e!="final"){e=parseInt(e)}if(jQuery.inArray(e,lfb_lastSteps)==-1){}else{f=false}});if(jQuery('#estimation_popup.wpe_bootstraped[data-form="'+m+'"]').find('[data-dontactivatepaypal="true"].checked,[data-dontactivatepaypal="true"]:checked').length>0){f=false}var g="";if(jQuery('#estimation_popup.wpe_bootstraped[data-form="'+b.formID+'"] #lfb_captcha').length>0){g=jQuery('#estimation_popup.wpe_bootstraped[data-form="'+b.formID+'"] #lfb_captchaField').val()}if(typeof ga!=="undefined"){try{ga("set","page",location.pathname+"#Form+sent");ga("send","pageview")}catch(u){}}b.emailSent=true;if(localStorage.getItem("lfb_savedFormID")!==null&&parseInt(localStorage.getItem("lfb_savedFormID"))==m&&localStorage.getItem("lfb_savedForm")!==null){localStorage.removeItem("lfb_savedFormID");localStorage.removeItem("lfb_savedForm");localStorage.removeItem("lfb_savedFormPastSteps");localStorage.removeItem("lfb_savedFormStep")}jQuery('#estimation_popup.wpe_bootstraped[data-form="'+m+'"] .lfb_btnSaveForm').fadeOut();var t=new Array();jQuery('#estimation_popup.wpe_bootstraped[data-form="'+m+'"] .lfb_datepicker[data-calendarid!="0"][data-registerevent="1"]').each(function(){if(jQuery(this).val()!=""){var z={};z.calendarID=parseInt(jQuery(this).attr("data-calendarid"));z.duration=parseInt(jQuery(this).attr("data-eventduration"));z.durationType=jQuery(this).attr("data-eventdurationtype");if(z.durationType=="mins"){z.durationType="minutes"}z.isBusy=parseInt(jQuery(this).attr("data-eventbusy"));z.categoryID=parseInt(jQuery(this).attr("data-eventcategory"));z.startDate=moment(jQuery(this).datetimepicker("getDate")).format("YYYY-MM-DD HH:mm");z.endDate=moment(jQuery(this).datetimepicker("getDate")).add(z.duration,z.durationType).format("YYYY-MM-DD HH:mm");z.title=jQuery(this).attr("data-eventtitle");if(jQuery(this).attr("data-datetype")=="date"){z.startDate=moment(jQuery(this).datetimepicker("getDate")).format("YYYY-MM-DD");z.endDate=moment(jQuery(this).datetimepicker("getDate")).add(z.duration,z.durationType).format("YYYY-MM-DD");if(z.startDate==z.endDate){z.fullDay=1}}else{z.fullDay=0}if(jQuery(this).attr("data-useasdaterange")=="1"){var e=jQuery(this).attr("data-enddaterangeid");if(jQuery('#estimation_popup.wpe_bootstraped[data-form="'+m+'"] [data-itemid="'+e+'"]').length>0){z.fullDay=0;if(jQuery(this).attr("data-datetype")=="date"){z.endDate=moment(jQuery('#estimation_popup.wpe_bootstraped[data-form="'+m+'"] [data-itemid="'+e+'"]').datetimepicker("getDate")).format("YYYY-MM-DD")}else{z.endDate=moment(jQuery('#estimation_popup.wpe_bootstraped[data-form="'+m+'"] [data-itemid="'+e+'"]').datetimepicker("getDate")).format("YYYY-MM-DD HH:mm")}}}t.push(z)}});jQuery.ajax({url:b.ajaxurl,type:"post",data:{action:"send_email",formID:b.formID,informations:c,email:n,lastName:o.lastName,firstName:o.firstName,phone:o.phone,country:o.country,zip:o.zip,state:o.state,city:o.city,address:o.address,summary:v,stripeToken:x,stripeTokenB:h,totalTxt:s,email_toUser:b.email_toUser,usePaypalIpn:d,discountCode:b.discountCode,formSession:jQuery('#estimation_popup.wpe_bootstraped[data-form="'+b.formID+'"] #lfb_formSession').val(),total:y,totalSub:k,subFrequency:w,formTitle:r,contactSent:b.contactSent,contentTxt:p,items:i,fieldsLast:a,activatePaypal:f,captcha:g,useRtl:jQuery("body").is(".rtl"),finalUrl:lfb_getRedirectionURL(b.formID),eventsData:JSON.stringify(t)},success:function(C){if(C.indexOf("stripeError:")==0){b.emailSent=false;setTimeout(function(){jQuery('#estimation_popup.wpe_bootstraped[data-form="'+m+'"] #finalText').hide();jQuery('#estimation_popup.wpe_bootstraped[data-form="'+m+'"] #mainPanel').show();jQuery('#estimation_popup.wpe_bootstraped[data-form="'+m+'"] #finalSlide').show();jQuery('#estimation_popup.wpe_bootstraped[data-form="'+m+'"] #finalSlide .lfb_btnNextContainer').show();jQuery('#estimation_popup.wpe_bootstraped[data-form="'+m+'"] #wpe_btnOrderStripe').show().removeAttr("disabled");jQuery('#estimation_popup.wpe_bootstraped[data-form="'+m+'"] #lfb_loader').fadeOut();if(jQuery('#estimation_popup[data-form="'+m+'"]').is(".wpe_fullscreen")){jQuery("html,body").css("overflow-y","auto");jQuery('#estimation_popup.wpe_bootstraped[data-form="'+m+'"]').css("overflow-y","auto")}jQuery('#estimation_popup.wpe_bootstraped[data-form="'+m+'"] [data-stripe="number"]').closest(".form-group").addClass("has-error");var D=C.substr(12,C.length);jQuery('#estimation_popup.wpe_bootstraped[data-form="'+m+'"] #lfb_stripeForm .payment-errors').text(D);setTimeout(function(){if(jQuery('#estimation_popup.wpe_bootstraped[data-form="'+b.formID+'"]').is(".wpe_fullscreen")){jQuery('#estimation_popup.wpe_bootstraped[data-form="'+b.formID+'"]').animate({scrollTop:jQuery('#estimation_popup.wpe_bootstraped[data-form="'+m+'"] [data-stripe="number"]').offset().top-(80+parseInt(b.scrollTopMargin))},b.animationsSpeed*2)}else{jQuery("body,html").animate({scrollTop:jQuery('#estimation_popup.wpe_bootstraped[data-form="'+m+'"] [data-stripe="number"]').offset().top-(80+parseInt(b.scrollTopMargin))},b.animationsSpeed*2)}},1000)},1000)}else{j.remove();jQuery('#estimation_popup.wpe_bootstraped[data-form="'+m+'"] #lfb_loader').delay(1000).fadeOut();if(f&&jQuery('#estimation_popup.wpe_bootstraped[data-form="'+b.formID+'"] #wtmt_paypalForm').length>0&&(b.price>0||b.priceSingle>0)){var A=b.price;if(b.payMode=="percent"){A=parseFloat(A)*(parseFloat(b.percentToPay)/100)}else{if(b.payMode=="fixed"){A=parseFloat(b.fixedToPay)}}A=parseFloat(A).toFixed(2);if(b.priceSingle>0){var z=b.priceSingle;if(b.payMode=="percent"){z=parseFloat(z)*(parseFloat(b.percentToPay)/100)}else{if(b.payMode=="fixed"){z=parseFloat(b.fixedToPay)}}z=parseFloat(z).toFixed(2);if(jQuery('#estimation_popup.wpe_bootstraped[data-form="'+b.formID+'"] #wtmt_paypalForm [name=a1]').length==0){jQuery('#estimation_popup.wpe_bootstraped[data-form="'+b.formID+'"] #wtmt_paypalForm').append('<input type="hidden" name="a1" value="0"/>');jQuery('#estimation_popup.wpe_bootstraped[data-form="'+b.formID+'"] #wtmt_paypalForm').append('<input type="hidden" name="p1" value="1"/>');jQuery('#estimation_popup.wpe_bootstraped[data-form="'+b.formID+'"] #wtmt_paypalForm').append('<input type="hidden" name="t1" value="M"/>')}jQuery('#estimation_popup.wpe_bootstraped[data-form="'+b.formID+'"] #wtmt_paypalForm [name=a1]').val(z);jQuery('#estimation_popup.wpe_bootstraped[data-form="'+b.formID+'"] #wtmt_paypalForm [name=p1]').val(jQuery('#estimation_popup.wpe_bootstraped[data-form="'+b.formID+'"] #wtmt_paypalForm [name=p3]').val());if(A<=0){jQuery('#estimation_popup.wpe_bootstraped[data-form="'+b.formID+'"] #wtmt_paypalForm [name=cmd]').val("_xclick");jQuery('#estimation_popup.wpe_bootstraped[data-form="'+b.formID+'"] #wtmt_paypalForm [name=a3]').remove();jQuery('#estimation_popup.wpe_bootstraped[data-form="'+b.formID+'"] #wtmt_paypalForm [name=t3]').remove();jQuery('#estimation_popup.wpe_bootstraped[data-form="'+b.formID+'"] #wtmt_paypalForm [name=p3]').remove();jQuery('#estimation_popup.wpe_bootstraped[data-form="'+b.formID+'"] #wtmt_paypalForm [name=bn]').remove();jQuery('#estimation_popup.wpe_bootstraped[data-form="'+b.formID+'"] #wtmt_paypalForm [name=no_note]').remove();jQuery('#estimation_popup.wpe_bootstraped[data-form="'+b.formID+'"] #wtmt_paypalForm [name=src]').remove();jQuery('#estimation_popup.wpe_bootstraped[data-form="'+b.formID+'"] #wtmt_paypalForm [name=a1]').remove();jQuery('#estimation_popup.wpe_bootstraped[data-form="'+b.formID+'"] #wtmt_paypalForm [name=t1]').remove();jQuery('#estimation_popup.wpe_bootstraped[data-form="'+b.formID+'"] #wtmt_paypalForm [name=p1]').remove();jQuery('#estimation_popup.wpe_bootstraped[data-form="'+b.formID+'"] #wtmt_paypalForm').append('<input type="hidden" name="amount" value="'+z+'"/>')}}else{jQuery('#estimation_popup.wpe_bootstraped[data-form="'+b.formID+'"] #wtmt_paypalForm [name=a1]').remove();jQuery('#estimation_popup.wpe_bootstraped[data-form="'+b.formID+'"] #wtmt_paypalForm [name=t1]').remove();jQuery('#estimation_popup.wpe_bootstraped[data-form="'+b.formID+'"] #wtmt_paypalForm [name=p1]').remove();jQuery('#estimation_popup.wpe_bootstraped[data-form="'+b.formID+'"] #wtmt_paypalForm [name=amount]').val(A)}jQuery('#estimation_popup.wpe_bootstraped[data-form="'+b.formID+'"] #wtmt_paypalForm [name=return]').val(lfb_getRedirectionURL(m));jQuery('#estimation_popup.wpe_bootstraped[data-form="'+b.formID+'"] #wtmt_paypalForm [name=a3]').val(A);jQuery('#estimation_popup.wpe_bootstraped[data-form="'+b.formID+'"] #wtmt_paypalForm [name=custom]').val(C);jQuery('#estimation_popup.wpe_bootstraped[data-form="'+b.formID+'"] #wtmt_paypalForm [name=item_number]').val(C);jQuery('#estimation_popup.wpe_bootstraped[data-form="'+b.formID+'"] #wtmt_paypalForm [name=item_name]').val(jQuery('#estimation_popup.wpe_bootstraped[data-form="'+b.formID+'"] #wtmt_paypalForm [name=item_name]').val()+" - "+C);jQuery('#estimation_popup.wpe_bootstraped[data-form="'+b.formID+'"] #wtmt_paypalForm [type="submit"]').trigger("click")}else{if(jQuery('#estimation_popup.wpe_bootstraped[data-form="'+b.formID+'"] #lfb_stripeForm').length>0&&b.price>0){var A=b.price;if(b.payMode=="percent"){A=parseFloat(A)*(parseFloat(b.percentToPay)/100)}else{if(b.payMode=="fixed"){A=parseFloat(b.fixedToPay)}}A=A.toFixed(2);A=A.replace(".","");if(f){jQuery('#estimation_popup.wpe_bootstraped[data-form="'+b.formID+'"] #lfb_stripeForm .lfb_stripeContainer').show()}else{jQuery('#estimation_popup.wpe_bootstraped[data-form="'+b.formID+'"] #lfb_stripeForm .lfb_stripeContainer').hide()}wpe_finalStep(m)}else{if(!b.save_to_cart&&!b.save_to_cart_edd){wpe_finalStep(m)}}}if(b.save_to_cart_edd){var B=new Array();var e=lfb_lastSteps.slice();if(b.step!="final"&&jQuery.inArray(parseInt(b.step),e)==-1){e.push(parseInt(b.step))}else{if(b.step=="final"&&jQuery.inArray("final",e)==-1){e.push("final")}}jQuery.each(e,function(){$panel=jQuery(' #estimation_popup.wpe_bootstraped[data-form="'+m+'"] #mainPanel .genSlide[data-stepid="'+this+'"]');$panel.find('div.selectable.checked:not(.lfb_disabled),a.lfb_button.checked:not(.lfb_disabled),input[type=checkbox]:checked:not(.lfb_disabled),[data-type="slider"]:not(.lfb_disabled)').each(function(){var D=1;if(parseInt(jQuery(this).data("resqt"))>0){D=parseInt(jQuery(this).data("resqt"))}if(jQuery(this).is('[data-type="slider"]')){D=parseInt(jQuery(this).slider("value"));if(!isNaN(parseInt(jQuery(this).find(".tooltip-inner").html()))){D=parseInt(jQuery(this).find(".tooltip-inner").html())}}if(parseInt(jQuery(this).data("prodid"))>0){B.push({quantity:D,product_id:parseInt(jQuery(this).data("prodid")),variation:parseInt(jQuery(this).data("eddvar"))})}})});jQuery.ajax({url:b.ajaxurl,type:"post",data:{action:"lfb_cartdd_save",products:B},success:function(){wpe_finalStep(m)}})}if(b.save_to_cart){var B=new Array();var e=lfb_lastSteps.slice();if(b.step!="final"&&jQuery.inArray(parseInt(b.step),e)==-1){e.push(parseInt(b.step))}else{if(b.step=="final"&&jQuery.inArray("final",e)==-1){e.push("final")}}jQuery.each(e,function(){$panel=jQuery(' #estimation_popup.wpe_bootstraped[data-form="'+m+'"] #mainPanel .genSlide[data-stepid="'+this+'"]');$panel.find('div.selectable.checked:not(.lfb_disabled),a.lfb_button.checked:not(.lfb_disabled),input[type=checkbox]:checked:not(.lfb_disabled),[data-type="slider"]:not(.lfb_disabled)').each(function(){var D=1;if(parseInt(jQuery(this).data("resqt"))>0){D=parseInt(jQuery(this).data("resqt"))}if(jQuery(this).is('[data-type="slider"]')){D=parseInt(jQuery(this).slider("value"));if(!isNaN(parseInt(jQuery(this).find(".tooltip-inner").html()))){D=parseInt(jQuery(this).find(".tooltip-inner").html())}}if(parseInt(jQuery(this).data("prodid"))>0){B.push({quantity:D,product_id:parseInt(jQuery(this).data("prodid")),variation:parseInt(jQuery(this).attr("data-woovar"))})}})});jQuery.ajax({url:b.ajaxurl,type:"post",data:{action:"lfb_cart_save",ref:C,emptyWooCart:b.emptyWooCart,products:B},success:function(){wpe_finalStep(m)}})}}}})}function lfb_checkLastStepFields(c){var b=wpe_getForm(c);var a=true;jQuery('#estimation_popup.wpe_bootstraped[data-form="'+b.formID+'"] #finalSlide input[type=text],#estimation_popup.wpe_bootstraped[data-form="'+b.formID+'"] #finalSlide input[type=email], #estimation_popup.wpe_bootstraped[data-form="'+b.formID+'"] #finalSlide textarea').each(function(){if(jQuery(this).closest("#lfb_stripeForm").length==0&&jQuery(this).closest("#wtmt_paypalForm").length==0){if(jQuery(this).is(".lfb_disabled")){}else{if(jQuery(this).attr("data-required")&&jQuery(this).attr("data-required")=="true"&&jQuery(this).val().length<1){a=false;jQuery(this).closest(".form-group").addClass("has-error");if(!jQuery(this).is("#lfb_captchaField")){if(jQuery('#estimation_popup.wpe_bootstraped[data-form="'+b.formID+'"]').is(".wpe_fullscreen")||jQuery('#estimation_popup.wpe_bootstraped[data-form="'+b.formID+'"]').is(".wpe_popup")){jQuery('#estimation_popup.wpe_bootstraped[data-form="'+b.formID+'"]').animate({scrollTop:jQuery(this).parent().offset().top-(80+parseInt(b.scrollTopMargin))},b.animationsSpeed*2)}else{if(b.scrollTopPage=="1"){jQuery("body,html").animate({scrollTop:0},b.animationsSpeed*2)}else{jQuery("body,html").animate({scrollTop:jQuery(this).parent().offset().top-(80+parseInt(b.scrollTopMargin))},b.animationsSpeed*2)}}}}if(jQuery(this).is(".emailField")&&!wpe_checkEmail(jQuery(this).val())){a=false;jQuery(this).closest(".form-group").addClass("has-error");if(jQuery('#estimation_popup.wpe_bootstraped[data-form="'+b.formID+'"]').is(".wpe_fullscreen")||jQuery('#estimation_popup.wpe_bootstraped[data-form="'+b.formID+'"]').is(".wpe_popup")){jQuery('#estimation_popup.wpe_bootstraped[data-form="'+b.formID+'"]').animate({scrollTop:jQuery(this).parent().offset().top-(80+parseInt(b.scrollTopMargin))},b.animationsSpeed*2)}else{if(b.scrollTopPage=="1"){jQuery("body,html").animate({scrollTop:0},b.animationsSpeed*2)}else{jQuery("body,html").animate({scrollTop:jQuery(this).parent().offset().top-(80+parseInt(b.scrollTopMargin))},b.animationsSpeed*2)}}}}}});return a}function wpe_order(f){var e=wpe_getForm(f);var b=true;var d="";var c="";var a=new Array();jQuery('#estimation_popup.wpe_bootstraped[data-form="'+e.formID+'"] #finalSlide .form-group').removeClass("has-error");jQuery('#estimation_popup.wpe_bootstraped[data-form="'+e.formID+'"] #finalSlide').find('.lfb_item input:not([type="checkbox"]),.lfb_item textarea,.lfb_item select').each(function(){if(jQuery(this).closest("#lfb_stripeForm").length==0&&jQuery(this).closest("#wtmt_paypalForm").length==0){if(jQuery(this).is(".lfb_disabled")){}else{if(jQuery(this).is("#lfb_couponField")){}else{if(jQuery(this).is("#lfb_captchaField")){}else{var g=":";if(jQuery(this).closest(".lfb_item").find("label").html().lastIndexOf(":")==jQuery(this).closest(".lfb_item").find("label").html().length-1){g=""}if(jQuery("body").is(".rtl")){d+="<p><b>"+jQuery(this).val()+"</b>"+g+" "+jQuery(this).closest(".lfb_item").find("label").html()+"</p>"}else{d+="<p>"+jQuery(this).closest(".lfb_item").find("label").html()+" "+g+" <b>"+jQuery(this).val()+"</b></p>"}}}}}});b=lfb_checkStepItemsValid("final",f);if(e.legalNoticeEnable==1){if(!jQuery('#estimation_popup.wpe_bootstraped[data-form="'+e.formID+'"] #lfb_legalCheckbox').is(":checked")){jQuery('#estimation_popup.wpe_bootstraped[data-form="'+e.formID+'"] #lfb_legalCheckbox').closest(".form-group").addClass("has-error");b=false}}if(b==true){if(jQuery('#estimation_popup.wpe_bootstraped[data-form="'+e.formID+'"] #lfb_captcha').length>0){jQuery.ajax({url:e.ajaxurl,type:"post",data:{action:"lfb_checkCaptcha",formID:f,captcha:jQuery('#estimation_popup.wpe_bootstraped[data-form="'+e.formID+'"] #lfb_captchaField').val()},success:function(g){if(g=="1"){jQuery('#estimation_popup.wpe_bootstraped[data-form="'+e.formID+'"] #finalSlide').find("#wpe_btnOrder,.linkPrevious").fadeOut(250);wpe_uploadFiles(f,d,c,a)}else{jQuery('#estimation_popup.wpe_bootstraped[data-form="'+e.formID+'"] #lfb_captchaField').closest(".form-group").addClass("has-error")}}})}else{jQuery('#estimation_popup.wpe_bootstraped[data-form="'+e.formID+'"] #finalSlide').find("#wpe_btnOrder,.linkPrevious").fadeOut(250);wpe_uploadFiles(f,d,c,a)}}else{jQuery('#estimation_popup.wpe_bootstraped[data-form="'+f+'"] #lfb_stripeForm .btn').prop("disabled",false)}}function wpe_previousStep(g){var e=wpe_getForm(g);var b=navigator.userAgent.toLowerCase();var f=b.match(/(iPad|iPhone|iPod)/i);if(f){jQuery("#estimation_popup :not(.ui-slider-handle) > .tooltip").remove();jQuery("body > .tooltip").remove();jQuery('#estimation_popup[data-form="'+e.formID+'"] > .tooltip').remove()}jQuery('#estimation_popup.wpe_bootstraped[data-form="'+e.formID+'"] .errorMsg').hide();jQuery(' #estimation_popup.wpe_bootstraped[data-form="'+g+'"] #mainPanel .genSlide[data-stepid="'+e.step+'"]').find("a.lfb_button.checked:not(.prechecked)").each(function(){wpe_itemClick(jQuery(this),false,g)});jQuery(' #estimation_popup.wpe_bootstraped[data-form="'+g+'"] #mainPanel .genSlide[data-stepid="'+e.step+'"]').find("div.selectable.checked:not(.prechecked)").each(function(){wpe_itemClick(jQuery(this),false,g)});jQuery(' #estimation_popup.wpe_bootstraped[data-form="'+g+'"] #mainPanel .genSlide[data-stepid="'+e.step+'"]').find('input[data-toggle="switch"]:checked:not(.prechecked)').each(function(){jQuery(this).trigger("click.auto")});var a=false;var d=0;var c=0;jQuery.each(lfb_lastSteps,function(h){var j=this;if(parseInt(j)==parseInt(e.step)){a=true}if(!a){if((jQuery('#estimation_popup.wpe_bootstraped[data-form="'+g+'"] #mainPanel .genSlide[data-stepid="'+j+'"] .lfb_item:not(.lfb-hidden)').length>0||jQuery('#estimation_popup.wpe_bootstraped[data-form="'+g+'"] #mainPanel .genSlide[data-stepid="'+j+'"] .lfb_distanceError').length>0)&&!jQuery('#estimation_popup.wpe_bootstraped[data-form="'+g+'"] #mainPanel .genSlide[data-stepid="'+j+'"]').is(".lfb_disabled")){d=j;c=h}}});lfb_lastSteps=jQuery.grep(lfb_lastSteps,function(j,h){if(h<=c){return(j)}});wpe_changeStep(d,g)}function lfb_returnToStep(f,e){var b=wpe_getForm(e);if(f!=b.step){var a=navigator.userAgent.toLowerCase();var d=a.match(/(iPad|iPhone|iPod)/i);if(d){jQuery("#estimation_popup :not(.ui-slider-handle) > .tooltip").remove();jQuery("body > .tooltip").remove();jQuery('#estimation_popup[data-form="'+b.formID+'"] > .tooltip').remove()}jQuery('#estimation_popup.wpe_bootstraped[data-form="'+b.formID+'"] .errorMsg').hide();jQuery(' #estimation_popup.wpe_bootstraped[data-form="'+e+'"] #mainPanel .genSlide[data-stepid="'+b.step+'"]').find("a.lfb_button.checked:not(.prechecked)").each(function(){wpe_itemClick(jQuery(this),false,e)});jQuery(' #estimation_popup.wpe_bootstraped[data-form="'+e+'"] #mainPanel .genSlide[data-stepid="'+b.step+'"]').find("div.selectable.checked:not(.prechecked)").each(function(){wpe_itemClick(jQuery(this),false,e)});jQuery(' #estimation_popup.wpe_bootstraped[data-form="'+e+'"] #mainPanel .genSlide[data-stepid="'+b.step+'"]').find('input[data-toggle="switch"]:checked:not(.prechecked)').each(function(){jQuery(this).trigger("click.auto")});var c=lfb_lastSteps.indexOf(f);lfb_lastSteps=jQuery.grep(lfb_lastSteps,function(h,g){if(g<=c){return(h)}});wpe_changeStep(f,e);setTimeout(function(){wpe_updateSummary(e,true)},350)}}function wpe_uploadFiles(e,c,b,a){var d=wpe_getForm(e);if(jQuery('#estimation_popup.wpe_bootstraped[data-form="'+d.formID+'"]').is('[data-emaillaststep="1"]')){}else{if(jQuery('#estimation_popup.wpe_bootstraped[data-form="'+e+'"]').is(".wpe_fullscreen")){jQuery('#estimation_popup.wpe_bootstraped[data-form="'+e+'"]').css("overflow-y","hidden");jQuery('#estimation_popup.wpe_bootstraped[data-form="'+e+'"]').animate({scrollTop:0},d.animationsSpeed*2)}else{if(d.scrollTopPage=="1"){jQuery("body,html").animate({scrollTop:0},d.animationsSpeed*2)}else{jQuery("body,html").animate({scrollTop:jQuery('#estimation_popup.wpe_bootstraped[data-form="'+e+'"]').offset().top-(80+parseInt(d.scrollTopMargin))},d.animationsSpeed*2)}}jQuery('#estimation_popup.wpe_bootstraped[data-form="'+e+'"] .lfb_btnFloatingSummary').fadeOut(d.animationsSpeed);jQuery('#estimation_popup.wpe_bootstraped[data-form="'+e+'"] #lfb_floatingSummary').fadeOut(d.animationsSpeed);jQuery('#estimation_popup.wpe_bootstraped[data-form="'+e+'"] #lfb_loader').fadeIn(d.animationsSpeed*2);setTimeout(function(){jQuery('#estimation_popup.wpe_bootstraped[data-form="'+e+'"] #mainPanel').fadeOut(d.animationsSpeed*2);jQuery('#estimation_popup.wpe_bootstraped[data-form="'+e+'"] #startInfos').fadeOut(d.animationsSpeed*2);jQuery('#estimation_popup.wpe_bootstraped[data-form="'+e+'"] #genPrice').fadeOut(d.animationsSpeed*2);jQuery(' #estimation_popup.wpe_bootstraped[data-form="'+e+'"] #mainPanel .genSlide').fadeOut(d.animationsSpeed*2);jQuery(' #estimation_popup.wpe_bootstraped[data-form="'+e+'"] #mainPanel .btn-next').fadeOut(d.animationsSpeed);jQuery('#estimation_popup.wpe_bootstraped[data-form="'+e+'"] #mainPanel .lfb_btnNextContainer').fadeOut(d.animationsSpeed);jQuery('#estimation_popup.wpe_bootstraped[data-form="'+e+'"] #finalText').css({opacity:0,display:"block"});setTimeout(function(){if(jQuery('#estimation_popup.wpe_bootstraped[data-form="'+e+'"]').is(".wpe_fullscreen")){jQuery('#estimation_popup.wpe_bootstraped[data-form="'+e+'"]').animate({scrollTop:0},d.animationsSpeed*2)}else{if(d.scrollTopPage=="1"){jQuery("body,html").animate({scrollTop:0},d.animationsSpeed*2)}else{jQuery("body,html").animate({scrollTop:jQuery('#estimation_popup.wpe_bootstraped[data-form="'+e+'"]').offset().top-(80+parseInt(d.scrollTopMargin))},d.animationsSpeed*2)}}jQuery('#estimation_popup.wpe_bootstraped[data-form="'+e+'"] #finalText').animate({opacity:1},d.animationsSpeed*2)},d.animationsSpeed*4+50)},d.animationsSpeed*2+50)}wpe_orderSend(e,c,b,a)}function wpe_isAnyParentFixed(a,b){if(!b){var b=false}try{if(a.parent().length>0&&a.parent().css("position")=="fixed"){b=true}}catch(c){}if(!b&&a.parent().length>0){b=wpe_isAnyParentFixed(a.parent(),b)}return b}function wpe_is_touch_device(){return(("ontouchstart" in window)||(navigator.MaxTouchPoints>0)||(navigator.msMaxTouchPoints>0))}function lfb_toggleFloatingSummary(a){if(jQuery('#estimation_popup.wpe_bootstraped[data-form="'+a+'"] #lfb_floatingSummary').is(".lfb_open")){lfb_closeFloatingSummary(a)}else{lfb_showFloatingSummary(a)}}function lfb_closeFloatingSummary(a){jQuery('#estimation_popup.wpe_bootstraped[data-form="'+a+'"] #lfb_floatingSummary').removeClass("lfb_open");jQuery('#estimation_popup.wpe_bootstraped[data-form="'+a+'"] #lfb_floatingSummary').stop().slideUp()}function lfb_showFloatingSummary(a){jQuery('#estimation_popup.wpe_bootstraped[data-form="'+a+'"] #lfb_floatingSummary').addClass("lfb_open");jQuery('#estimation_popup.wpe_bootstraped[data-form="'+a+'"] #lfb_floatingSummary').stop().slideDown()}function wpe_updateFloatingSummary(b){if(jQuery('#estimation_popup.wpe_bootstraped[data-form="'+b+'"] #lfb_floatingSummary').length>0){var a=jQuery('#estimation_popup.wpe_bootstraped[data-form="'+b+'"] #lfb_summary').clone();if(a.find("tbody").children(":not(.lfb_static)").length==0&&jQuery('#estimation_popup.wpe_bootstraped[data-form="'+b+'"] #lfb_floatingSummary').is('[data-numberstep="1"]')){lfb_closeFloatingSummary(b);jQuery('#estimation_popup.wpe_bootstraped[data-form="'+b+'"] .lfb_btnFloatingSummary:not(.disabled)').addClass("disabled")}else{jQuery('#estimation_popup.wpe_bootstraped[data-form="'+b+'"] .lfb_btnFloatingSummary').removeClass("disabled");a.find("h4").remove();a.attr("id","lfb_floatingSummaryContent");a.removeClass("lfb-hidden");a.find(".lfb_valueTd,.lfb_valueTh").addClass("lfb-hidden");if(jQuery('#estimation_popup.wpe_bootstraped[data-form="'+b+'"] #lfb_floatingSummary').is('[data-hideprices="1"]')){a.find(".lfb_priceTd,.lfb_priceTh").addClass("lfb-hidden");a.find("#lfb_summaryDiscountTr,#sfb_summaryTotalTr").addClass("lfb-hidden")}a.find(".sfb_summaryStep").attr("colspan",a.find("thead th:not(.lfb-hidden)").length);a.find("tr.lfb_noPriceRow").remove();a.find("#lfb_summaryDiscountTr>th:eq(0),#sfb_summaryTotalTr>th:eq(0)").attr("colspan",a.find("thead th:not(.lfb-hidden)").length-1);jQuery('#estimation_popup.wpe_bootstraped[data-form="'+b+'"] #lfb_floatingSummary #lfb_floatingSummaryInner').html(a);a.find(".sfb_summaryStep").click(function(){var c=parseInt(jQuery(this).attr("data-step"));lfb_returnToStep(c,b)});if(jQuery('#estimation_popup.wpe_bootstraped[data-form="'+b+'"] #lfb_floatingSummary').is('[data-numberstep="1"]')){a.find(".sfb_summaryStep").each(function(c){var d=c+1;jQuery(this).find("strong").html(d+". "+jQuery(this).find("strong").html())})}}}}function wpe_updateSummary(p,d){var a=wpe_getForm(p);if(jQuery('#estimation_popup.wpe_bootstraped[data-form="'+p+'"] #lfb_summary').length>0||jQuery('#estimation_popup.wpe_bootstraped[data-form="'+p+'"] #lfb_floatingSummary').length>0){var q=true;if(d){q=false}var m=wpe_getFormContent(p,q);var o=m[2];var g=-1;var n=false;jQuery('#estimation_popup.wpe_bootstraped[data-form="'+p+'"] #lfb_summary table tbody tr:not(.lfb_static)').remove();var h="";if(a.summary_hidePrices==1){h="lfb-hidden lfb_hidePrice"}jQuery.each(o,function(){var A=this;if(A.label!=undefined&&A.label!=""&&A.label!="undefined"){if(isNaN(A.stepid)){A.stepid="final"}if(A.stepid!="final"||a.summary_hideFinalStep!="1"){if(A.stepid!=g){jQuery('#estimation_popup.wpe_bootstraped[data-form="'+p+'"] #lfb_summary table tbody #lfb_summaryDiscountTr').before('<tr><th colspan="4" class="sfb_summaryStep" data-step="'+A.stepid+'"><strong>'+A.step+"</strong></th>")}g=A.stepid;if(isNaN(A.quantity)){A.quantity=1}var y="";if(isNaN(A.price)){y="lfb_noPriceRow";A.price=0}var z=A.value;if(A.value===undefined){z=""}else{y+=" lfb_infoRow"}if(z!=""&&A.showInSummary){n=true}var B=A.price;var w=A.quantity;if(z!=""&&B==0&&w==1){w="";B=""}else{var t=false;if(parseFloat(B)<0){t=true;B*=-1}if(a.currencyPosition=="left"){B=a.currency+""+wpe_formatPrice(parseFloat(B).toFixed(2),p)}else{B=wpe_formatPrice(parseFloat(B).toFixed(2),p)+""+a.currency}if(t){B="- "+B}}var u="";if(A.isFile){}var v="";if(a.summary_hideQt==1){v="lfb-hidden"}if(a.summary_hideZero==1&&A.price==0){B=""}var x="";if(!A.showInSummary){x="lfb-hidden"}if(jQuery('#estimation_popup.wpe_bootstraped[data-form="'+p+'"] [data-itemid="'+A.itemid+'"]').is('[data-hideqtsum="true"]')){w=""}if(a.priceSingle>0&&!A.isSinglePrice&&(B!=""||B>0)){B+=" "+a.subscriptionText}if(a.price<=0){jQuery('#estimation_popup.wpe_bootstraped[data-form="'+p+'"] #lfb_summary .lfb_subTxt').addClass("lfb-hidden")}else{jQuery('#estimation_popup.wpe_bootstraped[data-form="'+p+'"] #lfb_summary .lfb_subTxt').removeClass("lfb-hidden")}jQuery('#estimation_popup.wpe_bootstraped[data-form="'+p+'"] #lfb_summary table tbody #lfb_summaryDiscountTr').before('<tr data-item="'+A.itemid+'" data-itemstep="'+A.stepid+'" class="'+y+" "+x+'"><td>'+A.label+'</td><td class="lfb_valueTd '+u+'">'+z+'</td><td class="lfb_quantityTd '+v+'">'+w+'</td><td class="lfb_priceTd '+h+'">'+B+"</td></tr>")}}});if(a.reductionResult>0){var b=parseFloat(a.reductionResult).toFixed(2)+a.currency;if(a.currencyPosition=="left"){b=a.currency+parseFloat(a.reductionResult).toFixed(2)}b="-"+b;jQuery('#estimation_popup.wpe_bootstraped[data-form="'+p+'"] #lfb_summary #lfb_summaryDiscount>span').html(b);if(!a.discountCodeDisplayed){var i=jQuery('#estimation_popup.wpe_bootstraped[data-form="'+p+'"] #lfb_summary #lfb_summaryDiscountTr th[colspan]').html();if(i.indexOf("<i>")<0){if(i.substr(i.length-1,1)==":"){jQuery('#estimation_popup.wpe_bootstraped[data-form="'+p+'"] #lfb_summary #lfb_summaryDiscountTr th[colspan]').html(i.substr(0,i.length-1)+" <i>("+a.discountCode+")</i> :")}else{jQuery('#estimation_popup.wpe_bootstraped[data-form="'+p+'"] #lfb_summary #lfb_summaryDiscountTr th[colspan]').html(i+" <i>("+a.discountCode+")</i>")}}}jQuery('#estimation_popup.wpe_bootstraped[data-form="'+p+'"] #lfb_summary #lfb_summaryDiscountTr').slideDown();jQuery('#estimation_popup.wpe_bootstraped[data-form="'+p+'"] #lfb_floatingSummary #lfb_summaryDiscountTr').slideDown()}if(!a.price||a.price<0){a.price=0}jQuery('#estimation_popup.wpe_bootstraped[data-form="'+p+'"] #lfb_summary table tr th.sfb_summaryStep').each(function(){if(jQuery('#estimation_popup.wpe_bootstraped[data-form="'+p+'"] #lfb_summary table tr[data-itemstep="'+jQuery(this).attr("data-step")+'"]:not(.lfb-hidden)').length==0){jQuery(this).parent().addClass("lfb-hidden")}});var l=a.currency+""+wpe_formatPrice(parseFloat(a.price).toFixed(2),p);var j=a.currency+""+wpe_formatPrice(parseFloat(a.priceSingle).toFixed(2),p);if(a.currencyPosition!="left"){l=wpe_formatPrice(parseFloat(a.price).toFixed(2),p)+""+a.currency;j=wpe_formatPrice(parseFloat(a.priceSingle).toFixed(2),p)+""+a.currency}jQuery('#estimation_popup.wpe_bootstraped[data-form="'+p+'"] #lfb_summary table #lfb_summaryTotal>span:eq(0)').html(l);if(jQuery('#estimation_popup.wpe_bootstraped[data-form="'+a.formID+'"]').is("[data-totalrange]")&&parseFloat(a.price)>0){var s=jQuery('#estimation_popup.wpe_bootstraped[data-form="'+a.formID+'"]').attr("data-rangelabelbetween");var r=jQuery('#estimation_popup.wpe_bootstraped[data-form="'+a.formID+'"]').attr("data-rangelabeland");var k=parseFloat(jQuery('#estimation_popup.wpe_bootstraped[data-form="'+a.formID+'"]').attr("data-totalrange"));var e=(parseFloat(a.price)-k/2);var f=parseFloat(a.price)+k/2;if(jQuery('#estimation_popup.wpe_bootstraped[data-form="'+a.formID+'"]').is('[data-rangemode="percent"]')){e=parseFloat(a.price)-((parseFloat(a.price)*k)/100);f=parseFloat(a.price)+((parseFloat(a.price)*k)/100)}if(e<0){e=0}if(f<0){f=0}formatedPrice=s+" <strong>"+a.currency+""+wpe_formatPrice(e,p)+"</strong> "+r+" <strong>"+a.currency+""+wpe_formatPrice(f,p)+"</strong>";if(a.currencyPosition!="left"){var k=parseInt(jQuery('#estimation_popup.wpe_bootstraped[data-form="'+a.formID+'"]').attr("data-totalrange"));formatedPrice=s+" <strong>"+wpe_formatPrice(e,p)+a.currency+"</strong> "+r+" <strong>"+wpe_formatPrice(f,p)+a.currency+"</strong>"}jQuery('#estimation_popup.wpe_bootstraped[data-form="'+p+'"] #lfb_summary table #lfb_summaryTotal>span:eq(0)').html(formatedPrice)}var c=4;if(a.summary_hideQt==1){c-=1}if(a.summary_hidePrices==1){c-=1}if(!n){c-=1;jQuery('#estimation_popup.wpe_bootstraped[data-form="'+p+'"] #lfb_summary table td.lfb_valueTd').hide();jQuery('#estimation_popup.wpe_bootstraped[data-form="'+p+'"] #lfb_summary table thead th:eq(1)').hide().addClass("lfb-hidden");jQuery('#estimation_popup.wpe_bootstraped[data-form="'+p+'"] #lfb_summary table tbody tr#sfb_summaryTotalTr th[colspan]').attr("colspan",c-1);jQuery('#estimation_popup.wpe_bootstraped[data-form="'+p+'"] #lfb_summary table tbody tr#lfb_summaryDiscountTr th[colspan]').attr("colspan",c-1);jQuery('#estimation_popup.wpe_bootstraped[data-form="'+p+'"] #lfb_summary table tbody tr th.sfb_summaryStep').attr("colspan",c)}else{jQuery('#estimation_popup.wpe_bootstraped[data-form="'+p+'"] #lfb_summary table thead th:eq(1)').show().removeClass("lfb-hidden");jQuery('#estimation_popup.wpe_bootstraped[data-form="'+p+'"] #lfb_summary table tbody tr:eq(1)').show();jQuery('#estimation_popup.wpe_bootstraped[data-form="'+p+'"] #lfb_summary table tbody td.lfb_valueTd').show();jQuery('#estimation_popup.wpe_bootstraped[data-form="'+p+'"] #lfb_summary table tbody tr#sfb_summaryTotalTr th[colspan]').attr("colspan",c-1);jQuery('#estimation_popup.wpe_bootstraped[data-form="'+p+'"] #lfb_summary table tbody tr#lfb_summaryDiscountTr th[colspan]').attr("colspan",c-1);jQuery('#estimation_popup.wpe_bootstraped[data-form="'+p+'"] #lfb_summary table tbody tr th.sfb_summaryStep').attr("colspan",c)}}wpe_updateFloatingSummary(p)}function wpe_changeStep(o,f){var b=wpe_getForm(f);jQuery("#estimation_popup :not(.ui-slider-handle) > .tooltip").remove();jQuery("body > .tooltip").remove();jQuery('#estimation_popup[data-form="'+b.formID+'"] > .tooltip').remove();if(b.intro_enabled>0||b.step>0){var h=jQuery('#estimation_popup.wpe_bootstraped[data-form="'+f+'"]  #mainPanel').offset().top-100;if(jQuery('#estimation_popup.wpe_bootstraped[data-form="'+f+'"]').is(".wpe_fullscreen")||jQuery('#estimation_popup.wpe_bootstraped[data-form="'+f+'"]').is(".wpe_popup")){h=0;if(b.intro_enabled>0){h=jQuery('#estimation_popup.wpe_bootstraped[data-form="'+f+'"] #startInfos').height()+100}jQuery('#estimation_popup.wpe_bootstraped[data-form="'+f+'"]').animate({scrollTop:h},250)}else{if(jQuery("header").length>0&&wpe_isAnyParentFixed(jQuery("header"))){h-=jQuery("header").height()}h-=(48+parseInt(b.scrollTopMargin));if(b.scrollTopPage=="1"){jQuery("body,html").animate({scrollTop:0},b.animationsSpeed*2)}else{jQuery("body,html").animate({scrollTop:h},250)}}}jQuery('#estimation_popup.wpe_bootstraped[data-form="'+f+'"] .quantityBtns').removeClass("open");jQuery('#estimation_popup.wpe_bootstraped[data-form="'+f+'"] .quantityBtns').fadeOut(b.animationsSpeed/4);jQuery(' #estimation_popup.wpe_bootstraped[data-form="'+f+'"] #mainPanel .genSlide').fadeOut(b.animationsSpeed*2);jQuery(' #estimation_popup.wpe_bootstraped[data-form="'+f+'"] #mainPanel .btn-next').fadeOut(b.animationsSpeed/2);jQuery('#estimation_popup.wpe_bootstraped[data-form="'+f+'"] #mainPanel .lfb_btnNextContainer').fadeOut(b.animationsSpeed/2);jQuery(' #estimation_popup.wpe_bootstraped[data-form="'+f+'"] #mainPanel .linkPrevious').fadeOut(b.animationsSpeed/2);jQuery(' #estimation_popup.wpe_bootstraped[data-form="'+f+'"] #mainPanel .lfb_distanceError').fadeOut(b.animationsSpeed/2);if(o=="final"){wpe_updateSummary(f);var p=true;jQuery('#estimation_popup.wpe_bootstraped[data-form="'+f+'"] [data-activatePaypal="true"]:not(:checked):not(.checked)').each(function(){var e=jQuery(this).closest(".genSlide").attr("data-stepid");if(e!="final"){e=parseInt(e)}if(jQuery.inArray(e,lfb_lastSteps)==-1){}else{p=false}});if(jQuery('#estimation_popup.wpe_bootstraped[data-form="'+f+'"]').find('[data-dontactivatepaypal="true"].checked,[data-dontactivatepaypal="true"]:checked').length>0){p=false}if(p){jQuery('#estimation_popup.wpe_bootstraped[data-form="'+b.formID+'"] #lfb_stripeForm .lfb_stripeContainer').show()}else{jQuery('#estimation_popup.wpe_bootstraped[data-form="'+b.formID+'"] #lfb_stripeForm .lfb_stripeContainer').hide()}if(jQuery('#estimation_popup.wpe_bootstraped[data-form="'+b.formID+'"]').is('[data-emaillaststep="1"]')&&!b.emailSent){wpe_order(f)}}else{wpe_updateFloatingSummary()}var m=jQuery(' #estimation_popup.wpe_bootstraped[data-form="'+f+'"] #mainPanel .genSlide[data-stepid="'+o+'"]').find(".stepTitle");var d=jQuery(' #estimation_popup.wpe_bootstraped[data-form="'+f+'"] #mainPanel .genSlide[data-stepid="'+o+'"]').find("p.lfb_stepDescription");var a=jQuery(' #estimation_popup.wpe_bootstraped[data-form="'+f+'"] #mainPanel .genSlide[data-stepid="'+o+'"]').find(".genContent");var n=jQuery(' #estimation_popup.wpe_bootstraped[data-form="'+f+'"] #mainPanel .genSlide[data-stepid="'+o+'"]').find(".lfb_totalBottomContainer");a.find(".genContentSlide").removeClass("active");a.find(".genContentSlide").eq(0).addClass("active");a.animate({opacity:0},b.animationsSpeed);d.animate({opacity:0},b.animationsSpeed);m.removeClass("positioned");m.css({"-webkit-transition":"none",transition:"none"});n.animate({opacity:0},b.animationsSpeed);if(typeof ga!=="undefined"){try{ga("set","page",location.pathname+"#"+encodeURIComponent(m.html()).replace(/%20/g,"+"));ga("send","pageview")}catch(k){}}jQuery(' #estimation_popup.wpe_bootstraped[data-form="'+f+'"] #mainPanel .genSlide[data-stepid="'+o+'"]').css("opacity",0).show();var i=jQuery(' #estimation_popup.wpe_bootstraped[data-form="'+f+'"] #mainPanel .genSlide[data-stepid="'+o+'"] .stepTitle').height();var c=jQuery(' #estimation_popup.wpe_bootstraped[data-form="'+f+'"] #mainPanel .genSlide[data-stepid="'+o+'"]').outerHeight()+160+i;jQuery(' #estimation_popup.wpe_bootstraped[data-form="'+f+'"] #mainPanel .genSlide[data-stepid="'+o+'"]').hide().css("opacity",1);var l=b.animationsSpeed*4.5;if(jQuery('#estimation_popup.wpe_bootstraped[data-form="'+f+'"] #mainPanel .genSlide[data-stepid="'+o+'"]').is('[data-start="1"]')){wpe_initPanelResize(f);l=b.animationsSpeed*2.5;jQuery('#estimation_popup.wpe_bootstraped[data-form="'+f+'"] #mainPanel .genSlide[data-stepid="'+o+'"]').fadeIn(b.animationsSpeed*2)}else{jQuery('#estimation_popup.wpe_bootstraped[data-form="'+f+'"] #mainPanel .genSlide[data-stepid="'+o+'"]').delay(b.animationsSpeed*2).fadeIn(b.animationsSpeed*2)}if(jQuery('#estimation_popup.wpe_bootstraped[data-form="'+f+'"] #finalSlide .estimation_project').length>0){var g=wpe_getFormContent(f);var j=g[3];jQuery('#estimation_popup.wpe_bootstraped[data-form="'+f+'"] #finalSlide .estimation_project textarea').val(j);jQuery('#estimation_popup.wpe_bootstraped[data-form="'+f+'"] #finalSlide .estimation_total:not(.gfield_price) input').val(b.price);jQuery('#estimation_popup.wpe_bootstraped[data-form="'+f+'"] #finalSlide .estimation_total.gfield_price .ginput_product_price').html(b.price);jQuery('#estimation_popup.wpe_bootstraped[data-form="'+f+'"] #finalSlide .estimation_total.gfield_price input[id^=#ginput_base_price]').val(b.price)}setTimeout(function(){c=jQuery(' #estimation_popup.wpe_bootstraped[data-form="'+f+'"] #mainPanel .genSlide[data-stepid="'+o+'"]').outerHeight()+160+i;jQuery(' #estimation_popup.wpe_bootstraped[data-form="'+f+'"] #mainPanel').css("min-height",c);m.css({"-webkit-transition":"all 0.3s ease-out",transition:"all 0.3s ease-out"}).addClass("positioned");a.css({paddingTop:d.height()+m.height()+70});a.delay(b.animationsSpeed*2).animate({opacity:1},b.animationsSpeed);d.delay(b.animationsSpeed).animate({opacity:1,top:m.height()+60},b.animationsSpeed);n.delay(b.animationsSpeed*2).animate({opacity:1},b.animationsSpeed);if(!jQuery('#estimation_popup.wpe_bootstraped[data-form="'+f+'"] #mainPanel .genSlide[data-stepid="'+o+'"] .btn-next').is(".lfb_disabledBtn")){jQuery(' #estimation_popup.wpe_bootstraped[data-form="'+f+'"] #mainPanel .genSlide[data-stepid="'+o+'"] .btn-next').css("display","inline-block").hide();setTimeout(function(){if(!jQuery('#estimation_popup.wpe_bootstraped[data-form="'+f+'"] #mainPanel .genSlide[data-stepid="'+o+'"] .btn-next').is(".lfb_disabledBtn")){jQuery(' #estimation_popup.wpe_bootstraped[data-form="'+f+'"] #mainPanel .genSlide[data-stepid="'+o+'"] .btn-next').fadeIn(500);setTimeout(function(){if(jQuery('#estimation_popup.wpe_bootstraped[data-form="'+f+'"] #mainPanel .genSlide[data-stepid="'+o+'"] .btn-next').is(".lfb_disabledBtn")){jQuery(' #estimation_popup.wpe_bootstraped[data-form="'+f+'"] #mainPanel .genSlide[data-stepid="'+o+'"] .btn-next').hide()}},550)}},b.animationsSpeed*2)}else{jQuery(' #estimation_popup.wpe_bootstraped[data-form="'+f+'"] #mainPanel .genSlide[data-stepid="'+o+'"] .btn-next').hide()}jQuery(' #estimation_popup.wpe_bootstraped[data-form="'+f+'"] #mainPanel .genSlide[data-stepid="'+o+'"] .lfb_btnNextContainer').fadeIn(500);jQuery(' #estimation_popup.wpe_bootstraped[data-form="'+f+'"] #mainPanel .genSlide[data-stepid="'+o+'"] .linkPrevious').delay(b.animationsSpeed*3).fadeIn(500);jQuery(' #estimation_popup.wpe_bootstraped[data-form="'+f+'"] #mainPanel .genSlide[data-stepid="'+o+'"] .lfb_distanceError').delay(b.animationsSpeed*3).fadeIn(500);if(b.disableTipMobile==0||!wpe_is_touch_device()){var e=navigator.userAgent.toLowerCase();var q=e.match(/(iPad|iPhone|iPod)/i);if(q){a.delay(750).find('[data-toggle="tooltip"]').b_tooltip({html:true,container:"#estimation_popup",trigger:"manual"})}else{a.delay(750).find('[data-toggle="tooltip"]').b_tooltip({html:true,container:"#estimation_popup"})}a.on("enter",function(){if(this.options.trigger=="hover"&&"ontouchstart" in document.documentElement){return}})}setTimeout(function(){jQuery('#estimation_popup.wpe_bootstraped[data-form="'+f+'"] #mainPanel .genSlide.lfb_activeStep').removeClass("lfb_activeStep");jQuery('#estimation_popup.wpe_bootstraped[data-form="'+f+'"] #mainPanel .genSlide[data-stepid="'+o+'"]').addClass("lfb_activeStep");a.find(".wpe_itemQtField").each(function(){if(jQuery(this).parent().next().is(".itemDes")){jQuery(this).css({marginTop:20+jQuery(this).parent().next().outerHeight()})}});b.step=o;setTimeout(function(){jQuery('#estimation_popup.wpe_bootstraped[data-form="'+f+'"] #mainPanel .genSlide[data-stepid="'+o+'"]').find('[data-usedistance="true"]').each(function(){lfb_removeDistanceError(jQuery(this).attr("data-itemid"),f)},100);jQuery("#estimation_popup :not(.ui-slider-handle) > .tooltip").remove();jQuery("body > .tooltip").remove();jQuery('#estimation_popup[data-form="'+f+'"] > .tooltip').remove();setTimeout(function(){jQuery(window).trigger("resize")},100)},(b.animationsSpeed*2)+550);wpe_updatePrice(f);if(b.backFomFinal){b.backFomFinal=false}},300)},l);jQuery("#estimation_popup :not(.ui-slider-handle) > .tooltip").remove();jQuery("body > .tooltip").remove();jQuery('#estimation_popup[data-form="'+f+'"] > .tooltip').remove();wpe_updatePrice(f)}function wpe_findPotentialsSteps(e,g){var c=wpe_getForm(g);var b=new Array();var a=new Array();var d=new Array();var f=0;jQuery.each(c.links,function(){var j=this;if(j.originID==e){var i=false;var h=true;if(j.conditions&&j.conditions!="[]"){j.conditionsO=JSON.parse(j.conditions);var k=lfb_checkConditions(j.conditionsO,g,e);i=k.error;h=k.errorOR}else{d.push(j.destinationID);h=false}if((j.operator=="OR"&&!h)||(j.operator!="OR"&&!i)){j.conditionsO=JSON.parse(j.conditions);a.push({stepID:parseInt(j.destinationID),nbConditions:j.conditionsO.length});if(j.conditionsO.length>f){f=j.conditionsO.length}b.push(parseInt(j.destinationID))}}});if(e==0){b.push(parseInt(jQuery('#estimation_popup.wpe_bootstraped[data-form="'+g+'"]  #mainPanel .genSlide[data-start="1"]').attr("data-stepid")))}if(b.length==0){b.push("final")}else{if(d.length>0&&d.length<b.length){jQuery.each(d,function(){var h=this;b=jQuery.grep(b,function(i){return i!=h})});if(f>0){jQuery.each(b,function(h){jQuery.each(a,function(i){if(i.stepID==h&&i.nbConditions<f){b=jQuery.grep(b,function(j){return j!=h})}})})}}}return b}function lfb_checkConditions(e,d,b){var c=false;var a=true;jQuery.each(e,function(){var j=this;if(j.interaction.substr(0,1)!="_"){var o=j.interaction.substr(0,j.interaction.indexOf("_"));if(o==0){o="final"}var g=j.interaction.substr(j.interaction.indexOf("_")+1,j.interaction.length);var q=jQuery('#estimation_popup.wpe_bootstraped[data-form="'+d+'"] #mainPanel .genSlide[data-stepid="'+o+'"] .genContent [data-itemid="'+g+'"]');if(q.is(".lfb_disabled")||q.closest(".genSlide").is(".lfb_disabled")){if(j.action!="unclicked"){c=true}else{a=false}}else{if(j.value&&j.value.indexOf("_")>-1){if(j.value.substr(0,1)!="_"){var m=j.value.substr(0,j.value.indexOf("_"));var h=j.value.substr(j.value.indexOf("-")+1,j.value.length);if(m==0){m="final"}var p=j.value.substr(j.value.indexOf("_")+1,j.value.indexOf("-")-(j.value.indexOf("_")+1));if(h=="stepqt"){j.value=wpe_getStepQuantities()}else{var k=jQuery('#estimation_popup.wpe_bootstraped[data-form="'+d+'"] #mainPanel .genSlide[data-stepid="'+m+'"] .genContent [data-itemid="'+p+'"]');if(k.length>0){if(h==""){j.value=parseFloat(k.data("resprice"))}else{if(h=="quantity"){if(k.is('input[type="number"]')){j.value=k.val()}else{if(k.find(".wpe_qtfield").length>0){j.value=parseInt(k.find(".wpe_qtfield").val())}else{j.value=parseInt(k.find(".icon_quantity").html())}}}else{if(h=="value"){j.value=k.val();if(k.is(".lfb_datepicker")){j.value=moment.utc(k.datetimepicker("getDate")).format("YYYY-MM-DD")}j.value=j.value.replace(/\`/g,"'")}}}}}}else{if(j.value=="_total"||j.value=="_total-"){j.value=form.price}else{if(j.value=="_total_qt"){j.value=wpe_getTotalQuantities(d,b)}}}}else{if(j.value){j.value=j.value.replace(/\`/g,"'")}}switch(j.action){case"clicked":if(q.is('[type="checkbox"]')){if(!q.is(":checked")){c=true}if(q.is(":checked")){a=false}}else{if(!q.is(".checked")&&!q.is(":checked")){c=true}if(q.is(".checked")||q.is(":checked")){a=false}}break;case"unclicked":if(q.is(':not([type="checkbox"]).checked')||q.is(":checked")){c=true}if(!q.is(':not([type="checkbox"]).checked')&&!q.is(":checked")){a=false}break;case"filled":if(q.is(".lfb_dropzone")){if(q.find(".dz-preview[data-file].dz-success.dz-complete").length==0){c=true}else{a=false}}else{if(q.val().length==0){c=true}else{a=false}}break;case"equal":if(q.is(".lfb_datepicker")){if(moment.utc(q.datetimepicker("getDate")).format("YYYY-MM-DD")!=j.value){c=true}if(moment.utc(q.datetimepicker("getDate")).format("YYYY-MM-DD")==j.value){a=false}}else{if(q.val()!=j.value){c=true}else{a=false}}break;case"different":if(q.val()==j.value){c=true}else{a=false}break;case"PriceSuperior":var l=parseFloat(q.data("resprice"));if(q.is(".lfb_button:not(.checked)")||q.is(".selectable:not(.checked)")||q.is("input[type=checkbox]:not(:checked)")||l<=j.value){c=true}if((q.is(".checked")||q.is(":checked"))&&l>j.value){a=false}break;case"PriceInferior":var l=parseFloat(q.data("resprice"));if(q.is(".lfb_button:not(.checked)")||q.is(".selectable:not(.checked)")||q.is("input[type=checkbox]:not(:checked)")||l>=j.value){c=true}if((q.is(".checked")||q.is(":checked"))&&l<j.value){a=false}break;case"PriceEqual":var l=parseFloat(q.data("resprice"));if(q.is(".lfb_button:not(.checked)")||q.is(".selectable:not(.checked)")||q.is("input[type=checkbox]:not(:checked)")||l!=j.value){c=true}if((q.is(".checked")||q.is(":checked"))&&l==j.value){a=false}break;case"PriceDifferent":var l=parseFloat(q.data("resprice"));if(q.is(".lfb_button:not(.checked)")||q.is(".selectable:not(.checked)")||q.is("input[type=checkbox]:not(:checked)")||l==j.value){c=true}if((q.is(".checked")||q.is(":checked"))&&l!=j.value){a=false}break;case"QtSuperior":if(q.is(".selectable:not(.checked)")||(q.find(".icon_quantity").length>0&&parseInt(q.find(".icon_quantity").html())<=j.value)||(q.find(".wpe_qtfield").length>0&&parseInt(q.find(".wpe_qtfield").val())<=j.value)||(q.is('[data-type="slider"]')&&q.is(".ui-slider")&&parseInt(q.slider("value"))<=j.value)){c=true}if(q.is(".selectable")){if(q.is(".selectable.checked")&&(parseInt(q.find(".icon_quantity").html())>j.value)||(parseInt(q.find(".wpe_qtfield").val())>j.value)){a=false}}else{if(q.is('[data-type="slider"]')&&q.is(".ui-slider")&&parseInt(q.slider("value"))>j.value){a=false}}if(q.is("input")){if(parseInt(q.val())<=j.value){c=true}if(parseInt(q.val())>j.value){a=false}}break;case"QtInferior":if(q.is(".selectable:not(.checked)")||(q.find(".icon_quantity").length>0&&parseInt(q.find(".icon_quantity").html())>=j.value)||(q.find(".wpe_qtfield").length>0&&parseInt(q.find(".wpe_qtfield").val())>=j.value)||(q.is('[data-type="slider"]')&&q.is(".ui-slider")&&parseInt(q.slider("value"))>=j.value)){c=true}if(q.is(".selectable")){if(q.is(".selectable.checked")&&(parseInt(q.find(".icon_quantity").html())<j.value)||(parseInt(q.find(".wpe_qtfield").val())<j.value)){a=false}}else{if(q.is('[data-type="slider"]')&&q.is(".ui-slider")&&parseInt(q.slider("value"))<j.value){a=false}}if(q.is("input")){if(parseInt(q.val())>=j.value){c=true}if(parseInt(q.val())<j.value){a=false}}break;case"QtEqual":if(q.is(".selectable:not(.checked)")||(q.find(".icon_quantity").length>0&&parseInt(q.find(".icon_quantity").html())!=j.value)||(q.find(".wpe_qtfield").length>0&&parseInt(q.find(".wpe_qtfield").val())!=j.value)||(q.is('[data-type="slider"]')&&q.is(".ui-slider")&&parseInt(q.slider("value"))!=j.value)){c=true}if(q.is(".selectable")){if(q.is(".selectable.checked")&&(parseInt(q.find(".icon_quantity").html())==j.value)||(parseInt(q.find(".wpe_qtfield").val())==j.value)){a=false}}else{if(q.is('[data-type="slider"]')&&q.is(".ui-slider")&&parseInt(q.slider("value"))==j.value){a=false}}if(q.is("input")){if(parseInt(q.val())!=j.value){c=true}if(parseInt(q.val())==j.value){a=false}}break;case"QtDifferent":if(q.is(".selectable:not(.checked)")||(q.find(".icon_quantity").length>0&&parseInt(q.find(".icon_quantity").html())==j.value)||(q.find(".wpe_qtfield").length>0&&parseInt(q.find(".wpe_qtfield").val())==j.value)||(q.is('[data-type="slider"]')&&q.is(".ui-slider")&&parseInt(q.slider("value"))==j.value)){c=true}if(q.is(".selectable")){if(q.is(".selectable.checked")&&(parseInt(q.find(".icon_quantity").html())!=j.value)||(parseInt(q.find(".wpe_qtfield").val())!=j.value)){a=false}}else{if(q.is('[data-type="slider"]')&&q.is(".ui-slider")&&parseInt(q.slider("value"))!=j.value){a=false}}if(q.is("input")){if(parseInt(q.val())==j.value){c=true}if(parseInt(q.val())!=j.value){a=false}}break;case"superior":if(q.is(".lfb_datepicker")){if(q.is('[data-datetype="date"]')){if(moment.utc(q.datetimepicker("getDate")).format("YYYY-MM-DD")<=j.value){c=true}if(moment.utc(q.datetimepicker("getDate")).format("YYYY-MM-DD")>j.value){a=false}}else{if(q.is('[data-datetype="time"]')){if(moment.utc(q.datetimepicker("getDate")).format("HH:mm")<=j.value){c=true}if(moment.utc(q.datetimepicker("getDate")).format("HH:mm")>j.value){a=false}}else{if(moment.utc(q.datetimepicker("getDate")).isSameOrBefore(moment.utc(j.value).format("YYYY-MM-DD HH:mm"))){c=true}if(moment.utc(q.datetimepicker("getDate")).isAfter(moment.utc(j.value).format("YYYY-MM-DD HH:mm"))){a=false}}}}else{if(q.is(".lfb_timepicker")){var s=parseInt(j.value.substr(0,j.value.indexOf(":")));var n=parseInt(j.value.substr(j.value.indexOf(":")+1,2));if(j.value.indexOf("PM")>0&&s!=12){s+=12}var i=parseInt(q.val().substr(0,q.val().indexOf(":")));var f=parseInt(q.val().substr(q.val().indexOf(":")+1,2));if(q.val().indexOf("PM")>0&&i!=12){i+=12}if(i<s||(i==s&&f<=n)){c=true}if(i>s||(i==s&&f>n)){a=false}}else{if(q.is('input[type="number"]')){if(parseFloat(q.val())<=parseFloat(j.value)){c=true}if(parseFloat(q.val())>parseFloat(j.value)){a=false}}}}break;case"inferior":if(q.is(".lfb_datepicker")){if(q.is('[data-datetype="date"]')){if(moment.utc(q.datetimepicker("getDate")).format("YYYY-MM-DD")>=j.value){c=true}if(moment.utc(q.datetimepicker("getDate")).format("YYYY-MM-DD")<j.value){a=false}}else{if(q.is('[data-datetype="time"]')){if(moment.utc(q.datetimepicker("getDate")).format("HH:mm")>=j.value){c=true}if(moment.utc(q.datetimepicker("getDate")).format("HH:mm")<j.value){a=false}}else{if(moment.utc(q.datetimepicker("getDate")).isSameOrAfter(moment.utc(j.value).getTime())){c=true}if(moment.utc(q.datetimepicker("getDate")).isBefore(moment.utc(j.value).getTime())){a=false}}}}else{if(q.is(".lfb_timepicker")){var s=parseInt(j.value.substr(0,j.value.indexOf(":")));var n=parseInt(j.value.substr(j.value.indexOf(":")+1,2));if(j.value.indexOf("PM")>0&&s!=12){s+=12}var i=parseInt(q.val().substr(0,q.val().indexOf(":")));var f=parseInt(q.val().substr(q.val().indexOf(":")+1,2));if(q.val().indexOf("PM")>0&&i!=12){i+=12}if(i>s||(i==s&&f>=n)){c=true}if(i<s||(i==s&&f<n)){a=false}}else{if(q.is('input[type="number"]')){if(parseFloat(q.val())>=parseFloat(j.value)){c=true}if(parseFloat(q.val())<parseFloat(j.value)){a=false}}}}break;case"equal":if(q.is(".lfb_datepicker")){if(q.is('[data-datetype="date"]')){if(moment.utc(q.datetimepicker("getDate")).format("YYYY-MM-DD")!=j.value){c=true}if(moment.utc(q.datetimepicker("getDate")).format("YYYY-MM-DD")==j.value){a=false}}else{if(q.is('[data-datetype="time"]')){if(moment.utc(q.datetimepicker("getDate")).format("HH:mm")!=j.value){c=true}if(moment.utc(q.datetimepicker("getDate")).format("HH:mm")==j.value){a=false}}else{if(!moment.utc(q.datetimepicker("getDate")).isSame(moment.utc(j.value).format("YYYY-MM-DD HH:mm"))){c=true}if(moment.utc(q.datetimepicker("getDate")).isSame(moment.utc(j.value).format("YYYY-MM-DD HH:mm"))){a=false}}}}else{if(q.is(".lfb_timepicker")){var s=parseInt(j.value.substr(0,j.value.indexOf(":")));var n=parseInt(j.value.substr(j.value.indexOf(":")+1,2));if(j.value.indexOf("PM")>0&&s!=12){s+=12}var i=parseInt(q.val().substr(0,q.val().indexOf(":")));var f=parseInt(q.val().substr(q.val().indexOf(":")+1,2));if(q.val().indexOf("PM")>0&&i!=12){i+=12}if(i!=s){c=true}if(i==s){a=false}}else{if(q.is('input[type="number"]')){if(parseFloat(q.val())!=parseFloat(j.value)){c=true}if(parseFloat(q.val())==parseFloat(j.value)){a=false}}}}break;case"different":if(q.is(".lfb_datepicker")){if(q.is('[data-datetype="date"]')){if(moment.utc(q.datetimepicker("getDate")).format("YYYY-MM-DD")==j.value){c=true}if(moment.utc(q.datetimepicker("getDate")).format("YYYY-MM-DD")!=j.value){a=false}}else{if(q.is('[data-datetype="time"]')){if(moment.utc(q.datetimepicker("getDate")).format("HH:mm")==j.value){c=true}if(moment.utc(q.datetimepicker("getDate")).format("HH:mm")!=j.value){a=false}}else{if(moment.utc(q.datetimepicker("getDate")).isSame(moment.utc(j.value).format("YYYY-MM-DD HH:mm"))){c=true}if(!moment.utc(q.datetimepicker("getDate")).isSame(moment.utc(j.value).format("YYYY-MM-DD HH:mm"))){a=false}}}}else{if(q.is(".lfb_timepicker")){var s=parseInt(j.value.substr(0,j.value.indexOf(":")));var n=parseInt(j.value.substr(j.value.indexOf(":")+1,2));if(j.value.indexOf("PM")>0&&s!=12){s+=12}var i=parseInt(q.val().substr(0,q.val().indexOf(":")));var f=parseInt(q.val().substr(q.val().indexOf(":")+1,2));if(q.val().indexOf("PM")>0&&i!=12){i+=12}if(i==s){c=true}if(i!=s){a=false}}else{if(q.is('input[type="number"]')){if(parseFloat(q.val())==parseFloat(j.value)){c=true}if(parseFloat(q.val())!=parseFloat(j.value)){a=false}}}}break}}}else{if(j.interaction=="_total"){switch(j.action){case"superior":if(parseFloat(form.price)<=parseFloat(j.value)){c=true}if(parseFloat(form.price)>parseFloat(j.value)){a=false}break;case"inferior":if(parseFloat(form.price)>=parseFloat(j.value)){c=true}if(parseFloat(form.price)<parseFloat(j.value)){a=false}break;case"equal":if(parseFloat(form.price)!=parseFloat(j.value)){c=true}if(parseFloat(form.price)==parseFloat(j.value)){a=false}break;case"equal":if(parseFloat(form.price)==parseFloat(j.value)){c=true}if(parseFloat(form.price)!=parseFloat(j.value)){a=false}break}}else{if(j.interaction=="_total_qt"){var r=wpe_getTotalQuantities(d,b);switch(j.action){case"superior":if(r<=j.value){c=true}if(r>j.value){a=false}break;case"inferior":if(r>=j.value){c=true}if(form.price<j.value){a=false}break;case"equal":if(r!=j.value){c=true}if(r==j.value){a=false}break;case"different":if(r==j.value){c=true}if(r!=j.value){a=false}break}}}}});return{error:c,errorOR:a}}function lfb_scrollToItem(a,d,c){if(d=="final"){var b=wpe_getForm(c);if(jQuery('#estimation_popup.wpe_bootstraped[data-form="'+b.formID+'"]').is(".wpe_fullscreen")||jQuery('#estimation_popup.wpe_bootstraped[data-form="'+b.formID+'"]').is(".wpe_popup")){jQuery('#estimation_popup.wpe_bootstraped[data-form="'+b.formID+'"]').animate({scrollTop:a.parent().offset().top-(80+parseInt(b.scrollTopMargin))},b.animationsSpeed*2)}else{if(b.scrollTopPage=="1"){jQuery("body,html").animate({scrollTop:0},b.animationsSpeed*2)}else{jQuery("body,html").animate({scrollTop:a.parent().offset().top-(80+parseInt(b.scrollTopMargin))},b.animationsSpeed*2)}}}}function lfb_checkStepItemsValid(d,c){var a=true;var b=false;jQuery(' #estimation_popup.wpe_bootstraped[data-form="'+c+'"] #mainPanel .genSlide[data-stepid="'+d+'"]').find(".has-error").removeClass("has-error");jQuery(' #estimation_popup.wpe_bootstraped[data-form="'+c+'"] #mainPanel .genSlide[data-stepid="'+d+'"]').find(".icon_select.lfb_error").removeClass("lfb_error");jQuery(' #estimation_popup.wpe_bootstraped[data-form="'+c+'"] #mainPanel .genSlide[data-stepid="'+d+'"]').find("input[type=text]:not(.lfb_disabled)").each(function(){if(jQuery(this).closest("#lfb_stripeForm").length==0&&jQuery(this).closest("#wtmt_paypalForm").length==0){if(jQuery(this).is('[data-required="true"]')&&jQuery(this).val().length<1){a=false;jQuery(this).closest(".form-group").addClass("has-error");if(!b){lfb_scrollToItem(jQuery(this),d,c)}b=true}if(jQuery(this).is('[data-validation="phone"]')&&jQuery(this).val().length>0&&(jQuery(this).val().length<5||/^(?:(?:\(?(?:00|\+)([1-4]\d\d|[1-9]\d?)\)?)?[\-\.\ \\\/]?)?((?:\(?\d{1,}\)?[\-\.\ \\\/]?){0,})(?:[\-\.\ \\\/]?(?:#|ext\.?|extension|x)[\-\.\ \\\/]?(\d+))?$/i.test(jQuery(this).val())==false)){a=false;jQuery(this).closest(".form-group").addClass("has-error");if(!b){lfb_scrollToItem(jQuery(this),d,c)}b=true}else{if(jQuery(this).is('[data-validation="email"]')&&jQuery(this).val().length>0&&!wpe_checkEmail(jQuery(this).val())){a=false;jQuery(this).closest(".form-group").addClass("has-error");if(!b){lfb_scrollToItem(jQuery(this),d,c)}b=true}else{if(jQuery(this).is('[data-validation="fill"]')&&jQuery(this).val().length==0){a=false;jQuery(this).closest(".form-group").addClass("has-error");if(!b){lfb_scrollToItem(jQuery(this),d,c)}b=true}else{if(jQuery(this).is('[data-validation="custom"]')&&jQuery(this).val().length>0){var e=false;if(parseInt(jQuery(this).attr("data-validmin"))>0&&jQuery(this).val().length<parseInt(jQuery(this).attr("data-validmin"))){e=true}if(parseInt(jQuery(this).attr("data-validmax"))>0&&jQuery(this).val().length>parseInt(jQuery(this).attr("data-validmax"))){e=true}if(jQuery(this).attr("data-validcar")!=""){var g=jQuery(this);if(jQuery(this).attr("data-validcar").indexOf(",")>-1){var f=jQuery(this).attr("data-validcar").split(",");jQuery.each(f,function(){if(g.val().indexOf(this)==-1){e=true}})}else{if(g.val().indexOf(jQuery(this).attr("data-validcar"))==-1){e=true}}}if(e){a=false;jQuery(this).closest(".form-group").addClass("has-error");if(!b){lfb_scrollToItem(jQuery(this),d,c)}b=true}}}}}}});jQuery('#estimation_popup.wpe_bootstraped[data-form="'+c+'"] #mainPanel .genSlide[data-stepid="'+d+'"]').find("input[type=text][minlength]:not(.lfb_disabled)").each(function(){if(jQuery(this).val().length<jQuery(this).attr("minlength")){a=false;jQuery(this).closest(".form-group").addClass("has-error");if(!b){lfb_scrollToItem(jQuery(this),d,c)}}});jQuery(' #estimation_popup.wpe_bootstraped[data-form="'+c+'"] #mainPanel .genSlide[data-stepid="'+d+'"]').find('select[data-required="true"]:not(.lfb_disabled)').each(function(){if(jQuery(this).is('[data-firstvaluedisabled="true"]')&&((!jQuery(this).is(".lfb_selectpicker")&&jQuery(this).find("option:selected").index()==0)||((jQuery(this).is(".lfb_selectpicker")&&jQuery(this).find("option:selected").index()==1)))){a=false;jQuery(this).closest(".form-group").addClass("has-error");if(!b){lfb_scrollToItem(jQuery(this),d,c)}}});jQuery('#estimation_popup.wpe_bootstraped[data-form="'+c+'"] #mainPanel .genSlide[data-stepid="'+d+'"]').find("input[type=text][minlength]:not(.lfb_disabled)").each(function(){if(jQuery(this).val().length<jQuery(this).attr("minlength")){a=false;jQuery(this).closest(".form-group").addClass("has-error");if(!b){lfb_scrollToItem(jQuery(this),d,c)}}});jQuery('#estimation_popup.wpe_bootstraped[data-form="'+c+'"] #mainPanel .genSlide[data-stepid="'+d+'"]').find('input[type=number][data-required="true"]:not(.lfb_disabled)').each(function(){if(jQuery(this).val()==""||jQuery(this).val()==0){a=false;jQuery(this).closest(".form-group").addClass("has-error");if(!b){lfb_scrollToItem(jQuery(this),d,c)}}});jQuery(' #estimation_popup.wpe_bootstraped[data-form="'+c+'"] #mainPanel .genSlide[data-stepid="'+d+'"]').find('.lfb_dropzone[data-required="true"]:not(.lfb_disabled)').each(function(){if(jQuery(this).find(".dz-preview[data-file].dz-success.dz-complete").length==0){a=false;jQuery(this).parent().addClass("has-error");if(!b){lfb_scrollToItem(jQuery(this),d,c)}}});jQuery(' #estimation_popup.wpe_bootstraped[data-form="'+c+'"] #mainPanel .genSlide[data-stepid="'+d+'"]').find('textarea[data-required="true"]:not(.lfb_disabled)').each(function(){if(jQuery(this).closest("#lfb_stripeForm").length==0&&jQuery(this).closest("#wtmt_paypalForm").length==0){if(jQuery(this).val().length<1){a=false;jQuery(this).closest(".form-group").addClass("has-error");if(!b){lfb_scrollToItem(jQuery(this),d,c)}}}});jQuery(' #estimation_popup.wpe_bootstraped[data-form="'+c+'"] #mainPanel .genSlide[data-stepid="'+d+'"]').find('input[type=checkbox][data-required="true"]:not(.lfb_disabled)').each(function(){if(!jQuery(this).is(":checked")){a=false;jQuery(this).closest(".form-group,p,.itemBloc").addClass("has-error");if(!b){lfb_scrollToItem(jQuery(this),d,c)}}});jQuery(' #estimation_popup.wpe_bootstraped[data-form="'+c+'"] #mainPanel .genSlide[data-stepid="'+d+'"]').find('.selectable[data-required="true"]:not(.lfb_disabled)').each(function(){if(!jQuery(this).is(".checked")){a=false;jQuery(this).find(".icon_select").addClass("lfb_error");if(!b){lfb_scrollToItem(jQuery(this),d,c)}}});jQuery(' #estimation_popup.wpe_bootstraped[data-form="'+c+'"] #mainPanel .genSlide[data-stepid="'+d+'"]').find('.lfb_button[data-required="true"]:not(.lfb_disabled)').each(function(){if(!jQuery(this).is(".checked")){a=false;jQuery(this).find(".icon_select").addClass("lfb_error");if(!b){lfb_scrollToItem(jQuery(this),d,c)}}});return a}function wpe_nextStep(c){var b=wpe_getForm(c);jQuery("#lfb_bootstraped :not(.ui-slider-handle) > .tooltip").remove();jQuery('#estimation_popup[data-form="'+b.formID+'"] > .tooltip').remove();var f=navigator.userAgent.toLowerCase();var i=f.match(/(iPad|iPhone|iPod)/i);if(i){setTimeout(function(){jQuery("#lfb_bootstraped :not(.ui-slider-handle) > .tooltip").remove()},500)}lfb_updateShowSteps(c);jQuery(".errorMsg").hide();var e=true;var k=true;var h=0;var a=wpe_findPotentialsSteps(b.step,c);if(b.step>0){if(jQuery(' #estimation_popup.wpe_bootstraped[data-form="'+c+'"] #mainPanel .genSlide[data-stepid="'+b.step+'"]').data("required")==true){e=false;if((jQuery('#estimation_popup.wpe_bootstraped[data-form="'+c+'"] #mainPanel .genSlide[data-stepid="'+b.step+'"]').find('select:not(.lfb_disabled):not([data-firstvaluedisabled="true"])').length>0)||(jQuery(' #estimation_popup.wpe_bootstraped[data-form="'+c+'"] #mainPanel .genSlide[data-stepid="'+b.step+'"]').find("div.selectable.checked:not(.lfb_disabled)").length>0)||(jQuery(' #estimation_popup.wpe_bootstraped[data-form="'+c+'"] #mainPanel .genSlide[data-stepid="'+b.step+'"]').find("a.lfb_button.checked:not(.lfb_disabled)").length>0)||(jQuery(' #estimation_popup.wpe_bootstraped[data-form="'+c+'"] #mainPanel .genSlide[data-stepid="'+b.step+'"]').find('input[data-toggle="switch"]:checked:not(.lfb_disabled)').length>0)||(jQuery(' #estimation_popup.wpe_bootstraped[data-form="'+c+'"] #mainPanel .genSlide[data-stepid="'+b.step+'"]').find("input[type=text][data-title].checked:not(.lfb_disabled)").length>0)||(jQuery(' #estimation_popup.wpe_bootstraped[data-form="'+c+'"] #mainPanel .genSlide[data-stepid="'+b.step+'"]').find("input[type=number][data-itemid].checked:not(.lfb_disabled)").length>0)||(jQuery(' #estimation_popup.wpe_bootstraped[data-form="'+c+'"] #mainPanel .genSlide[data-stepid="'+b.step+'"]').find("input[type=file].checked:not(.lfb_disabled)").length>0)||(jQuery(' #estimation_popup.wpe_bootstraped[data-form="'+c+'"] #mainPanel .genSlide[data-stepid="'+b.step+'"]').find(".lfb_colorPreview:not(.lfb_disabled)").length>0)||(jQuery(' #estimation_popup.wpe_bootstraped[data-form="'+c+'"] #mainPanel .genSlide[data-stepid="'+b.step+'"]').find(".dz-preview[data-file].dz-success.dz-complete").length>0)){e=true}if(!e){jQuery('#estimation_popup.wpe_bootstraped[data-form="'+c+'"] #mainPanel .genSlide[data-stepid="'+b.step+'"]').find('select:not(.lfb_disabled)[data-firstvaluedisabled="true"]').each(function(){if(((!jQuery(this).is(".lfb_selectpicker")&&jQuery(this).find("option:selected").index()>0)||((jQuery(this).is(".lfb_selectpicker")&&jQuery(this).find("option:selected").index()>1)))){e=true}})}}k=lfb_checkStepItemsValid(b.step,c)}if(e&&k){lfb_lastStepID=b.step;if((parseFloat(lfb_lastStepID)==parseInt(lfb_lastStepID))&&!isNaN(lfb_lastStepID)){if(jQuery.inArray(parseInt(b.step),lfb_lastSteps)==-1){lfb_lastSteps.push(parseInt(b.step))}}var j=jQuery('#estimation_popup.wpe_bootstraped[data-form="'+c+'"] #mainPanel .genSlide[data-stepid="'+lfb_lastStepID+'"] .stepTitle').html();history.pushState({id:lfb_lastStepID},"","");var d=a[0];if(d!="final"){d=wpe_getNextEnabledStep(c,a);if(d==-1){d="final"}}if(b.sendContactASAP==1&&jQuery('#estimation_popup.wpe_bootstraped[data-form="'+c+'"] #mainPanel .genSlide[data-stepid="'+b.step+'"] [data-fieldtype="email"]').length>0&&wpe_checkEmail(jQuery('#estimation_popup.wpe_bootstraped[data-form="'+c+'"] #mainPanel .genSlide[data-stepid="'+b.step+'"] [data-fieldtype="email"]').val())){b.contactSent=1;var g=wpe_getContactInformations(c);jQuery.ajax({url:b.ajaxurl,type:"post",data:{action:"lfb_sendCt",formID:c,email:g.email,lastName:g.lastName,firstName:g.firstName,phone:g.phone,country:g.country,zip:g.zip,state:g.state,city:g.city,address:g.address},success:function(l){}})}wpe_changeStep(d,c)}else{if(!e){jQuery(' #estimation_popup.wpe_bootstraped[data-form="'+c+'"] .errorMsg').slideDown()}}}function wpe_getNextEnabledStep(d,a){var b=-1;var c=a[0];if(c!="final"){if(!jQuery('#estimation_popup.wpe_bootstraped[data-form="'+d+'"]  #mainPanel .genSlide[data-stepid="'+c+'"]').is(".lfb_disabled")&&(jQuery('#estimation_popup.wpe_bootstraped[data-form="'+d+'"] #mainPanel .genSlide[data-stepid="'+c+'"] .lfb_item:not(.lfb-hidden)').length>0||jQuery('#estimation_popup.wpe_bootstraped[data-form="'+d+'"] #mainPanel .genSlide[data-stepid="'+c+'"] .lfb_distanceError').length>0)){b=c}else{lfb_lastSteps.push(parseInt(c));wpe_updatePrice(d);b=wpe_getNextEnabledStep(d,wpe_findPotentialsSteps(parseInt(c),d))}}return b}function wpe_openGenerator(b){var a=wpe_getForm(b);jQuery('#estimation_popup.wpe_bootstraped[data-form="'+b+'"]  #startInfos > p').slideDown();jQuery('#estimation_popup.wpe_bootstraped[data-form="'+b+'"] .lfb_btnFloatingSummary').css({display:"inline-block"});jQuery('#estimation_popup.wpe_bootstraped[data-form="'+b+'"] .lfb_btnSaveForm').css({display:"inline-block"});jQuery('#estimation_popup.wpe_bootstraped[data-form="'+a.formID+'"] #btnStart').parent().fadeOut(a.animationsSpeed,function(){if(a.showSteps!="2"){jQuery('#estimation_popup.wpe_bootstraped[data-form="'+b+'"] .genPrice').fadeIn(a.animationsSpeed)}if(!a.autoStart){jQuery(' #estimation_popup.wpe_bootstraped[data-form="'+a.formID+'"] #mainPanel').fadeIn(a.animationsSpeed+a.animationsSpeed/2,function(){wpe_nextStep(b)})}})}function wpe_initListeners(b){var a=wpe_getForm(b);jQuery('#estimation_popup.wpe_bootstraped[data-form="'+b+'"] #mainPanel .genSlide div.selectable .img,  #estimation_popup.wpe_bootstraped[data-form="'+b+'"] #mainPanel .genSlide div.selectable .icon_select').click(function(){if(!tld_selectionMode){wpe_itemClick(jQuery(this).parent(),true,b)}});jQuery('#estimation_popup.wpe_bootstraped[data-form="'+b+'"] #mainPanel .genSlide a.lfb_button').click(function(){if(!tld_selectionMode){wpe_itemClick(jQuery(this),true,b)}});jQuery('#estimation_popup.wpe_bootstraped[data-form="'+b+'"] #mainPanel .genSlide [data-callnextstep="1"]').click(function(){if(!tld_selectionMode){wpe_nextStep(b)}});jQuery('#estimation_popup.wpe_bootstraped[data-form="'+b+'"] #mainPanel input[type=checkbox][data-price]').change(function(){if(jQuery(this).is('[data-usedistance="true"]')){lfb_removeDistanceError(jQuery(this).attr("data-itemid"),b)}wpe_updatePrice(b)});jQuery(' #estimation_popup.wpe_bootstraped[data-form="'+b+'"] #mainPanel input[type=checkbox][data-group]').change(function(f){var c=jQuery(this);if(c.is(":checked")){jQuery(this).closest(".genSlide").find('div.selectable.checked[data-group="'+c.data("group")+'"]').each(function(){wpe_itemClick(jQuery(this),false,b)});jQuery(this).closest(".genSlide").find('input[type=checkbox][data-group="'+c.data("group")+'"]:checked').each(function(){if(!jQuery(this).is(c)){jQuery(this).trigger("click.auto")}});if(jQuery(' #estimation_popup.wpe_bootstraped[data-form="'+b+'"]').is('[data-autoclick="1"]')&&c.closest(".genSlide").find("[data-itemid]").not('[data-group="'+c.data("group")+'"]').length==0){var d=wpe_getForm(b);wpe_nextStep(d.formID)}}});jQuery('#estimation_popup.wpe_bootstraped[data-form="'+b+'"] #mainPanel .genSlide select[data-itemid]').change(function(){var d=jQuery(this).val();var c=0;jQuery(this).find("option").each(function(){if(jQuery(this).attr("value")==d){c=jQuery(this).attr("data-price")}});jQuery(this).attr("data-price",c);wpe_updatePrice(b)});jQuery('#estimation_popup.wpe_bootstraped[data-form="'+b+'"] #mainPanel .genSlide select[data-itemid]').trigger("change");jQuery(' #estimation_popup.wpe_bootstraped[data-form="'+a.formID+'"] #mainPanel input[type=checkbox][data-price]').change(function(){});jQuery(' #estimation_popup.wpe_bootstraped[data-form="'+a.formID+'"] #mainPanel .genSlide input.wpe_qtfield').change(function(){wpe_updatePrice(b)});jQuery(' #estimation_popup.wpe_bootstraped[data-form="'+a.formID+'"] #mainPanel .genSlide').find("input[type=text][data-title],textarea[data-title],input[type=file][data-title],input[type=number][data-title]").change(function(){if(jQuery(this).val().length>0){jQuery(this).addClass("checked")}else{jQuery(this).removeClass("checked")}});jQuery(' #estimation_popup.wpe_bootstraped[data-form="'+a.formID+'"] #mainPanel .genSlide div.selectable .icon_quantity').click(function(){if(!tld_selectionMode){jQuery(".quantityBtns").not(jQuery(this).parent().find(".quantityBtns")).removeClass("open");jQuery(".quantityBtns").not(jQuery(this).parent().find(".quantityBtns")).fadeOut(250);if(!jQuery(this).parent().find(".quantityBtns").is(".open")&&jQuery(this).parent().is(".checked")){if(jQuery(this).parent().find(".quantityBtns .tooltip-inner").length>0){jQuery(this).parent().find(".quantityBtns .tooltip-inner").html(parseInt(jQuery(this).parent().find(".icon_quantity").html()))}jQuery(this).parent().find(".quantityBtns").addClass("open");jQuery(this).parent().find(".quantityBtns").fadeIn(250)}else{jQuery(this).parent().find(".quantityBtns").removeClass("open");jQuery(this).parent().find(".quantityBtns").fadeOut(250)}}});jQuery("#wpe_orderMessageCheck").change(function(){if(jQuery(this).is(":checked")){jQuery("#wpe_orderMessage").slideDown(250)}else{jQuery("#wpe_orderMessage").slideUp(250)}});jQuery('#estimation_popup.wpe_bootstraped[data-form="'+a.formID+'"] #wpe_btnOrder').click(function(){if(!tld_selectionMode){wpe_order(b)}});jQuery("#gform_wrapper_"+a.gravityFormID+" form").submit(function(g){var f=jQuery(this);if(!jQuery(this).is(".submit")){g.preventDefault();jQuery(this).addClass("submit");if(a.save_to_cart){var d=new Array();var c=lfb_lastSteps.slice();if(a.step!="final"&&jQuery.inArray(parseInt(a.step),c)==-1){c.push(parseInt(a.step))}else{if(a.step=="final"&&jQuery.inArray("final",c)==-1){c.push("final")}}jQuery.each(c,function(){$panel=jQuery(' #estimation_popup.wpe_bootstraped[data-form="'+b+'"] #mainPanel .genSlide[data-stepid="'+this+'"]');$panel.find('div.selectable.checked:not(.lfb_disabled),a.lfb_button.checked:not(.lfb_disabled),input[type=checkbox]:checked:not(.lfb_disabled),[data-type="slider"]:not(.lfb_disabled)').each(function(){var e=1;if(parseInt(jQuery(this).data("resqt"))>0){e=parseInt(jQuery(this).data("resqt"))}if(jQuery(this).is('[data-type="slider"]')){e=parseInt(jQuery(this).slider("value"));if(!isNaN(parseInt(jQuery(this).find(".tooltip-inner").html()))){e=parseInt(jQuery(this).find(".tooltip-inner").html())}}if(parseInt(jQuery(this).data("prodid"))>0){d.push({quantity:e,product_id:parseInt(jQuery(this).data("prodid")),variation:parseInt(jQuery(this).attr("data-woovar"))})}})});jQuery.ajax({url:a.ajaxurl,type:"post",data:{action:"lfb_cart_save",ref:a.current_ref,emptyWooCart:a.emptyWooCart,products:d},success:function(){a.timer_gFormSubmit=setInterval(function(){wpe_check_gform_response(a.formID)},300);setTimeout(function(){f.submit()},700)}})}else{a.timer_gFormSubmit=setInterval(function(){wpe_check_gform_response(a.formID)},300);setTimeout(function(){f.submit()},700)}}else{jQuery(this).removeClass("submit")}})}function wpe_checkItems(b){var a=wpe_getForm(b);jQuery('#estimation_popup.wpe_bootstraped[data-form="'+a.formID+'"] #mainPanel .genSlide div.selectable img[data-tint="true"]').each(function(){jQuery(this).css("opacity",0);jQuery(this).show();var e=jQuery('<canvas class="img"></canvas>');e.css({width:jQuery(this).get(0).width,height:jQuery(this).get(0).height});jQuery(this).hide();jQuery(this).after(e);var c=e.get(0).getContext("2d");var d=new Image();d.onload=function(){c.fillStyle=a.colorA;c.fillRect(0,0,e.get(0).width,e.get(0).height);c.fill();c.globalCompositeOperation="destination-in";c.drawImage(d,0,0,e.get(0).width,e.get(0).height)};if(jQuery(this).is("[data-lazy-src]")){d.src=jQuery(this).attr("data-lazy-src")}else{d.src=jQuery(this).attr("src")}});jQuery('#estimation_popup.wpe_bootstraped[data-form="'+a.formID+'"] #mainPanel .genSlide div.selectable img[data-tint="false"]').each(function(){if(jQuery(this).is("[data-src]")){jQuery(this).attr("src",jQuery(this).attr("data-src"))}});jQuery('#estimation_popup.wpe_bootstraped[data-form="'+a.formID+'"] #mainPanel .genSlide div.selectable.checked , #estimation_popup.wpe_bootstraped[data-form="'+a.formID+'"] #mainPanel .genSlide  input[type=checkbox]:checked').hover(function(){jQuery(this).addClass("lfb_hover")},function(){jQuery(this).removeClass("lfb_hover")})}function lfb_getDistanceCalc(a,g,f,d,b,h){var e=0;var c=google.maps.UnitSystem.METRIC;lfb_gmapService=new google.maps.DistanceMatrixService();lfb_gmapService.getDistanceMatrix({origins:[d],destinations:[b],travelMode:google.maps.TravelMode.DRIVING,unitSystem:google.maps.UnitSystem.METRIC,avoidHighways:false,avoidTolls:false,},function(k,i){var l=false;if(i==google.maps.DistanceMatrixStatus.OK){var n=0;if(k.rows[0].elements[0].distance){n=k.rows[0].elements[0].distance.value;n=n/1000;if(h=="miles"){n=n*0.62}}else{l=true}var j=jQuery('#estimation_popup.wpe_bootstraped[data-form="'+g+'"] [data-itemid="'+f+'"]');jQuery('#estimation_popup.wpe_bootstraped[data-form="'+g+'"] [data-itemid="'+f+'"]').attr("data-distance",n);var m=wpe_getForm(g);wpe_updateSummary(g);jQuery('#estimation_popup.wpe_bootstraped[data-form="'+g+'"] #lfb_summary table tr[data-itemstep="'+f+'"] td:eq(2)').html(n);wpe_updatePrice(g);lfb_removeDistanceError(f,g)}else{l=true}if(l){lfb_showDistanceError(f,g)}});return e}function lfb_executeCalculation(calculation,formID,targetID){calculation=calculation.replace(/\\/g,"");var form=wpe_getForm(formID);var price=0;var i=0;var elementsToReplace=new Array();var $target=jQuery('#estimation_popup.wpe_bootstraped[data-form="'+formID+'"] #mainPanel .genSlide [data-itemid="'+targetID+'"]');var _stepID=parseInt($target.closest(".genSlide").attr("data-stepid"));while((i=calculation.indexOf("item-",i+1))!=-1){var itemID=calculation.substr(i+5,calculation.indexOf("_",i)-(i+5));var action=calculation.substr(calculation.indexOf("_",i)+1,(calculation.indexOf("]",i)-1)-(calculation.indexOf("_",i)));var value=0;var $item=jQuery('#estimation_popup.wpe_bootstraped[data-form="'+formID+'"] #mainPanel .genSlide [data-itemid="'+itemID+'"]');if(action=="isChecked"){if(jQuery('#estimation_popup.wpe_bootstraped[data-form="'+formID+'"] #mainPanel .genSlide [data-itemid="'+itemID+'"]').is(".checked")||jQuery('#estimation_popup.wpe_bootstraped[data-form="'+formID+'"] #mainPanel .genSlide [data-itemid="'+itemID+'"]').is(":checked")){value="1==1"}else{value="1==0"}}if(action=="isUnchecked"){if(!jQuery('#estimation_popup.wpe_bootstraped[data-form="'+formID+'"] #mainPanel .genSlide [data-itemid="'+itemID+'"]').is(".checked")&&!jQuery('#estimation_popup.wpe_bootstraped[data-form="'+formID+'"] #mainPanel .genSlide [data-itemid="'+itemID+'"]').is(":checked")){value="1==1"}else{value="1==0"}}if(action=="isFilled"){if($item.is(".lfb_dropzone")){if($item.find(".dz-preview[data-file].dz-success.dz-complete").length>0){value="1==1"}else{value="1==0"}}else{if($item.val().length>0){value="1==1"}else{value="1==0"}}}if(action=="price"){value=0;if(itemID=="total"){value=form.price}else{if(jQuery('#estimation_popup.wpe_bootstraped[data-form="'+formID+'"] #mainPanel .genSlide [data-itemid="'+itemID+'"]').is(".checked")||jQuery('#estimation_popup.wpe_bootstraped[data-form="'+formID+'"] #mainPanel .genSlide [data-itemid="'+itemID+'"]').is(":checked")||jQuery('#estimation_popup.wpe_bootstraped[data-form="'+formID+'"] #mainPanel .genSlide [data-itemid="'+itemID+'"]').is("select")||jQuery('#estimation_popup.wpe_bootstraped[data-form="'+formID+'"] #mainPanel .genSlide [data-itemid="'+itemID+'"]').is('[data-type="slider"]')){value=parseFloat(jQuery('#estimation_popup.wpe_bootstraped[data-form="'+formID+'"] #mainPanel .genSlide [data-itemid="'+itemID+'"]').data("resprice"));if(isNaN(value)){value=0}}}}if(action=="quantity"){if($item.is('input[type="number"]')||jQuery('#estimation_popup.wpe_bootstraped[data-form="'+formID+'"] #mainPanel .genSlide [data-itemid="'+itemID+'"]').is(".checked")||jQuery('#estimation_popup.wpe_bootstraped[data-form="'+formID+'"] #mainPanel .genSlide [data-itemid="'+itemID+'"]').is(":checked")){if($item.find(".icon_quantity").length>0){value=parseFloat($item.find(".icon_quantity").html())}else{if($item.is('input[type="number"]')){value=$item.val()}else{value=$item.find(".wpe_qtfield").val()}}if(isNaN(value)){value=0}}else{if(jQuery('#estimation_popup.wpe_bootstraped[data-form="'+formID+'"] #mainPanel .genSlide [data-itemid="'+itemID+'"]').is('[data-type="slider"]')){value=jQuery('#estimation_popup.wpe_bootstraped[data-form="'+formID+'"] #mainPanel .genSlide [data-itemid="'+itemID+'"]').slider("value")}}}if(action=="value"){if(jQuery('#estimation_popup.wpe_bootstraped[data-form="'+formID+'"] #mainPanel .genSlide [data-itemid="'+itemID+'"]').is("select")||jQuery('#estimation_popup.wpe_bootstraped[data-form="'+formID+'"] #mainPanel .genSlide [data-itemid="'+itemID+'"]').is('input:not([type="number"])')||jQuery('#estimation_popup.wpe_bootstraped[data-form="'+formID+'"] #mainPanel .genSlide [data-itemid="'+itemID+'"]').is("textarea")){value="'"+jQuery('#estimation_popup.wpe_bootstraped[data-form="'+formID+'"] #mainPanel .genSlide [data-itemid="'+itemID+'"]').val()+"'"}else{value=parseFloat(jQuery('#estimation_popup.wpe_bootstraped[data-form="'+formID+'"] #mainPanel .genSlide [data-itemid="'+itemID+'"]').val());if(isNaN(value)){value=0}}}if(action=="date"){if($item.is(".lfb_datepicker")&&$item.datetimepicker("getDate")!=null){value="'"+moment.utc($item.datetimepicker("getDate")).format("YYYY-MM-DD")+"'"}else{value="null"}}elementsToReplace.push({oldValue:calculation.substr(i-1,(calculation.indexOf("]",i)+1)-(i-1)),newValue:value})}while((i=calculation.indexOf("step-",i+1))!=-1){var stepID=calculation.substr(i+5,calculation.indexOf("_",i)-(i+5));var action=calculation.substr(calculation.indexOf("_",i)+1,(calculation.indexOf("]",i)-1)-(calculation.indexOf("_",i)));if(action=="quantity"){value=wpe_getStepQuantities(formID,stepID)}elementsToReplace.push({oldValue:calculation.substr(i-1,(calculation.indexOf("]",i)+1)-(i-1)),newValue:value})}var todayDate=new Date();var month=todayDate.getMonth()+1;if(month<10){month="0"+month}var today=todayDate.getFullYear().toString()+month.toString()+todayDate.getDate().toString();calculation=calculation.replace(/\[currentDate\]/g,today);if(calculation.indexOf("dateDifference-")>-1){while((i=calculation.indexOf("dateDifference-",i+1))!=-1){var startDateAdPosEnd=calculation.indexOf("_",i+15)+1;var startDate=calculation.substr(i+15,calculation.indexOf("_",i)-(i+15));var endDate=calculation.substr(startDateAdPosEnd,calculation.indexOf("]",startDateAdPosEnd)-(startDateAdPosEnd));if(startDate=="currentDate"){startDate=todayDate}else{if(jQuery('#estimation_popup.wpe_bootstraped[data-form="'+formID+'"] #mainPanel .genSlide [data-itemid="'+startDate+'"]').length>0&&jQuery('#estimation_popup.wpe_bootstraped[data-form="'+formID+'"] #mainPanel .genSlide [data-itemid="'+startDate+'"]').val().length>0){var $item=jQuery('#estimation_popup.wpe_bootstraped[data-form="'+formID+'"] #mainPanel .genSlide [data-itemid="'+startDate+'"]');startDate=$item.datetimepicker("getDate")}else{startDate=todayDate}}if(endDate=="currentDate"){endDate=todayDate}else{if(jQuery('#estimation_popup.wpe_bootstraped[data-form="'+formID+'"] #mainPanel .genSlide [data-itemid="'+endDate+'"]').length>0&&jQuery('#estimation_popup.wpe_bootstraped[data-form="'+formID+'"] #mainPanel .genSlide [data-itemid="'+endDate+'"]').val().length>0){var $item=jQuery('#estimation_popup.wpe_bootstraped[data-form="'+formID+'"] #mainPanel .genSlide [data-itemid="'+endDate+'"]');endDate=$item.datetimepicker("getDate")}else{endDate=todayDate}}var timeDiff=Math.abs(endDate.getTime()-startDate.getTime());var result=Math.ceil(timeDiff/(1000*3600*24));if(result<0){result=0}elementsToReplace.push({oldValue:calculation.substr(i-1,(calculation.indexOf("]",i)+1)-(i-1)),newValue:result})}}if(calculation.indexOf("distance_")>-1){$target.attr("data-usedistance","true");while((i=calculation.indexOf("distance_",i+1))!=-1){var distanceType="km";var departAdPosEnd=calculation.indexOf("-",i+9)+1;var departAdress=calculation.substr(i+9,calculation.indexOf("-",i)-(i+9));var departCityPosEnd=calculation.indexOf("-",departAdPosEnd)+1;var departCity=calculation.substr(departAdPosEnd,calculation.indexOf("-",departAdPosEnd)-(departAdPosEnd));var departZipPosEnd=calculation.indexOf("-",departCityPosEnd)+1;var departZip=calculation.substr(departCityPosEnd,calculation.indexOf("-",departCityPosEnd)-(departCityPosEnd));var departCountryPosEnd=calculation.indexOf("_",departZipPosEnd)+1;var departCountry=calculation.substr(departZipPosEnd,calculation.indexOf("_",departZipPosEnd)-(departZipPosEnd));var arrivalAdPosEnd=calculation.indexOf("-",departCountryPosEnd)+1;var arrivalAdress=calculation.substr(departCountryPosEnd,calculation.indexOf("-",departCountryPosEnd)-(departCountryPosEnd));var arrivalCityPosEnd=calculation.indexOf("-",arrivalAdPosEnd)+1;var arrivalCity=calculation.substr(arrivalAdPosEnd,calculation.indexOf("-",arrivalAdPosEnd)-(arrivalAdPosEnd));var arrivalZipPosEnd=calculation.indexOf("-",arrivalCityPosEnd)+1;var arrivalZip=calculation.substr(arrivalCityPosEnd,calculation.indexOf("-",arrivalCityPosEnd)-(arrivalCityPosEnd));var arrivalCountryPosEnd=calculation.indexOf("_",arrivalZipPosEnd)+1;var arrivalCountry=calculation.substr(arrivalZipPosEnd,calculation.indexOf("_",arrivalZipPosEnd)-(arrivalZipPosEnd));distanceType=calculation.substr(arrivalCountryPosEnd,calculation.indexOf("]",arrivalCountryPosEnd)-(arrivalCountryPosEnd));if(departAdress!=""){if(jQuery('#estimation_popup.wpe_bootstraped[data-form="'+formID+'"] #mainPanel .genSlide [data-itemid="'+departAdress+'"]').length>0){var $item=jQuery('#estimation_popup.wpe_bootstraped[data-form="'+formID+'"] #mainPanel .genSlide [data-itemid="'+departAdress+'"]');departAdress=$item.val()}else{departAdress=0}}if(departCity!=""){if(jQuery('#estimation_popup.wpe_bootstraped[data-form="'+formID+'"] #mainPanel .genSlide [data-itemid="'+departCity+'"]').length>0){var $item=jQuery('#estimation_popup.wpe_bootstraped[data-form="'+formID+'"] #mainPanel .genSlide [data-itemid="'+departCity+'"]');departCity=$item.val()}else{departCity=0}}if(departZip!=""){if(jQuery('#estimation_popup.wpe_bootstraped[data-form="'+formID+'"] #mainPanel .genSlide [data-itemid="'+departZip+'"]').length>0){var $item=jQuery('#estimation_popup.wpe_bootstraped[data-form="'+formID+'"] #mainPanel .genSlide [data-itemid="'+departZip+'"]');departZip=$item.val()}else{departZip=0}}if(departCountry!=""){if(jQuery('#estimation_popup.wpe_bootstraped[data-form="'+formID+'"] #mainPanel .genSlide [data-itemid="'+departCountry+'"]').length>0){var $item=jQuery('#estimation_popup.wpe_bootstraped[data-form="'+formID+'"] #mainPanel .genSlide [data-itemid="'+departCountry+'"]');departCountry=$item.val()}else{departCountry=0}}if(arrivalAdress!=""){if(jQuery('#estimation_popup.wpe_bootstraped[data-form="'+formID+'"] #mainPanel .genSlide [data-itemid="'+arrivalAdress+'"]').length>0){var $item=jQuery('#estimation_popup.wpe_bootstraped[data-form="'+formID+'"] #mainPanel .genSlide [data-itemid="'+arrivalAdress+'"]');arrivalAdress=$item.val()}else{arrivalAdress=0}}if(arrivalCity!=""){if(jQuery('#estimation_popup.wpe_bootstraped[data-form="'+formID+'"] #mainPanel .genSlide [data-itemid="'+arrivalCity+'"]').length>0){var $item=jQuery('#estimation_popup.wpe_bootstraped[data-form="'+formID+'"] #mainPanel .genSlide [data-itemid="'+arrivalCity+'"]');arrivalCity=$item.val()}else{arrivalCity=0}}if(arrivalZip!=""){if(jQuery('#estimation_popup.wpe_bootstraped[data-form="'+formID+'"] #mainPanel .genSlide [data-itemid="'+arrivalZip+'"]').length>0){var $item=jQuery('#estimation_popup.wpe_bootstraped[data-form="'+formID+'"] #mainPanel .genSlide [data-itemid="'+arrivalZip+'"]');arrivalZip=$item.val()}else{arrivalZip=0}}if(arrivalCountry!=""){if(jQuery('#estimation_popup.wpe_bootstraped[data-form="'+formID+'"] #mainPanel .genSlide [data-itemid="'+arrivalCountry+'"]').length>0){var $item=jQuery('#estimation_popup.wpe_bootstraped[data-form="'+formID+'"] #mainPanel .genSlide [data-itemid="'+arrivalCountry+'"]');arrivalCountry=$item.val()}else{arrivalCountry=0}}if($target.closest(".genSlide").find(".lfb_distanceError").length>0){lfb_removeDistanceError(targetID,formID)}var distanceCode=calculation.substr(i-1,(calculation.indexOf("]",i)+1)-(i-1));var distance=0;if($target.attr("data-distance")!=""){distance=parseFloat($target.attr("data-distance"))}if(departAdress==""&&departCity==""&&departCountry==""&&arrivalAdress==""&&arrivalCity==""&&arrivalCountry==""&&departZip==""&&arrivalZip==""){lfb_showDistanceError(targetID,formID)}else{if(form.gmap_key==""){lfb_showDistanceError(targetID,formID);console.log("invalid gmap api key")}else{var depart=departAdress+" "+departZip+" "+departCity+" "+departCountry;var arrival=arrivalAdress+" "+arrivalZip+" "+arrivalCity+" "+arrivalCountry;if($target.attr("data-departure")!=depart||arrival!=$target.attr("data-arrival")){$target.attr("data-departure",depart);$target.attr("data-arrival",arrival);lfb_getDistanceCalc(distanceCode,formID,targetID,depart,arrival,distanceType)}}}elementsToReplace.push({oldValue:calculation.substr(i-1,(calculation.indexOf("]",i)+1)-(i-1)),newValue:distance})}}jQuery.each(elementsToReplace,function(){calculation=calculation.replace(this.oldValue,this.newValue)});calculation=calculation.replace(/\[total\]/g,form.price);calculation=calculation.replace(/\[total_quantity\]/g,wpe_getTotalQuantities(formID,_stepID));i=0;while((i=calculation.indexOf("{",i+1))!=-1){var charsToEnd=calculation.substr(i+1,(calculation.indexOf("}",i+1)-(i+1)));if(/\S/.test(charsToEnd)){calculation=calculation.substr(0,i+1)+" price ="+calculation.substr(i+1,calculation.length);i+=8}}if(calculation.indexOf("if")<0){calculation="price = "+calculation}else{var charsToStart=calculation.substr(0,calculation.indexOf("if"));if(/\S/.test(charsToStart)){calculation="price = "+calculation}}calculation=lfb_removeDoubleSpaces(calculation);calculation=calculation.replace(/price =\n if/g,"\nif");calculation=calculation.replace(/price = if/g,"if");calculation=calculation.replace(/price = \nif/g,"\nif");calculation=calculation.replace(/price = \n if/g,"\n if");try{eval(calculation)}catch(e){console.log("wrong calculation : "+calculation)}return parseFloat(price)}function lfb_parseDate(a){var b=a;if(typeof a=="string"){var c=a.match(/(\d+)/g);b=new Date(c[0],c[1]-1,c[2])}return b}function lfb_removeDoubleSpaces(a){a=a.replace(/\t/g,"");a=a.replace(/  /g," ");if(a.indexOf("  ")>-1){lfb_removeDoubleSpaces(a)}return a}function lfb_removeDistanceError(d,c){var a=jQuery('#estimation_popup.wpe_bootstraped[data-form="'+c+'"] #mainPanel .genSlide [data-itemid="'+d+'"]');if(a.closest(".genSlide").find('[data-itemid][data-usedistance="true"]:not([data-distance]):not([type="checkbox"]).checked,[data-itemid][data-usedistance="true"]:not([data-distance]):checked,[data-itemid][data-usedistance="true"]:not([data-distance])[data-type="slider"]').length==0&&a.closest(".genSlide").find('[data-itemid][data-usedistance="true"][data-distance="0"]:not([type="checkbox"]).checked,[data-itemid][data-usedistance="true"][data-distance="0"]:checked,[data-itemid][data-usedistance="true"][data-distance="0"][data-type="slider"]').length==0){a.closest(".genSlide").find(".btn-next").fadeIn();a.closest(".genSlide").find(".lfb_btnNextContainer").fadeIn();a.closest(".genSlide").find(".btn-next").removeClass("lfb_disabledBtn");var b=a.closest(".genSlide").find(".lfb_distanceError");b.fadeOut();setTimeout(function(){b.remove()},300)}}function lfb_showDistanceError(e,d){var b=wpe_getForm(d);var a=jQuery('#estimation_popup.wpe_bootstraped[data-form="'+d+'"] #mainPanel .genSlide [data-itemid="'+e+'"]');a.closest(".genSlide").find(".btn-next").addClass("lfb_disabledBtn");a.closest(".genSlide").find(".btn-next").hide();if(a.closest(".genSlide").find(".lfb_distanceError").length==0){a.closest(".genSlide").find(".lfb_btnNextContainer").before('<div class="lfb_distanceError alert alert-danger"><p>'+b.txtDistanceError+"</p></div>")}var c=jQuery('#estimation_popup.wpe_bootstraped[data-form="'+d+'"] [data-itemid="'+e+'"]').closest(".genSlide").attr("data-stepid");if(b.step=="final"&&!b.backFomFinal){b.backFomFinal=true;wpe_changeStep(c,d)}}function wpe_updateLabelItem(a,b){form=wpe_getForm(b);if(!a.is(".dropzone")){a.closest(".itemBloc").find("label").each(function(){if(jQuery(this).html().indexOf(":")>-1&&jQuery(this).closest(".switch").length==0){jQuery(this).html(a.attr("data-original-title"))}})}}function wpe_updatePrice(d){var c=false;lfb_updateShowSteps(d);lfb_updateShowItems(d);lfb_updateLayerImages(d);form=wpe_getForm(d);form.lastPrice=form.price;form.price=form.initialPrice;form.priceSingle=0;wpe_updatePlannedSteps(d);wpe_updateStep(d);var l=lfb_lastSteps.slice();var f=0;var r=0;if(form.step!="final"&&jQuery.inArray(parseInt(form.step),l)==-1){l.push(parseInt(form.step))}else{if(form.step=="final"&&jQuery.inArray("final",l)==-1){l.push("final")}}jQuery.each(l,function(){var e=this;if((e=="final"||parseInt(e)!=0)&&!jQuery('#estimation_popup.wpe_bootstraped[data-form="'+form.formID+'"] #mainPanel .genSlide[data-stepid="'+e+'"]').is(".lfb_disabled")){$panel=jQuery('#estimation_popup.wpe_bootstraped[data-form="'+form.formID+'"] #mainPanel .genSlide[data-stepid="'+e+'"]');$panel.find('div.selectable.checked, a.lfb_button.checked, input[type=checkbox]:checked,select[data-itemid][data-price],div[data-type="slider"],input[type=number][data-valueasqt="1"]').each(function(){if(!jQuery(this).is(".lfb_disabled")&&jQuery(this).closest(".itemBloc.lfb_disabled").length==0){if(!jQuery(this).is(".lfb_disabled")){if(jQuery(this).is('[data-singleprice="true"]')){c=true}jQuery(this).data("price",jQuery(this).attr("data-price"));if(jQuery(this).is("[data-usecalculation]")){if(form.step!="final"||lfb_executeCalculation(jQuery(this).attr("data-calculation"),d,jQuery(this).attr("data-itemid"))!=0){jQuery(this).data("price",lfb_executeCalculation(jQuery(this).attr("data-calculation"),d,jQuery(this).attr("data-itemid")))}}if(jQuery(this).find(".icon_quantity").length>0||jQuery(this).find(".wpe_qtfield").length>0||jQuery(this).is('[data-type="slider"]')||jQuery(this).is('input[type=number][data-valueasqt="1"]')){var s="";var v=0;var y=99999999999999;if(jQuery(this).find(".icon_quantity").length>0){s=jQuery(this).find(".icon_quantity").html();v=jQuery(this).find(".quantityBtns").attr("data-min");y=jQuery(this).find(".quantityBtns").attr("data-max")}else{if(jQuery(this).find(".wpe_qtfield").length>0){s=jQuery(this).find(".wpe_qtfield").val();v=jQuery(this).find(".wpe_qtfield").attr("min");y=jQuery(this).find(".wpe_qtfield").attr("max")}else{if(jQuery(this).is('[data-type="slider"]')){s=parseInt(jQuery(this).slider("value"));if(!isNaN(parseInt(jQuery(this).find(".tooltip-inner").html()))){s=parseInt(jQuery(this).find(".tooltip-inner").html())}v=jQuery(this).attr("data-min");y=jQuery(this).attr("data-max")}else{if(jQuery(this).is('input[type=number][data-valueasqt="1"]')){s=parseFloat(jQuery(this).val());v=jQuery(this).attr("min");if(jQuery(this).is("[max]")){y=jQuery(this).attr("max")}else{y=100000000000000000}}}}}if(jQuery(this).is("[data-usecalculationqt]")){s=lfb_executeCalculation(jQuery(this).attr("data-calculationqt"),d,jQuery(this).attr("data-itemid"));if(isNaN(s)){s=0}if(s>y){s=y}if(s<v){s=v}if(jQuery(this).find(".icon_quantity").length>0){jQuery(this).find(".icon_quantity").html(s);if(jQuery(this).find(".wpe_sliderQt").length>0){jQuery(this).find(".wpe_sliderQt").slider("value",parseInt(s))}jQuery(this).find(".quantityBtns").addClass("lfb-hidden")}else{if(jQuery(this).find(".wpe_qtfield").length>0){jQuery(this).find(".wpe_qtfield").val(s)}else{if(jQuery(this).is('[data-type="slider"]')){jQuery(this).slider("value",parseInt(s))}else{if(jQuery(this).is('input[type="number"]')){jQuery(this).val(s)}}}}}if(jQuery(this).is("[data-distanceqt]")){lfb_executeCalculation(jQuery(this).attr("data-distanceqt"),d,jQuery(this).attr("data-itemid"));if(jQuery(this).is("[data-distance]")){s=parseFloat(jQuery(this).attr("data-distance")).toFixed(2)}if(s<v){s=v}else{if(s>y){s=y}}if(jQuery(this).find(".wpe_qtfield").length>0){jQuery(this).find(".wpe_qtfield").val(s)}else{if(jQuery(this).find(".wpe_sliderQt").length>0){jQuery(this).find(".wpe_sliderQt").slider("value",s);jQuery(this).find(".icon_quantity").html(s)}else{if(jQuery(this).find(".quantityBtns").length>0){jQuery(this).find(".icon_quantity").html(s)}else{if(jQuery(this).is('[data-type="slider"]')){jQuery(this).slider("value",s)}}}}if(jQuery(this).is("[data-usecalculation]")){jQuery(this).data("price",lfb_executeCalculation(jQuery(this).attr("data-calculation"),d,jQuery(this).attr("data-itemid")))}}jQuery(this).attr("data-resqt",s);if((jQuery(' #estimation_popup.wpe_bootstraped[data-form="'+form.formID+'"] #mainPanel').data("savecart")=="0")||(jQuery(' #estimation_popup.wpe_bootstraped[data-form="'+form.formID+'"] #mainPanel').data("savecart")=="1"&&jQuery(this).data("prodid")>0)){if(jQuery(this).data("price")){if(jQuery(this).data("operation")=="-"){jQuery(this).data("resprice",0-parseFloat(jQuery(this).data("price"))*parseFloat(s));if(jQuery(this).is('[data-singleprice="true"]')){form.priceSingle-=parseFloat(jQuery(this).data("price"))*parseFloat(s)}else{form.price-=parseFloat(jQuery(this).data("price"))*parseFloat(s)}}else{if(jQuery(this).data("operation")=="x"){for(var w=0;w<parseFloat(s);w++){if(w==0){form.price=form.price;jQuery(this).data("resprice",form.price)}else{if(jQuery(this).is('[data-singleprice="true"]')){if(jQuery(this).is('[data-addtototal!="1"]')){form.priceSingle+=((r*parseFloat(jQuery(this).data("price")))/100)}jQuery(this).data("resprice",(r*parseFloat(jQuery(this).data("price")))/100)}else{if(jQuery(this).is('[data-addtototal!="1"]')){form.price+=((f*parseFloat(jQuery(this).data("price")))/100)}jQuery(this).data("resprice",(form.price*parseFloat(jQuery(this).data("price")))/100)}}}}else{if(jQuery(this).data("operation")=="/"){for(var w=0;w<parseFloat(s);w++){jQuery(this).data("resprice",0-(form.price*parseFloat(jQuery(this).data("price")))/100);if(jQuery(this).is('[data-singleprice="true"]')){if(jQuery(this).is('[data-addtototal!="1"]')){form.priceSingle=form.price-(form.price*parseFloat(jQuery(this).data("price")))/100}}else{if(jQuery(this).is('[data-addtototal!="1"]')){form.price=form.price-(form.price*parseFloat(jQuery(this).data("price")))/100}}}}else{var z=-2;if(jQuery(this).data("reduc")&&jQuery(this).data("reducqt").length>0){var B=this;var A=jQuery(this).data("reducqt");A=A.split("*");var x=new Array();var t=0;jQuery.each(A,function(C){var D=A[C].split("|");x.push(D[1]);if(parseFloat(D[0])<=parseFloat(s)){z=C}if(parseFloat(D[0])<t||t==0){t=parseFloat(D[0])}})}if(z>=0){var u=parseFloat(x[z])*parseFloat(s);if(jQuery(this).attr("data-price")=="0"){u=parseFloat(x[z])*(parseFloat(s)-t)}jQuery(this).data("resprice",u);if(jQuery(this).is('[data-singleprice="true"]')){if(jQuery(this).is('[data-addtototal!="1"]')){form.priceSingle+=parseFloat(u)}}else{if(jQuery(this).is('[data-addtototal!="1"]')){form.price+=parseFloat(u)}}if(form.currencyPosition=="left"){if(jQuery(this).is('[data-showprice="1"]')){if(jQuery(this).data("operation")=="+"){jQuery(this).attr("title",jQuery(this).data("originaltitle")+" : "+form.currency+(wpe_formatPrice(x[z],d)));jQuery(this).attr("data-original-title",jQuery(this).data("originaltitle")+" : "+form.currency+(wpe_formatPrice(x[z],d)));if(form.disableTipMobile==0||!wpe_is_touch_device()){if(!jQuery(this).is('[data-type="slider"]')&&!jQuery(this).is(".lfb_button")&&form.imgTitlesStyle==""){jQuery(this).b_tooltip("fixTitle")}}wpe_updateLabelItem(jQuery(this),d)}else{if(jQuery(this).data("operation")=="-"){jQuery(this).attr("title",jQuery(this).data("originaltitle")+" : -"+form.currency+(wpe_formatPrice(x[z],d)));if(form.disableTipMobile==0||!wpe_is_touch_device()){if(!jQuery(this).is('[data-type="slider"]')&&!jQuery(this).is(".lfb_button")&&form.imgTitlesStyle==""){jQuery(this).b_tooltip("fixTitle")}}jQuery(this).attr("data-original-title",jQuery(this).data("originaltitle")+" : -"+form.currency+(wpe_formatPrice(x[z],d)));if(form.disableTipMobile==0||!wpe_is_touch_device()){if(!jQuery(this).is('[data-type="slider"]')&&!jQuery(this).is(".lfb_button")&&form.imgTitlesStyle==""){jQuery(this).b_tooltip("fixTitle")}}wpe_updateLabelItem(jQuery(this),d)}else{if(jQuery(this).data("operation")=="x"){jQuery(this).attr("title",jQuery(this).data("originaltitle")+" : +"+(wpe_formatPrice(x[z],d))+"%");if(form.disableTipMobile==0||!wpe_is_touch_device()){if(!jQuery(this).is('[data-type="slider"]')&&!jQuery(this).is(".lfb_button")&&form.imgTitlesStyle==""){jQuery(this).b_tooltip("fixTitle")}}jQuery(this).attr("data-original-title",jQuery(this).data("originaltitle")+" : +"+(wpe_formatPrice(x[z],d))+"%");if(form.disableTipMobile==0||!wpe_is_touch_device()){if(!jQuery(this).is('[data-type="slider"]')&&!jQuery(this).is(".lfb_button")&&form.imgTitlesStyle==""){jQuery(this).b_tooltip("fixTitle")}}wpe_updateLabelItem(jQuery(this),d)}else{jQuery(this).attr("title",jQuery(this).data("originaltitle")+" : -"+(wpe_formatPrice(x[z],d))+"%");if(form.disableTipMobile==0||!wpe_is_touch_device()){if(!jQuery(this).is('[data-type="slider"]')&&!jQuery(this).is(".lfb_button")&&form.imgTitlesStyle==""){jQuery(this).b_tooltip("fixTitle")}}jQuery(this).attr("data-original-title",jQuery(this).data("originaltitle")+" : -"+(wpe_formatPrice(x[z],d))+"%");if(form.disableTipMobile==0||!wpe_is_touch_device()){if(!jQuery(this).is('[data-type="slider"]')&&!jQuery(this).is(".lfb_button")&&form.imgTitlesStyle==""){jQuery(this).b_tooltip("fixTitle")}}wpe_updateLabelItem(jQuery(this),d)}}}}else{jQuery(this).attr("data-original-title",jQuery(this).data("originaltitle"))}if(jQuery(this).find(".quantityBtns").is(".open")&&form.imgTitlesStyle==""){if(form.disableTipMobile==0||!wpe_is_touch_device()){jQuery(this).b_tooltip("show")}}}else{if(jQuery(this).is('[data-showprice="1"]')){if(jQuery(this).attr("data-operation")=="+"){jQuery(this).attr("title",jQuery(this).data("originaltitle")+" : "+(wpe_formatPrice(x[z],d))+form.currency);jQuery(this).attr("data-original-title",jQuery(this).data("originaltitle")+" : "+(wpe_formatPrice(x[z],d))+form.currency);if(form.disableTipMobile==0||!wpe_is_touch_device()){if(!jQuery(this).is('[data-type="slider"]')&&!jQuery(this).is(".lfb_button")&&form.imgTitlesStyle==""){jQuery(this).b_tooltip("fixTitle")}}wpe_updateLabelItem(jQuery(this),d)}else{if(jQuery(this).attr("data-operation")=="-"){jQuery(this).attr("title",jQuery(this).data("originaltitle")+" : -"+ +(wpe_formatPrice(x[z],d)));jQuery(this).attr("data-original-title",jQuery(this).data("originaltitle")+" : -"+(wpe_formatPrice(x[z],d))+form.currency);if(form.disableTipMobile==0||!wpe_is_touch_device()){if(!jQuery(this).is('[data-type="slider"]')&&!jQuery(this).is(".lfb_button")&&form.imgTitlesStyle==""){jQuery(this).b_tooltip("fixTitle")}}wpe_updateLabelItem(jQuery(this),d)}else{if(jQuery(this).attr("data-operation")=="x"){jQuery(this).attr("title",jQuery(this).data("originaltitle")+" : +"+(wpe_formatPrice(x[z],d))+"%");if(form.disableTipMobile==0||!wpe_is_touch_device()){if(!jQuery(this).is('[data-type="slider"]')&&!jQuery(this).is(".lfb_button")&&form.imgTitlesStyle==""){jQuery(this).b_tooltip("fixTitle")}}jQuery(this).attr("data-original-title",jQuery(this).data("originaltitle")+" : +"+(wpe_formatPrice(x[z],d))+"%");if(form.disableTipMobile==0||!wpe_is_touch_device()){if(!jQuery(this).is('[data-type="slider"]')&&!jQuery(this).is(".lfb_button")&&form.imgTitlesStyle==""){jQuery(this).b_tooltip("fixTitle")}}wpe_updateLabelItem(jQuery(this),d)}else{jQuery(this).attr("title",jQuery(this).data("originaltitle")+" : -"+(wpe_formatPrice(x[z],d))+"%");if(form.disableTipMobile==0||!wpe_is_touch_device()){if(!jQuery(this).is('[data-type="slider"]')&&!jQuery(this).is(".lfb_button")&&form.imgTitlesStyle==""){jQuery(this).b_tooltip("fixTitle")}}jQuery(this).attr("data-original-title",jQuery(this).data("originaltitle")+" : -"+(wpe_formatPrice(x[z],d))+"%");if(form.disableTipMobile==0||!wpe_is_touch_device()){if(!jQuery(this).is('[data-type="slider"]')&&!jQuery(this).is(".lfb_button")&&form.imgTitlesStyle==""){jQuery(this).b_tooltip("fixTitle")}}wpe_updateLabelItem(jQuery(this),d)}}}}else{jQuery(this).attr("data-original-title",jQuery(this).data("originaltitle"))}if(jQuery(this).find(".quantityBtns").is(".open")&&form.imgTitlesStyle==""){if(form.disableTipMobile==0||!wpe_is_touch_device()){jQuery(this).b_tooltip("show")}}}}else{jQuery(this).data("resprice",parseFloat(jQuery(this).data("price"))*parseFloat(s));form.price=parseFloat(form.price);form.priceSingle=parseFloat(form.priceSingle);if(jQuery(this).is('[data-singleprice="true"]')){if(jQuery(this).is('[data-addtototal!="1"]')){form.priceSingle+=parseFloat(jQuery(this).data("price"))*parseFloat(s)}}else{if(jQuery(this).is('[data-addtototal!="1"]')){form.price+=parseFloat(jQuery(this).data("price"))*parseFloat(s)}}wpe_updateItemTitleNoReduc(jQuery(this),form);if(jQuery(this).find(".quantityBtns").is(".open")&&form.imgTitlesStyle==""){if(form.disableTipMobile==0||!wpe_is_touch_device()){jQuery(this).b_tooltip("show")}}}}}}}else{jQuery(this).data("resprice","0")}}}else{jQuery(this).data("resqt","0");if(jQuery(this).data("price")){if(jQuery(this).data("operation")=="-"){jQuery(this).data("resprice",0-parseFloat(jQuery(this).data("price")));if(jQuery(this).is('[data-singleprice="true"]')){if(jQuery(this).is('[data-addtototal!="1"]')){form.priceSingle-=parseFloat(jQuery(this).data("price"))}}else{if(jQuery(this).is('[data-addtototal!="1"]')){form.price-=parseFloat(jQuery(this).data("price"))}}}else{if(jQuery(this).data("operation")=="x"){if(jQuery(this).is('[data-singleprice="true"]')){jQuery(this).data("resprice",(form.priceSingle*parseFloat(jQuery(this).data("price")))/100);if(jQuery(this).is('[data-addtototal!="1"]')){form.priceSingle=form.priceSingle+(form.priceSingle*parseFloat(jQuery(this).data("price")))/100}}else{jQuery(this).data("resprice",(form.price*parseFloat(jQuery(this).data("price")))/100);if(jQuery(this).is('[data-addtototal!="1"]')){form.price=form.price+(form.price*parseFloat(jQuery(this).data("price")))/100}}}else{if(jQuery(this).attr("data-operation")=="/"){if(jQuery(this).is('[data-singleprice="true"]')){jQuery(this).data("resprice",0-(form.priceSingle*parseFloat(jQuery(this).data("price")))/100);if(jQuery(this).is('[data-addtototal!="1"]')){form.priceSingle=form.priceSingle-(form.priceSingle*parseFloat(jQuery(this).data("price")))/100}}else{jQuery(this).data("resprice",0-(form.price*parseFloat(jQuery(this).data("price")))/100);if(jQuery(this).is('[data-addtototal!="1"]')){form.price=form.price-(form.price*parseFloat(jQuery(this).data("price")))/100}}}else{jQuery(this).data("resprice",jQuery(this).data("price"));if(jQuery(this).is('[data-singleprice="true"]')){if(jQuery(this).is('[data-addtototal!="1"]')){form.priceSingle+=parseFloat(jQuery(this).data("price"))}}else{if(jQuery(this).is('[data-addtototal!="1"]')){form.price=parseFloat(form.price)+parseFloat(jQuery(this).data("price"))}}}}}wpe_updateItemTitleNoReduc(jQuery(this),form)}else{jQuery(this).data("resprice","0")}}}}})}f=form.price;r=form.priceSingle});if(form.reduction>0){if(form.reductionType&&form.reductionType=="%"){if(form.priceSingle>0){form.reductionResult=(form.priceSingle*form.reduction)/100}else{form.reductionResult=(form.price*form.reduction)/100}}else{form.reductionResult=form.reduction}form.reductionResult=parseFloat(form.reductionResult);if(form.priceSingle==0){form.price-=form.reductionResult}else{form.priceSingle-=form.reductionResult}}if(!form.price||form.price<0){form.price=0}if(!c||!form.priceSingle||form.priceSingle<0){form.priceSingle=0}var n=/^\d+(\.\d{2})?$/;if(!n.test(form.price)){form.price=parseFloat(form.price).toFixed(2)}try{if(!n.test(form.priceSingle)){form.priceSingle=parseFloat(form.priceSingle).toFixed(2)}}catch(k){}var p=form.currency+""+wpe_formatPrice(parseFloat(form.priceSingle),d);var b=form.currency+""+wpe_formatPrice(parseFloat(form.price),d);var o=jQuery('#estimation_popup.wpe_bootstraped[data-form="'+form.formID+'"]').attr("data-rangelabelbetween");var m=jQuery('#estimation_popup.wpe_bootstraped[data-form="'+form.formID+'"]').attr("data-rangelabeland");if(jQuery('#estimation_popup.wpe_bootstraped[data-form="'+form.formID+'"]').is("[data-totalrange]")&&parseFloat(form.price)>0){if(!jQuery('#estimation_popup.wpe_bootstraped[data-form="'+form.formID+'"] .genPrice .progress .progress-bar-price').is(".lfb_notNull")){jQuery('#estimation_popup.wpe_bootstraped[data-form="'+form.formID+'"] .genPrice .progress .progress-bar-price').addClass("lfb_notNull")}var h=parseInt(jQuery('#estimation_popup.wpe_bootstraped[data-form="'+form.formID+'"]').attr("data-totalrange"));var a=(parseFloat(form.price)-h/2);var g=parseFloat(form.price)+h/2;if(jQuery('#estimation_popup.wpe_bootstraped[data-form="'+form.formID+'"]').is('[data-rangemode="percent"]')){a=parseFloat(form.price)-((parseFloat(form.price)*h)/100);g=parseFloat(form.price)+((parseFloat(form.price)*h)/100)}if(a<0){a=0}b=o+"<br/><strong>"+form.currency+""+wpe_formatPrice(a,d)+"</strong><br/>"+m+"<br/><strong>"+form.currency+""+wpe_formatPrice(g,d)+"</strong>"}else{jQuery('#estimation_popup.wpe_bootstraped[data-form="'+form.formID+'"] .genPrice .progress .progress-bar-price').removeClass("lfb_notNull")}if(form.currencyPosition!="left"){b=wpe_formatPrice(form.price,d)+""+form.currency;p=wpe_formatPrice(form.priceSingle,d)+""+form.currency;if(jQuery('#estimation_popup.wpe_bootstraped[data-form="'+form.formID+'"]').is("[data-totalrange]")&&parseFloat(form.price)>0){if(!jQuery('#estimation_popup.wpe_bootstraped[data-form="'+form.formID+'"] .genPrice .progress .progress-bar-price').is(".lfb_notNull")){jQuery('#estimation_popup.wpe_bootstraped[data-form="'+form.formID+'"] .genPrice .progress .progress-bar-price').addClass("lfb_notNull")}var h=parseInt(jQuery('#estimation_popup.wpe_bootstraped[data-form="'+form.formID+'"]').attr("data-totalrange"));var a=(parseFloat(form.price)-h/2);var g=parseFloat(form.price)+h/2;if(jQuery('#estimation_popup.wpe_bootstraped[data-form="'+form.formID+'"]').is('[data-rangemode="percent"]')){a=parseFloat(form.price)-((parseFloat(form.price)*h)/100);g=parseFloat(form.price)+((parseFloat(form.price)*h)/100)}if(a<0){a=0}b=o+"<br/><strong>"+wpe_formatPrice(a,d)+form.currency+"</strong><br/>"+m+"<br/><strong>"+wpe_formatPrice(g,d)+form.currency+"</strong>"}else{jQuery('#estimation_popup.wpe_bootstraped[data-form="'+form.formID+'"] .genPrice .progress .progress-bar-price').removeClass("lfb_notNull")}}if(form.showTotalBottom==1){if(c&&form.priceSingle>0){if(form.price<0){jQuery('#estimation_popup.wpe_bootstraped[data-form="'+form.formID+'"] .lfb_totalBottom').removeClass("lfb_priceSingle");jQuery('#estimation_popup.wpe_bootstraped[data-form="'+form.formID+'"] .lfb_totalBottom>span.lfb_subPrice').remove();jQuery('#estimation_popup.wpe_bootstraped[data-form="'+form.formID+'"] .lfb_totalBottom>br').remove()}else{jQuery('#estimation_popup.wpe_bootstraped[data-form="'+form.formID+'"] .lfb_totalBottom').addClass("lfb_priceSingle");jQuery('#estimation_popup.wpe_bootstraped[data-form="'+form.formID+'"] .lfb_totalBottom').each(function(){if(jQuery(this).find(".lfb_subPrice").length==0){jQuery(this).find(">span:eq(0)").after('<br/><span class="lfb_subPrice">+ '+b+"</span>")}})}}else{jQuery('#estimation_popup.wpe_bootstraped[data-form="'+form.formID+'"] .lfb_totalBottom').removeClass("lfb_priceSingle");jQuery('#estimation_popup.wpe_bootstraped[data-form="'+form.formID+'"] .lfb_totalBottom>span.lfb_subPrice').remove();jQuery('#estimation_popup.wpe_bootstraped[data-form="'+form.formID+'"] .lfb_totalBottom>br').remove()}if(c&&form.priceSingle>0){if(form.price<=0){jQuery('#estimation_popup.wpe_bootstraped[data-form="'+form.formID+'"] .lfb_totalBottom> span:first-child').html(p);jQuery('#estimation_popup.wpe_bootstraped[data-form="'+form.formID+'"] .lfb_totalBottom> span.lfb_subPrice').hide();jQuery('#estimation_popup.wpe_bootstraped[data-form="'+form.formID+'"] .lfb_totalBottom> span:eq(2)').hide();jQuery('#estimation_popup.wpe_bootstraped[data-form="'+form.formID+'"] .lfb_totalBottom .lfb_subTxtBottom').hide()}else{jQuery('#estimation_popup.wpe_bootstraped[data-form="'+form.formID+'"] .lfb_totalBottom> span.lfb_subPrice').show();jQuery('#estimation_popup.wpe_bootstraped[data-form="'+form.formID+'"] .lfb_totalBottom> span:eq(2)').show();jQuery('#estimation_popup.wpe_bootstraped[data-form="'+form.formID+'"] .lfb_totalBottom> span:first-child').html(p);jQuery('#estimation_popup.wpe_bootstraped[data-form="'+form.formID+'"] .lfb_totalBottom> span.lfb_subPrice').html("+ "+b);jQuery('#estimation_popup.wpe_bootstraped[data-form="'+form.formID+'"] .lfb_totalBottom .lfb_subTxtBottom').show()}}else{if(form.price<=0){jQuery('#estimation_popup.wpe_bootstraped[data-form="'+form.formID+'"] .lfb_totalBottom .lfb_subTxtBottom').hide()}else{jQuery('#estimation_popup.wpe_bootstraped[data-form="'+form.formID+'"] .lfb_totalBottom .lfb_subTxtBottom').show()}jQuery('#estimation_popup.wpe_bootstraped[data-form="'+form.formID+'"] .lfb_totalBottom> span:first-child').html(b)}}if(form.showSteps==0){if(c&&form.priceSingle>0){if(form.price<0){jQuery('#estimation_popup.wpe_bootstraped[data-form="'+form.formID+'"] .genPrice .progress .progress-bar-price').removeClass("lfb_priceSingle");jQuery('#estimation_popup.wpe_bootstraped[data-form="'+form.formID+'"] .genPrice .progress .progress-bar-price>span.lfb_subPrice').remove()}else{jQuery('#estimation_popup.wpe_bootstraped[data-form="'+form.formID+'"] .genPrice .progress .progress-bar-price').addClass("lfb_priceSingle");if(jQuery('#estimation_popup.wpe_bootstraped[data-form="'+form.formID+'"] .genPrice .progress .progress-bar-price> span.lfb_subPrice').length==0){jQuery('#estimation_popup.wpe_bootstraped[data-form="'+form.formID+'"] .genPrice .progress .progress-bar-price>span:eq(0)').after('<span class="lfb_subPrice">+ '+b+"</span>")}}}else{jQuery('#estimation_popup.wpe_bootstraped[data-form="'+form.formID+'"] .genPrice .progress .progress-bar-price').removeClass("lfb_priceSingle");jQuery('#estimation_popup.wpe_bootstraped[data-form="'+form.formID+'"] .genPrice .progress .progress-bar-price>span.lfb_subPrice').remove()}if(c&&form.priceSingle>0){if(form.price<=0){jQuery('#estimation_popup.wpe_bootstraped[data-form="'+form.formID+'"] .genPrice .progress .progress-bar-price> span:first-child').css("top","6px");jQuery('#estimation_popup.wpe_bootstraped[data-form="'+form.formID+'"] .genPrice .progress .progress-bar-price> span:first-child').html(p);jQuery('#estimation_popup.wpe_bootstraped[data-form="'+form.formID+'"] .genPrice .progress .progress-bar-price> span.lfb_subPrice').hide();jQuery('#estimation_popup.wpe_bootstraped[data-form="'+form.formID+'"] .genPrice .progress .progress-bar-price> span:eq(2)').hide()}else{jQuery('#estimation_popup.wpe_bootstraped[data-form="'+form.formID+'"] .genPrice .progress .progress-bar-price> span:first-child').css("top","-5px");jQuery('#estimation_popup.wpe_bootstraped[data-form="'+form.formID+'"] .genPrice .progress .progress-bar-price> span.lfb_subPrice').show();jQuery('#estimation_popup.wpe_bootstraped[data-form="'+form.formID+'"] .genPrice .progress .progress-bar-price> span:eq(2)').show();jQuery('#estimation_popup.wpe_bootstraped[data-form="'+form.formID+'"] .genPrice .progress .progress-bar-price> span:first-child').html(p);jQuery('#estimation_popup.wpe_bootstraped[data-form="'+form.formID+'"] .genPrice .progress .progress-bar-price> span.lfb_subPrice').html("+ "+b)}}else{if(jQuery('#estimation_popup.wpe_bootstraped[data-form="'+form.formID+'"]').is('[data-isSubs="true"]')){jQuery('#estimation_popup.wpe_bootstraped[data-form="'+form.formID+'"] .genPrice .progress .progress-bar-price> span:first-child').css("position","relative").css("top","6px")}else{jQuery('#estimation_popup.wpe_bootstraped[data-form="'+form.formID+'"] .genPrice .progress .progress-bar-price> span:first-child').css("position","relative").css("top","0px")}if(form.price>0){jQuery('#estimation_popup.wpe_bootstraped[data-form="'+form.formID+'"] .genPrice .progress .progress-bar-price> span:first-child').css("position","relative").css("top","0px");jQuery('#estimation_popup.wpe_bootstraped[data-form="'+form.formID+'"] .genPrice .progress .progress-bar-price> span:eq(1)').show()}else{jQuery('#estimation_popup.wpe_bootstraped[data-form="'+form.formID+'"] .genPrice .progress .progress-bar-price> span:eq(1)').hide()}jQuery('#estimation_popup.wpe_bootstraped[data-form="'+form.formID+'"] .genPrice .progress .progress-bar-price> span:first-child').html(b)}if(jQuery('#estimation_popup.wpe_bootstraped[data-form="'+form.formID+'"] .genPrice .progress .progress-bar-price> span:first-child').length>0){if(jQuery('#estimation_popup.wpe_bootstraped[data-form="'+form.formID+'"] .genPrice .progress .progress-bar-price> span:first-child').html().length>8){if(parseInt(jQuery('#estimation_popup.wpe_bootstraped[data-form="'+form.formID+'"] .genPrice .progress .progress-bar-price').css("font-size"))>=16){jQuery('#estimation_popup.wpe_bootstraped[data-form="'+form.formID+'"] .genPrice .progress .progress-bar-price').css("font-size","16px")}}else{jQuery('#estimation_popup.wpe_bootstraped[data-form="'+form.formID+'"] .genPrice .progress .progress-bar-price').css("font-size","18px")}if(jQuery('#estimation_popup.wpe_bootstraped[data-form="'+form.formID+'"] .genPrice .progress .progress-bar-price > span:first-child').html().length>9){if(parseInt(jQuery('#estimation_popup.wpe_bootstraped[data-form="'+form.formID+'"] .genPrice .progress .progress-bar-price').css("font-size"))>=14){jQuery('#estimation_popup.wpe_bootstraped[data-form="'+form.formID+'"] .genPrice .progress .progress-bar-price').css("font-size","14px")}}if(jQuery('#estimation_popup.wpe_bootstraped[data-form="'+form.formID+'"] .genPrice .progress .progress-bar-price > span:first-child').html().length>10){if(parseInt(jQuery('#estimation_popup.wpe_bootstraped[data-form="'+form.formID+'"] .genPrice .progress .progress-bar-price').css("font-size"))>=11){jQuery('#estimation_popup.wpe_bootstraped[data-form="'+form.formID+'"] .genPrice .progress .progress-bar-price').css("font-size","11px")}}}var j=(form.price*100)/form.priceMax;if(form.showInitialPrice==1){j=((form.price-parseFloat(form.initialPrice))*100)/form.priceMax}if(j>100){j=100}jQuery('#estimation_popup.wpe_bootstraped[data-form="'+form.formID+'"] .genPrice .progress .progress-bar').css("width",j+"%");if(jQuery("body").is(".rtl")){jQuery('#estimation_popup.wpe_bootstraped[data-form="'+form.formID+'"] .genPrice .progress .progress-bar-price').animate({right:j+"%"},70)}else{jQuery('#estimation_popup.wpe_bootstraped[data-form="'+form.formID+'"] .genPrice .progress .progress-bar-price').animate({left:j+"%"},70)}}var q=form.currency+""+wpe_formatPrice(parseFloat(form.price).toFixed(2),d);var i=form.currency+""+wpe_formatPrice(parseFloat(form.priceSingle).toFixed(2),d);if(form.currencyPosition!="left"){q=wpe_formatPrice(parseFloat(form.price).toFixed(2),d)+""+form.currency;i=wpe_formatPrice(parseFloat(form.priceSingle).toFixed(2),d)+""+form.currency}jQuery('#estimation_popup.wpe_bootstraped[data-form="'+d+'"] #lfb_summary table #lfb_summaryTotal>span:eq(0)').html(q);if(jQuery('#estimation_popup.wpe_bootstraped[data-form="'+form.formID+'"]').is("[data-totalrange]")&&parseFloat(form.price)>0){var o=jQuery('#estimation_popup.wpe_bootstraped[data-form="'+form.formID+'"]').attr("data-rangelabelbetween");var m=jQuery('#estimation_popup.wpe_bootstraped[data-form="'+form.formID+'"]').attr("data-rangelabeland");var h=parseInt(jQuery('#estimation_popup.wpe_bootstraped[data-form="'+form.formID+'"]').attr("data-totalrange"));var a=(parseFloat(form.price)-h/2);var g=parseFloat(form.price)+h/2;if(jQuery('#estimation_popup.wpe_bootstraped[data-form="'+form.formID+'"]').is('[data-rangemode="percent"]')){a=parseFloat(form.price)-((parseFloat(form.price)*h)/100);g=parseFloat(form.price)+((parseFloat(form.price)*h)/100)}if(a<0){a=0}b=o+"<br/><strong>"+form.currency+""+wpe_formatPrice(a,d)+"</strong><br/>"+m+"<br/><strong>"+form.currency+""+wpe_formatPrice(g,d)+"</strong>";if(form.currencyPosition!="left"){var h=parseInt(jQuery('#estimation_popup.wpe_bootstraped[data-form="'+form.formID+'"]').attr("data-totalrange"));b=o+"<br/><strong>"+wpe_formatPrice(a,d)+form.currency+"</strong><br/>"+m+"<br/><strong>"+wpe_formatPrice(g,d)+form.currency+"</strong>"}jQuery('#estimation_popup.wpe_bootstraped[data-form="'+d+'"] #lfb_summary table #lfb_summaryTotal>span:eq(0)').html(b.replace(/<br\/>/g," "))}wpe_updateSummary(d);if(c&&form.priceSingle>0){jQuery('#estimation_popup.wpe_bootstraped[data-form="'+form.formID+'"] #finalPrice span:eq(0)').html(p);if(form.price<=0){jQuery('#estimation_popup.wpe_bootstraped[data-form="'+form.formID+'"] #finalPrice span:eq(1)').css("display","none");jQuery('#estimation_popup.wpe_bootstraped[data-form="'+form.formID+'"] #finalPrice span:eq(2)').css("display","none");jQuery('#estimation_popup.wpe_bootstraped[data-form="'+d+'"] #lfb_summary table #lfb_summaryTotal>span:eq(0)').html("<strong>"+i+"</strong>")}else{jQuery('#estimation_popup.wpe_bootstraped[data-form="'+form.formID+'"] #finalPrice span:eq(2)').css("display","inline-block");jQuery('#estimation_popup.wpe_bootstraped[data-form="'+form.formID+'"] #finalPrice span:eq(1)').html("+"+b+form.subscriptionText);jQuery('#estimation_popup.wpe_bootstraped[data-form="'+form.formID+'"] #finalPrice span:eq(1)').css("display","block");jQuery('#estimation_popup.wpe_bootstraped[data-form="'+d+'"] #lfb_summary table #lfb_summaryTotal>span:eq(0)').html("<strong>"+i+"</strong> <br/>+"+q)}}else{jQuery('#estimation_popup.wpe_bootstraped[data-form="'+form.formID+'"] #finalPrice span:eq(2)').css("display","inline-block");jQuery('#estimation_popup.wpe_bootstraped[data-form="'+form.formID+'"] #finalPrice span:eq(1)').css("display","inline-block");jQuery('#estimation_popup.wpe_bootstraped[data-form="'+form.formID+'"] #finalPrice span:eq(0)').html(b)}wpe_updateStep(d);lfb_updateRichTextValues(d)}function wpe_updateItemTitleNoReduc(a,b){var c=b.formID;if(b.currencyPosition=="left"){if(a.is('[data-showprice="1"]')){if(a.data("operation")=="+"){a.attr("title",a.data("originaltitle")+" : "+b.currency+(wpe_formatPrice(a.data("price"),c)));a.attr("data-original-title",a.data("originaltitle")+" : "+b.currency+(wpe_formatPrice(a.data("price"),c)));if(b.disableTipMobile==0||!wpe_is_touch_device()){if(!a.is('[data-type="slider"]')&&!a.is(".lfb_button")&&b.imgTitlesStyle==""){a.b_tooltip("fixTitle")}}wpe_updateLabelItem(a,c)}else{if(a.data("operation")=="-"){a.attr("title",a.data("originaltitle")+" : -"+b.currency+(wpe_formatPrice(a.data("price"),c)));if(b.disableTipMobile==0||!wpe_is_touch_device()){if(!a.is('[data-type="slider"]')&&!a.is(".lfb_button")&&b.imgTitlesStyle==""){a.b_tooltip("fixTitle")}}a.attr("data-original-title",a.data("originaltitle")+" : -"+b.currency+(wpe_formatPrice(a.data("price"),c)));if(b.disableTipMobile==0||!wpe_is_touch_device()){if(!a.is('[data-type="slider"]')&&!a.is(".lfb_button")&&b.imgTitlesStyle==""){a.b_tooltip("fixTitle")}}wpe_updateLabelItem(a,c)}else{if(a.data("operation")=="x"){a.attr("title",a.data("originaltitle")+" : +"+(wpe_formatPrice(a.data("price"),c))+"%");if(b.disableTipMobile==0||!wpe_is_touch_device()){if(!a.is('[data-type="slider"]')&&!a.is(".lfb_button")&&b.imgTitlesStyle==""){a.b_tooltip("fixTitle")}}a.attr("data-original-title",a.data("originaltitle")+" : +"+(wpe_formatPrice(a.data("price"),c))+"%");if(b.disableTipMobile==0||!wpe_is_touch_device()){if(!a.is('[data-type="slider"]')&&!a.is(".lfb_button")&&b.imgTitlesStyle==""){a.b_tooltip("fixTitle")}}wpe_updateLabelItem(a,c)}else{a.attr("title",a.data("originaltitle")+" : -"+(wpe_formatPrice(a.data("price"),c))+"%");if(b.disableTipMobile==0||!wpe_is_touch_device()){if(!a.is('[data-type="slider"]')&&!a.is(".lfb_button")&&b.imgTitlesStyle==""){a.b_tooltip("fixTitle")}}a.attr("data-original-title",a.data("originaltitle")+" : -"+(wpe_formatPrice(a.data("price"),c))+"%");if(b.disableTipMobile==0||!wpe_is_touch_device()){if(!a.is('[data-type="slider"]')&&!a.is(".lfb_button")&&b.imgTitlesStyle==""){a.b_tooltip("fixTitle")}}wpe_updateLabelItem(a,c)}}}}else{a.attr("data-original-title",a.data("originaltitle"))}}else{if(a.is('[data-showprice="1"]')){if(a.attr("data-operation")=="+"){a.attr("title",a.data("originaltitle")+" : "+(wpe_formatPrice(a.data("price"),c))+b.currency);a.attr("data-original-title",a.data("originaltitle")+" : "+(wpe_formatPrice(a.data("price"),c))+b.currency);if(b.disableTipMobile==0||!wpe_is_touch_device()){if(!a.is('[data-type="slider"]')&&!a.is(".lfb_button")&&b.imgTitlesStyle==""){a.b_tooltip("fixTitle")}}wpe_updateLabelItem(a,c)}else{if(a.attr("data-operation")=="-"){a.attr("title",a.data("originaltitle")+" : -"+ +(wpe_formatPrice(a.data("price"),c)));if(b.disableTipMobile==0||!wpe_is_touch_device()){if(!a.is('[data-type="slider"]')&&!a.is(".lfb_button")&&b.imgTitlesStyle==""){a.b_tooltip("fixTitle")}}a.attr("data-original-title",a.data("originaltitle")+" : -"+(wpe_formatPrice(a.data("price"),c))+b.currency);if(b.disableTipMobile==0||!wpe_is_touch_device()){if(!a.is('[data-type="slider"]')&&!a.is(".lfb_button")&&b.imgTitlesStyle==""){a.b_tooltip("fixTitle")}}wpe_updateLabelItem(a,c)}else{if(a.attr("data-operation")=="x"){a.attr("title",a.data("originaltitle")+" : +"+(wpe_formatPrice(a.data("price"),c))+"%");if(b.disableTipMobile==0||!wpe_is_touch_device()){if(!a.is('[data-type="slider"]')&&!a.is(".lfb_button")&&b.imgTitlesStyle==""){a.b_tooltip("fixTitle")}}a.attr("data-original-title",a.data("originaltitle")+" : +"+(wpe_formatPrice(a.data("price"),c))+"%");if(b.disableTipMobile==0||!wpe_is_touch_device()){if(!a.is('[data-type="slider"]')&&!a.is(".lfb_button")&&b.imgTitlesStyle==""){a.b_tooltip("fixTitle")}}wpe_updateLabelItem(a,c)}else{a.attr("title",a.data("originaltitle")+" : -"+(wpe_formatPrice(a.data("price"),c))+"%");if(b.disableTipMobile==0||!wpe_is_touch_device()){if(!a.is('[data-type="slider"]')&&!a.is(".lfb_button")&&b.imgTitlesStyle==""){a.b_tooltip("fixTitle")}}a.attr("data-original-title",a.data("originaltitle")+" : -"+(wpe_formatPrice(a.data("price"),c))+"%");if(b.disableTipMobile==0||!wpe_is_touch_device()){if(!a.is('[data-type="slider"]')&&!a.is(".lfb_button")&&b.imgTitlesStyle==""){a.b_tooltip("fixTitle")}}wpe_updateLabelItem(a,c)}}}}else{a.attr("data-original-title",a.data("originaltitle"))}}if(a.parent().children(".lfb_imgTitle").length>0&&a.is("[data-original-title]")){a.parent().children(".lfb_imgTitle").html(a.attr("data-original-title"))}}function wpe_isDecimal(c){if(c==""){return false}var a="0123456789";var b;for(b in c){if(a.indexOf(c[b])==-1){return false}}return true}function wpe_changeContentSlide(b,c){var a=jQuery(' #estimation_popup.wpe_bootstraped[data-form="'+c+'"] #mainPanel .genSlide[data-stepid="'+form.step+'"]').find(".genContent").find(".genContentSlide.active").index();if(b=="left"){if(a>0){a--}else{a=jQuery(' #estimation_popup.wpe_bootstraped[data-form="'+c+'"] #mainPanel .genSlide[data-stepid="'+form.step+'"]').find(".genContent").find(".genContentSlide").length}}else{if(a<jQuery(' #estimation_popup.wpe_bootstraped[data-form="'+c+'"] #mainPanel .genSlide[data-stepid="'+form.step+'"]').find(".genContent").find(".genContentSlide").length-1){a++}else{a=0}}jQuery(' #estimation_popup.wpe_bootstraped[data-form="'+c+'"] #mainPanel .genSlide[data-stepid="'+form.step+'"]').find(".genContent").find(".genContentSlide.active").fadeOut(500,function(){jQuery(' #estimation_popup.wpe_bootstraped[data-form="'+c+'"] #mainPanel .genSlide[data-stepid="'+form.step+'"]').find(".genContent").find(".genContentSlide.active").removeClass("active");jQuery(' #estimation_popup.wpe_bootstraped[data-form="'+c+'"] #mainPanel .genSlide[data-stepid="'+form.step+'"]').find(".genContent").find(".genContentSlide").eq(a).delay(200).fadeIn(500,function(){jQuery(' #estimation_popup.wpe_bootstraped[data-form="'+c+'"] #mainPanel .genSlide[data-stepid="'+form.step+'"]').find(".genContent").find(".genContentSlide").eq(a).delay(250).addClass("active")})})}function wpe_toggleField(a,c){var b=wpe_getForm(c);if(jQuery('#estimation_popup.wpe_bootstraped[data-form="'+c+'"] #field_'+a+"_cb").is(":checked")){jQuery('#estimation_popup.wpe_bootstraped[data-form="'+c+'"] #field_'+a).addClass("opened");jQuery('#estimation_popup.wpe_bootstraped[data-form="'+c+'"] #field_'+a).slideDown(250)}else{jQuery('#estimation_popup.wpe_bootstraped[data-form="'+c+'"] #field_'+a).removeClass("opened");jQuery('#estimation_popup.wpe_bootstraped[data-form="'+c+'"] #field_'+a).slideUp(250)}setTimeout(function(){var e=jQuery(' #estimation_popup.wpe_bootstraped[data-form="'+c+'"] #mainPanel .genSlide[data-stepid="'+b.step+'"] .stepTitle').height();var d=jQuery(' #estimation_popup.wpe_bootstraped[data-form="'+c+'"] #mainPanel .genSlide[data-stepid='+b.step+"]").outerHeight()+160+e;jQuery(' #estimation_popup.wpe_bootstraped[data-form="'+c+'"] #mainPanel').css("min-height",d)},300)}function wpe_finalStep(b){var a=wpe_getForm(b);a.step++;jQuery('#estimation_popup.wpe_bootstraped[data-form="'+b+'"] #lfb_loader').delay(800).fadeOut(a.animationsSpeed*2);setTimeout(function(){var c=lfb_getRedirectionURL(b);if(c!=""&&c!="#"&&c!=" "){document.location.href=c}},a.redirectionDelay*1000)}function wpe_updateStep(g){var f=wpe_getForm(g);if(f.showSteps==1){var e=new Array();var c=false;jQuery.each(lfb_plannedSteps,function(){if(!c&&!jQuery('#estimation_popup.wpe_bootstraped[data-form="'+g+'"] #mainPanel .genSlide[data-stepid="'+this+'"]').is(".lfb_disabled")&&(jQuery('#estimation_popup.wpe_bootstraped[data-form="'+g+'"] #mainPanel .genSlide[data-stepid="'+this+'"] .lfb_item:not(.lfb-hidden)').length>0||jQuery('#estimation_popup.wpe_bootstraped[data-form="'+g+'"] #mainPanel .genSlide[data-stepid="'+this+'"] .lfb_distanceError').length>0)){e.push(this)}});var a=0;jQuery.each(e,function(j,h){if(parseInt(h)==parseInt(f.step)){a=j}});a++;if(a==0){a=1}if(f.step=="final"){a=e.length+1}var b=e.length+1;if(a>b){a=b}var d=((a)*100)/b;jQuery('#estimation_popup.wpe_bootstraped[data-form="'+g+'"] .genPrice .progress .progress-bar-price> span:first-child').html((a)+"/"+b);jQuery('#estimation_popup.wpe_bootstraped[data-form="'+g+'"] .genPrice .progress .progress-bar').css("width",d+"%")}}function wpe_initPanelResize(b){var a=wpe_getForm(b);jQuery(window).resize(function(){lfb_resize(b)})}function lfb_resize(a){var c=jQuery(' #estimation_popup.wpe_bootstraped[data-form="'+a+'"] #mainPanel .genSlide[data-stepid="'+form.step+'"] .stepTitle').height();var b=jQuery(' #estimation_popup.wpe_bootstraped[data-form="'+a+'"] #mainPanel .genSlide[data-stepid="'+form.step+'"]').outerHeight()+160+c;jQuery(' #estimation_popup.wpe_bootstraped[data-form="'+a+'"] #mainPanel').css("min-height",b)}function lfb_rgb2hex(a){if(a.indexOf("rgb")>-1){try{a=a.match(/^rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*(\d+))?\)$/);function b(d){return("0"+parseInt(d).toString(16)).slice(-2)}return"#"+b(a[1])+b(a[2])+b(a[3])}catch(c){return a}}else{return a}}function wpe_formatPrice(h,e){if(!h){h=0}var a=h.toString();if(a.indexOf(".")>-1){a=parseFloat(h).toFixed(2).toString()}var b=wpe_getForm(e);if(b.summary_noDecimals=="1"){a=Math.round(a).toString()}var c=b.decimalsSeparator;var g=b.thousandsSeparator;var j=a;var f=b.millionSeparator;var i=b.billionsSeparator;var d="";if(a.indexOf(".")>-1){j=a.substr(0,a.indexOf("."));d=a.substr(a.indexOf(".")+1,2);a=a.replace(".",b.decimalsSeparator);if(d.toString().length==1){d=d.toString()+"0"}if(j.length>9){a=j.substr(0,j.length-9)+i+j.substr(j.length-9,3)+f+j.substr(j.length-6,3)+g+j.substr(j.length-3,j.length)+b.decimalsSeparator+d}else{if(j.length>6){a=j.substr(0,j.length-6)+f+j.substr(j.length-6,3)+g+j.substr(j.length-3,j.length)+b.decimalsSeparator+d}else{if(j.length>3){a=j.substr(0,j.length-3)+g+j.substr(j.length-3,j.length)+b.decimalsSeparator+d}}}}else{if(j.length>9){a=a=j.substr(0,j.length-9)+i+j.substr(j.length-9,3)+f+j.substr(j.length-6,3)+g+j.substr(j.length-3,j.length)}else{if(j.length>6){a=j.substr(0,j.length-6)+f+j.substr(j.length-6,3)+g+j.substr(j.length-3,j.length)}else{if(j.length>3){a=j.substr(0,j.length-3)+g+j.substr(j.length-3,j.length)}}}}return a}function lfb_applyCouponCode(c){var b=wpe_getForm(c);var a=jQuery('#estimation_popup.wpe_bootstraped[data-form="'+c+'"] #lfb_couponField').val();jQuery('#estimation_popup.wpe_bootstraped[data-form="'+c+'"] #lfb_couponField').closest(".form-group").removeClass("has-error");if(a.length<3){jQuery('#estimation_popup.wpe_bootstraped[data-form="'+c+'"] #lfb_couponField').closest(".form-group").addClass("has-error")}else{jQuery.ajax({url:b.ajaxurl,type:"post",data:{action:"lfb_applyCouponCode",formID:c,code:a},success:function(d){if(d=="0"||d==""){jQuery('#estimation_popup.wpe_bootstraped[data-form="'+c+'"] #lfb_couponField').closest(".form-group").addClass("has-error")}else{jQuery('#estimation_popup.wpe_bootstraped[data-form="'+c+'"] #lfb_couponContainer').slideUp();var e=d;if(d.indexOf("%")>0){e=d.substr(0,d.length-1);b.reductionType="%"}b.discountCode=a;b.reduction=e;jQuery('#estimation_popup.wpe_bootstraped[data-form="'+c+'"] #finalSlide .genContent').animate({opacity:0},b.animationsSpeed);setTimeout(function(){wpe_updatePrice(c);wpe_changeStep("final",c)},b.animationsSpeed+100)}}})}}function lfb_getRedirectionURL(c){var a=wpe_getForm(c);var b=a.close_url;if(a.useRedirectionConditions==1){jQuery.each(a.redirections,function(){var d=this.conditions.replace(/'/g,'"');d=d.replace(/\\"/g,'"');d=JSON.parse(d);var e=lfb_checkConditions(d,c,"final");error=e.error;errorOR=e.errorOR;if((this.conditionsOperator=="OR"&&!errorOR)||(this.conditionsOperator!="OR"&&!error)){b=this.url}})}return b}function lfb_startFormIntro(a){if(!tld_selectionMode){jQuery('#estimation_popup.wpe_bootstraped[data-form="'+a+'"]  #startInfos > p').slideDown()}}function lfb_initRichTextValues(a){jQuery('#estimation_popup.wpe_bootstraped[data-form="'+a+'"] .lfb_richtext[data-itemid]:not(.lfb_shortcode)').each(function(){var w=0;var g=new Array();var l=parseInt(jQuery(this).closest(".genSlide").attr("data-stepid"));if(form.richtextsContent[jQuery(this).attr("data-itemid").toString()]!==undefined){var s=form.richtextsContent[jQuery(this).attr("data-itemid").toString()];while((w=s.indexOf("item-",w+1))!=-1){var f=s.substr(w+5,s.indexOf("_",w)-(w+5));var t=s.substr(s.indexOf("_",w)+1,(s.indexOf("]",w)-1)-(s.indexOf("_",w)));var o='<span class="lfb_richVariable" data-varitemid="'+f+'" data-action="'+t+'"></span>';g.push({oldValue:s.substr(w-1,(s.indexOf("]",w)+1)-(w-1)),newValue:o})}if(s.indexOf("dateDifference-")>-1){while((w=s.indexOf("dateDifference-",w+1))!=-1){var D=s.indexOf("_",w+15)+1;var e=s.substr(w+15,s.indexOf("_",w)-(w+15));var y=s.substr(D,s.indexOf("]",D)-(D));var f=e;var t="dateDifference";var o='<span class="lfb_richVariable" data-varitemid="'+f+'" data-action="'+t+'" data-enddateid="'+y+'"></span>';g.push({oldValue:s.substr(w-1,(s.indexOf("]",w)+1)-(w-1)),newValue:o})}}if(s.indexOf("distance_")>-1){$target.attr("data-usedistance","true");while((w=s.indexOf("distance_",w+1))!=-1){var E="km";var v=s.indexOf("-",w+9)+1;var m=s.substr(w+9,s.indexOf("-",w)-(w+9));var F=s.indexOf("-",v)+1;var p=s.substr(v,s.indexOf("-",v)-(v));var q=s.indexOf("-",F)+1;var j=s.substr(F,s.indexOf("-",F)-(F));var c=s.indexOf("_",q)+1;var x=s.substr(q,s.indexOf("_",q)-(q));var d=s.indexOf("-",c)+1;var z=s.substr(c,s.indexOf("-",c)-(c));var n=s.indexOf("-",d)+1;var k=s.substr(d,s.indexOf("-",d)-(d));var b=s.indexOf("-",n)+1;var u=s.substr(n,s.indexOf("-",n)-(n));var r=s.indexOf("_",b)+1;var h=s.substr(b,s.indexOf("_",b)-(b));E=s.substr(r,s.indexOf("]",r)-(r));var t="distance";var o='<span class="lfb_richVariable" data-action="'+t+'" data-distancetype="'+E+'" data-departadress="'+m+'" data-departcity="'+p+'" data-departzip="'+j+'" data-departcountry="'+x+'" data-arrivaladress="'+z+'" data-arrivalcity="'+k+'" data-arrivalzip="'+u+'" data-arrivalcountry="'+h+'" ></span>';g.push({oldValue:s.substr(w-1,(s.indexOf("]",w)+1)-(w-1)),newValue:o})}}var B=new Date();var C=B.getMonth()+1;if(C<10){C="0"+C}var A=B.getFullYear().toString()+C.toString()+B.getDate().toString();s=s.replace(/\[currentDate\]/g,A);s=s.replace(/\[total\]/g,'<span class="lfb_richVariable" data-action="total"></span>');s=s.replace(/\[total_quantity\]/g,'<span class="lfb_richVariable" data-action="total_quantity"></span>');jQuery.each(g,function(){s=s.replace(this.oldValue,this.newValue)});jQuery(this).html(s)}})}function lfb_updateRichTextValues(e){var c=wpe_getForm(e);var a=new Date();var d=a.getMonth()+1;if(d<10){d="0"+d}var b=a.getFullYear().toString()+d.toString()+a.getDate().toString();jQuery('#estimation_popup.wpe_bootstraped[data-form="'+e+'"] .lfb_richtext[data-itemid]:not(.lfb_shortcode) .lfb_richVariable').each(function(){var x=0;var p=parseInt(jQuery(this).closest(".genSlide").attr("data-stepid"));var h=jQuery(this).attr("data-varitemid");var v=jQuery(this).attr("data-action");var s=0;var f=jQuery('#estimation_popup.wpe_bootstraped[data-form="'+e+'"] #mainPanel .genSlide [data-itemid="'+h+'"]');if(v=="price"){s=0;if(h=="total"){s=c.price}else{if(jQuery('#estimation_popup.wpe_bootstraped[data-form="'+e+'"] #mainPanel .genSlide [data-itemid="'+h+'"]').is(".checked")||jQuery('#estimation_popup.wpe_bootstraped[data-form="'+e+'"] #mainPanel .genSlide [data-itemid="'+h+'"]').is(":checked")||jQuery('#estimation_popup.wpe_bootstraped[data-form="'+e+'"] #mainPanel .genSlide [data-itemid="'+h+'"]').is("select")||jQuery('#estimation_popup.wpe_bootstraped[data-form="'+e+'"] #mainPanel .genSlide [data-itemid="'+h+'"]').is('[data-type="slider"]')){s=parseFloat(jQuery('#estimation_popup.wpe_bootstraped[data-form="'+e+'"] #mainPanel .genSlide [data-itemid="'+h+'"]').data("resprice"));if(isNaN(s)){s=0}}}s=wpe_formatPrice(parseFloat(s),e);if(c.currencyPosition=="left"){s=c.currency+s}else{s+=c.currency}}if(v=="title"||v=="label"){if(!f.is(".lfb_disabled")){if(jQuery('#estimation_popup.wpe_bootstraped[data-form="'+e+'"] #mainPanel .genSlide [data-itemid="'+h+'"]').is(".checked")||jQuery('#estimation_popup.wpe_bootstraped[data-form="'+e+'"] #mainPanel .genSlide [data-itemid="'+h+'"]').is(":checked")||jQuery('#estimation_popup.wpe_bootstraped[data-form="'+e+'"] #mainPanel .genSlide [data-itemid="'+h+'"]').is("select")||jQuery('#estimation_popup.wpe_bootstraped[data-form="'+e+'"] #mainPanel .genSlide [data-itemid="'+h+'"]').is('[type="text"]')||jQuery('#estimation_popup.wpe_bootstraped[data-form="'+e+'"] #mainPanel .genSlide [data-itemid="'+h+'"]').is("textarea")||jQuery('#estimation_popup.wpe_bootstraped[data-form="'+e+'"] #mainPanel .genSlide [data-itemid="'+h+'"]').is(".lfb_colorPreview")||jQuery('#estimation_popup.wpe_bootstraped[data-form="'+e+'"] #mainPanel .genSlide [data-itemid="'+h+'"]').is("lfb_layeredImage")||jQuery('#estimation_popup.wpe_bootstraped[data-form="'+e+'"] #mainPanel .genSlide [data-itemid="'+h+'"]').is('[data-type="slider"]')||jQuery('#estimation_popup.wpe_bootstraped[data-form="'+e+'"] #mainPanel .genSlide [data-itemid="'+h+'"]').is(".lfb_dropzone")||jQuery('#estimation_popup.wpe_bootstraped[data-form="'+e+'"] #mainPanel .genSlide [data-itemid="'+h+'"]').is('[data-type="slider"]')){s=f.attr("data-originaltitle")}else{s=""}}else{s=""}}if(v=="quantity"){if(jQuery('#estimation_popup.wpe_bootstraped[data-form="'+e+'"] #mainPanel .genSlide [data-itemid="'+h+'"]').is(".checked")||jQuery('#estimation_popup.wpe_bootstraped[data-form="'+e+'"] #mainPanel .genSlide [data-itemid="'+h+'"]').is(":checked")){if(f.find(".icon_quantity").length>0){s=parseFloat(f.find(".icon_quantity").html())}else{s=f.find(".wpe_qtfield").val()}if(isNaN(s)){s=0}}else{if(jQuery('#estimation_popup.wpe_bootstraped[data-form="'+e+'"] #mainPanel .genSlide [data-itemid="'+h+'"]').is('[data-type="slider"]')){s=jQuery('#estimation_popup.wpe_bootstraped[data-form="'+e+'"] #mainPanel .genSlide [data-itemid="'+h+'"]').slider("value")}}}if(v=="value"){if(!f.is(".lfb_disabled")){if(jQuery('#estimation_popup.wpe_bootstraped[data-form="'+e+'"] #mainPanel .genSlide [data-itemid="'+h+'"]').is("select")){s=jQuery('#estimation_popup.wpe_bootstraped[data-form="'+e+'"] #mainPanel .genSlide [data-itemid="'+h+'"]').val()}else{s=(jQuery('#estimation_popup.wpe_bootstraped[data-form="'+e+'"] #mainPanel .genSlide [data-itemid="'+h+'"]').val());if(isNaN(s)){}}}else{s=""}}if(v=="date"){if(f.is(".lfb_datepicker")&&f.datetimepicker("getDate")!=null){s=moment.utc(f.datetimepicker("getDate")).format("YYYY-MM-DD")}else{s="null"}}if(v=="dateDifference"){var g=h;var A=jQuery(this).attr("data-enddateid");if(g=="currentDate"){g=a}else{if(jQuery('#estimation_popup.wpe_bootstraped[data-form="'+e+'"] #mainPanel .genSlide [data-itemid="'+g+'"]').length>0&&jQuery('#estimation_popup.wpe_bootstraped[data-form="'+e+'"] #mainPanel .genSlide [data-itemid="'+g+'"]').val().length>0){var f=jQuery('#estimation_popup.wpe_bootstraped[data-form="'+e+'"] #mainPanel .genSlide [data-itemid="'+g+'"]');g=f.datetimepicker("getDate")}else{g=a}}if(A=="currentDate"){A=b}else{if(jQuery('#estimation_popup.wpe_bootstraped[data-form="'+e+'"] #mainPanel .genSlide [data-itemid="'+A+'"]').length>0&&jQuery('#estimation_popup.wpe_bootstraped[data-form="'+e+'"] #mainPanel .genSlide [data-itemid="'+A+'"]').val().length>0){var f=jQuery('#estimation_popup.wpe_bootstraped[data-form="'+e+'"] #mainPanel .genSlide [data-itemid="'+A+'"]');A=f.datetimepicker("getDate")}else{A=a}}var q=Math.abs(A.getTime()-g.getTime());var n=Math.ceil(q/(1000*3600*24));if(n<0){n=0}s=n}if(v=="distance"){var r=jQuery(this).attr("data-departadress");var t=jQuery(this).attr("data-departcity");var m=jQuery(this).attr("data-departzip");var z=jQuery(this).attr("data-departcountry");var B=jQuery(this).attr("data-arrivaladress");var o=jQuery(this).attr("data-arrivalcity");var y=jQuery(this).attr("data-arrivalzip");var l=jQuery(this).attr("data-arrivalcountry");var C=jQuery(this).attr("data-distancetype");if(r!=""){if(jQuery('#estimation_popup.wpe_bootstraped[data-form="'+e+'"] #mainPanel .genSlide [data-itemid="'+r+'"]').length>0){var f=jQuery('#estimation_popup.wpe_bootstraped[data-form="'+e+'"] #mainPanel .genSlide [data-itemid="'+r+'"]');r=f.val()}else{r=0}}if(t!=""){if(jQuery('#estimation_popup.wpe_bootstraped[data-form="'+e+'"] #mainPanel .genSlide [data-itemid="'+t+'"]').length>0){var f=jQuery('#estimation_popup.wpe_bootstraped[data-form="'+e+'"] #mainPanel .genSlide [data-itemid="'+t+'"]');t=f.val()}else{t=0}}if(m!=""){if(jQuery('#estimation_popup.wpe_bootstraped[data-form="'+e+'"] #mainPanel .genSlide [data-itemid="'+m+'"]').length>0){var f=jQuery('#estimation_popup.wpe_bootstraped[data-form="'+e+'"] #mainPanel .genSlide [data-itemid="'+m+'"]');m=f.val()}else{m=0}}if(z!=""){if(jQuery('#estimation_popup.wpe_bootstraped[data-form="'+e+'"] #mainPanel .genSlide [data-itemid="'+z+'"]').length>0){var f=jQuery('#estimation_popup.wpe_bootstraped[data-form="'+e+'"] #mainPanel .genSlide [data-itemid="'+z+'"]');z=f.val()}else{z=0}}if(B!=""){if(jQuery('#estimation_popup.wpe_bootstraped[data-form="'+e+'"] #mainPanel .genSlide [data-itemid="'+B+'"]').length>0){var f=jQuery('#estimation_popup.wpe_bootstraped[data-form="'+e+'"] #mainPanel .genSlide [data-itemid="'+B+'"]');B=f.val()}else{B=0}}if(o!=""){if(jQuery('#estimation_popup.wpe_bootstraped[data-form="'+e+'"] #mainPanel .genSlide [data-itemid="'+o+'"]').length>0){var f=jQuery('#estimation_popup.wpe_bootstraped[data-form="'+e+'"] #mainPanel .genSlide [data-itemid="'+o+'"]');o=f.val()}else{o=0}}if(y!=""){if(jQuery('#estimation_popup.wpe_bootstraped[data-form="'+e+'"] #mainPanel .genSlide [data-itemid="'+y+'"]').length>0){var f=jQuery('#estimation_popup.wpe_bootstraped[data-form="'+e+'"] #mainPanel .genSlide [data-itemid="'+y+'"]');y=f.val()}else{y=0}}if(l!=""){if(jQuery('#estimation_popup.wpe_bootstraped[data-form="'+e+'"] #mainPanel .genSlide [data-itemid="'+l+'"]').length>0){var f=jQuery('#estimation_popup.wpe_bootstraped[data-form="'+e+'"] #mainPanel .genSlide [data-itemid="'+l+'"]');l=f.val()}else{l=0}}if($target.closest(".genSlide").find(".lfb_distanceError").length>0){lfb_removeDistanceError(targetID,e)}var w=content.substr(x-1,(content.indexOf("]",x)+1)-(x-1));var j=0;if($target.attr("data-distance")!=""){j=parseFloat($target.attr("data-distance"))}if(r==""&&t==""&&z==""&&B==""&&o==""&&l==""&&m==""&&y==""){lfb_showDistanceError(targetID,e)}else{if(c.gmap_key==""){lfb_showDistanceError(targetID,e);console.log("invalid gmap api key")}else{var k=r+" "+m+" "+t+" "+z;var u=B+" "+y+" "+o+" "+l;if($target.attr("data-departure")!=k||u!=$target.attr("data-arrival")){$target.attr("data-departure",k);$target.attr("data-arrival",u);lfb_getDistanceCalc(w,e,targetID,k,u,C)}}}s=j}if(v=="total"){s=jQuery('#estimation_popup.wpe_bootstraped[data-form="'+e+'"]  #finalPrice').html()}else{if(v=="total_quantity"){s=wpe_getTotalQuantities(e,p)}}jQuery(this).html(s)})}function lfb_saveForLater(d){var b=wpe_getForm(d);if(b.step!="0"){if(localStorage.getItem("lfb_savedFormID")!==null&&parseInt(localStorage.getItem("lfb_savedFormID"))==d&&localStorage.getItem("lfb_savedForm")!==null){localStorage.removeItem("lfb_savedFormID");localStorage.removeItem("lfb_savedForm");localStorage.removeItem("lfb_savedFormPastSteps");localStorage.removeItem("lfb_savedFormStep");localStorage.removeItem("lfb_savedFormTime");jQuery('#estimation_popup.wpe_bootstraped[data-form="'+d+'"] .lfb_btnSaveForm > .fa').attr("class","fa "+jQuery('#estimation_popup.wpe_bootstraped[data-form="'+d+'"] .lfb_btnSaveForm').attr("data-originalicon"));if(jQuery('#estimation_popup.wpe_bootstraped[data-form="'+d+'"] .lfb_btnSaveForm').attr("data-defaulttext")!=""){jQuery('#estimation_popup.wpe_bootstraped[data-form="'+d+'"] .lfb_btnSaveForm span:not(.fa)').html(jQuery('#estimation_popup.wpe_bootstraped[data-form="'+d+'"] .lfb_btnSaveForm').attr("data-defaulttext"))}}else{var a=wpe_getFormContent(d,true)[2];localStorage.setItem("lfb_savedFormID",d);localStorage.setItem("lfb_savedForm",JSON.stringify(a));localStorage.setItem("lfb_savedFormPastSteps",JSON.stringify(lfb_lastSteps));localStorage.setItem("lfb_savedFormStep",b.step);localStorage.setItem("lfb_savedFormTime",Date.now());var c="";if(jQuery('#estimation_popup.wpe_bootstraped[data-form="'+d+'"] .lfb_btnSaveForm > .fa').length>0){c=jQuery('#estimation_popup.wpe_bootstraped[data-form="'+d+'"] .lfb_btnSaveForm > .fa').attr("class");jQuery('#estimation_popup.wpe_bootstraped[data-form="'+d+'"] .lfb_btnSaveForm > .fa').attr("class","fa fa-check")}jQuery('#estimation_popup.wpe_bootstraped[data-form="'+d+'"] .lfb_btnSaveForm').removeClass("btn-default").addClass("btn-primary");if(jQuery('#estimation_popup.wpe_bootstraped[data-form="'+d+'"] .lfb_btnSaveForm').attr("data-defaulttext")!=""){jQuery('#estimation_popup.wpe_bootstraped[data-form="'+d+'"] .lfb_btnSaveForm span:not(.fa)').html(jQuery('#estimation_popup.wpe_bootstraped[data-form="'+d+'"] .lfb_btnSaveForm').attr("data-deltext"))}setTimeout(function(){if(jQuery('#estimation_popup.wpe_bootstraped[data-form="'+d+'"] .lfb_btnSaveForm > .fa').length>0){jQuery('#estimation_popup.wpe_bootstraped[data-form="'+d+'"] .lfb_btnSaveForm > .fa').attr("class","fa fa-refresh")}jQuery('#estimation_popup.wpe_bootstraped[data-form="'+d+'"] .lfb_btnSaveForm').removeClass("btn-primary").addClass("btn-default")},1500)}}}function lfb_getStoredSelectionItemID(a,c){var b=false;jQuery.each(a,function(){if(this.itemid==c){b=this}});return b}function lfb_loadStoredForm(g){var d=wpe_getForm(g);var f=new Date(parseInt(d.lastS));if(jQuery('#estimation_popup.wpe_bootstraped[data-form="'+g+'"] .lfb_btnSaveForm').length>0){if(localStorage.getItem("lfb_savedFormID")!==null&&parseInt(localStorage.getItem("lfb_savedFormID"))==g&&localStorage.getItem("lfb_savedForm")!==null){var c=new Date(parseInt(localStorage.getItem("lfb_savedFormTime")));if(c>f){jQuery('#estimation_popup.wpe_bootstraped[data-form="'+g+'"] .lfb_btnSaveForm > .fa').attr("class","fa fa-refresh");if(jQuery('#estimation_popup.wpe_bootstraped[data-form="'+g+'"] .lfb_btnSaveForm').attr("data-defaulttext")!=""){jQuery('#estimation_popup.wpe_bootstraped[data-form="'+g+'"] .lfb_btnSaveForm span:not(.fa)').html(jQuery('#estimation_popup.wpe_bootstraped[data-form="'+g+'"] .lfb_btnSaveForm').attr("data-deltext"))}var b=JSON.parse(localStorage.getItem("lfb_savedForm"));var e=JSON.parse(localStorage.getItem("lfb_savedFormPastSteps"));var a=(localStorage.getItem("lfb_savedFormStep"));if(jQuery.inArray(a,e)==-1){e.push(a)}if(e.length>0){d.autoStart=true;jQuery.each(e,function(){var h=this.toString();jQuery('#estimation_popup.wpe_bootstraped[data-form="'+g+'"] [data-stepid="'+h+'"] [data-itemid]').each(function(){$item=jQuery(this);var i=lfb_getStoredSelectionItemID(b,parseInt($item.attr("data-itemid")));if($item.is(".selectable")){if(i!=false){if($item.find(".icon_quantity").length>0){$item.find(".icon_quantity").html(i.quantity);if($item.find(".wpe_sliderQt").length>0){$item.find(".wpe_sliderQt").slider("value",parseInt(i.quantity))}}else{if($item.find(".wpe_qtfield").length>0){$item.find(".wpe_qtfield").val(parseInt(i.quantity))}else{if($item.is('[data-type="slider"]')){$item.slider("value",parseInt(i.quantity))}}}if(!$item.is(".checked")){wpe_itemClick(jQuery(this),false,g)}}else{if($item.is(".checked")){wpe_itemClick(jQuery(this),false,g)}}}else{if($item.is(".lfb_button")){if(i!=false){if(!$item.is(".checked")){wpe_itemClick(jQuery(this),false,g)}}else{if($item.is(".checked")){wpe_itemClick(jQuery(this),false,g)}}}else{if($item.is('[data-toggle="switch"]')){if(i!=false){if(!$item.is(":checked")){$item.trigger("click")}}else{if($item.is(".checked")){wpe_itemClick(jQuery(this),false,g)}}}else{if($item.is(".lfb_colorPreview")){if(i!=false){$item.closest(".itemBloc").find(".lfb_colorpicker").val(i.value)}}else{if($item.is(".lfb_datepicker")){if(i!=false){$item.val(i.value)}}else{if($item.is(".lfb_dropzone")){if(i!=false){$item.val(i.value);$item.createThumbnailFromUrl(i.value)}}else{if($item.is('[data-type="numberfield"]')){if(i!=false){if($item.is('[data-valueasqt="1"]')){$item.val(i.quantity)}else{$item.val(i.value)}}}else{if($item.is("select")){if(i!=false){$item.val(i.value)}}else{if($item.is('[data-type="slider"]')){if(i!=false){$item.slider("value",parseInt(i.quantity))}}else{if($item.is("textarea")){if(i!=false){$item.val(i.value)}}else{if($item.is('input[type="text"]')){if(i!=false){$item.val(i.value)}}}}}}}}}}}}});if(h!=a){lfb_lastSteps.push(h)}else{jQuery('#estimation_popup.wpe_bootstraped[data-form="'+g+'"] [data-stepid="'+h+'"] .errorMsg').hide();if(d.intro_enabled=="1"){jQuery('#estimation_popup.wpe_bootstraped[data-form="'+g+'"]  #startInfos > p').slideDown();jQuery('#estimation_popup.wpe_bootstraped[data-form="'+g+'"] .lfb_btnFloatingSummary').css({display:"inline-block"});jQuery('#estimation_popup.wpe_bootstraped[data-form="'+g+'"] .lfb_btnSaveForm').css({display:"inline-block"});jQuery('#estimation_popup.wpe_bootstraped[data-form="'+d.formID+'"] #btnStart').parent().fadeOut(d.animationsSpeed,function(){if(d.showSteps!="2"){jQuery('#estimation_popup.wpe_bootstraped[data-form="'+g+'"] .genPrice').fadeIn(d.animationsSpeed)}jQuery(' #estimation_popup.wpe_bootstraped[data-form="'+d.formID+'"] #mainPanel').fadeIn(d.animationsSpeed+d.animationsSpeed/2,function(){wpe_changeStep(a,g)})})}else{wpe_changeStep(a,g)}}})}}else{localStorage.removeItem("lfb_savedFormID");localStorage.removeItem("lfb_savedForm");localStorage.removeItem("lfb_savedFormPastSteps");localStorage.removeItem("lfb_savedFormStep");localStorage.removeItem("lfb_savedFormTime");jQuery('#estimation_popup.wpe_bootstraped[data-form="'+g+'"] .lfb_btnSaveForm > .fa').attr("class","fa "+jQuery('#estimation_popup.wpe_bootstraped[data-form="'+g+'"] .lfb_btnSaveForm').attr("data-originalicon"));if(jQuery('#estimation_popup.wpe_bootstraped[data-form="'+g+'"] .lfb_btnSaveForm').attr("data-defaulttext")!=""){jQuery('#estimation_popup.wpe_bootstraped[data-form="'+g+'"] .lfb_btnSaveForm span:not(.fa)').html(jQuery('#estimation_popup.wpe_bootstraped[data-form="'+g+'"] .lfb_btnSaveForm').attr("data-defaulttext"))}}}else{jQuery('#estimation_popup.wpe_bootstraped[data-form="'+g+'"] .lfb_btnSaveForm > .fa').attr("class","fa "+jQuery('#estimation_popup.wpe_bootstraped[data-form="'+g+'"] .lfb_btnSaveForm').attr("data-originalicon"));if(jQuery('#estimation_popup.wpe_bootstraped[data-form="'+g+'"] .lfb_btnSaveForm').attr("data-defaulttext")!=""){jQuery('#estimation_popup.wpe_bootstraped[data-form="'+g+'"] .lfb_btnSaveForm span:not(.fa)').html(jQuery('#estimation_popup.wpe_bootstraped[data-form="'+g+'"] .lfb_btnSaveForm').attr("data-defaulttext"))}}}}function lfb_getCalendarByID(a){var b=false;jQuery.each(lfb_calendars,function(){if(this.id==a){b=this}});return b}function lfb_getDisabledHours(d,a,c,g){var b=new Array();var e=lfb_getCalendarByID(d);if(e!=false){if(jQuery('#estimation_popup .lfb_datepicker[data-calendarid="'+e.id+'"][data-hoursdisabled]').attr("data-hoursdisabled")!=""){var f=jQuery('#estimation_popup .lfb_datepicker[data-calendarid="'+e.id+'"]').attr("data-hoursdisabled");if(f.indexOf(",")>-1){jQuery.each(f.split(","),function(){var h=parseInt(this);b.push(h);if(g=="hours"){for(var j=0;j<parseInt(c);j++){if(jQuery.inArray(h-j,b)==-1){b.push(h-j)}}}else{if(g=="mins"){for(var j=0;j<=Math.floor(c/60);j++){if(jQuery.inArray(h-j,b)==-1){b.push(h-j)}}}}})}else{b.push(parseInt(f))}}jQuery.each(e.events,function(){var h=moment.utc(this.startDate);if(h.format("YYYY-MM-DD")==a){if(moment.utc(this.endDate).format("YYYY-MM-DD")==h.format("YYYY-MM-DD")){if(moment.utc(this.endDate).diff(h,"hours")>1){var k=h.clone();k.add(1,"hours");for(var j=k.format("HH");j<moment.utc(this.endDate).format("HH");j++){if(jQuery.inArray(j,b)==-1){b.push(parseInt(j))}}for(var j=h.format("HH")+1;j<moment.utc(this.endDate).format("HH");j++){if(jQuery.inArray(parseInt(j),b)==-1){b.push(parseInt(j))}}if(h.format("mm")=="00"){if(jQuery.inArray(h.format("HH"),b)==-1){b.push(h.format("HH"))}}}else{if(moment.utc(this.endDate).diff(h,"hours")==1&&h.format("mm")=="00"){if(jQuery.inArray((h.format("HH")),b)==-1){b.push(parseInt(h.format("HH")))}}else{}}}else{for(var j=h.format("HH");j<24;j++){if(jQuery.inArray(j,b)==-1){b.push(parseInt(j))}}}}})}return b}function lfb_getDisabledMinutes(d,j,e,c,l){var h=new Array();var g=lfb_getCalendarByID(d);if(g!=false){var k=lfb_getDisabledHours(d,j,c,l);var b=l;if(l=="mins"){b="minutes"}var a=jQuery('#estimation_popup .lfb_datepicker[data-calendarid="'+g.id+'"]').attr("data-hoursdisabled");if(a.indexOf(",")>-1){jQuery.each(a.split(","),function(){var o=parseInt(this);var m=moment(new Date(j+" "+o+":00")).subtract(parseInt(c),b).add(1,"minute").format("YYYY-MM-DD HH:mm");for(var n=0;n<=11;n++){if(moment(new Date(j+" "+e+":"+(n*5))).isAfter(moment(new Date(m)))&&moment(new Date(j+" "+e+":"+(n*5))).isBefore(moment(new Date(moment(new Date(j+" "+o+":00")))))){if(jQuery.inArray(n*5,h)==-1){h.push(parseInt(n*5))}}}})}if(jQuery.inArray(parseInt(e),k)>-1){for(var f=0;f<=11;f++){if(jQuery.inArray(f*5,h)==-1){h.push(parseInt(f*5))}}}jQuery.each(g.events,function(){var m=moment.utc(this.startDate);if(m.format("YYYY-MM-DD")==j&&m.format("HH")==e){for(var n=0;n<=11;n++){if(n*5>=m.format("mm")){if(jQuery.inArray(n*5,h)==-1){h.push(parseInt(n*5))}}}}if(moment.utc(this.endDate).format("YYYY-MM-DD")==j&&moment.utc(this.endDate).format("HH")==e){for(var n=0;n<=11;n++){if(n*5<moment.utc(this.endDate).format("mm")){if(jQuery.inArray(n*5,h)==-1){h.push(parseInt(n*5))}}}}})}return h}function lfb_getBusyDates(c,a){var b=wpe_getForm(c);jQuery.ajax({url:b.ajaxurl,type:"post",data:{action:"lfb_getBusyDates",formID:c,calendarsIDs:a},success:function(d){d=d.trim();d=JSON.parse(d,true);lfb_calendars=d.calendars;jQuery.each(d.calendars,function(){var e=this;jQuery('#estimation_popup .lfb_datepicker[data-calendarid="'+this.id+'"]').each(function(){_datepicker=jQuery(this);var f=new Array();jQuery.each(e.events,function(){if(this.fullDay==1){var g=moment.utc(this.startDate);var n=moment.utc(this.endDate);var h=g.format("YYYY-MM-DD");f.push(h);for(var l=1;l<=n.diff(g,"days");l++){var k=g.add(l,"days");f.push(k.format("YYYY-MM-DD"))}}else{var g=moment.utc(this.startDate);var j=_datepicker.attr("data-eventdurationtype");if(_datepicker.attr("data-eventdurationtype")=="mins"){j="minutes"}g=moment(g).subtract(parseInt(_datepicker.attr("data-eventduration")),j);this.startDate=g.format("YYYY-MM-DD HH:mm");var n=moment.utc(this.endDate);var h=g.format("YYYY-MM-DD");if(n.diff(g,"days")>1){var m=1;if(g.format("m")==0){m=0}for(var l=m;l<=n.diff(g,"days");l++){var k=g.clone().add(l,"days");f.push(k.format("YYYY-MM-DD"))}}}});_datepicker.datetimepicker("setDatesDisabled",f)})})}})};